{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/pedro/OneDrive/Documentos/Eng.Informatica_Projects/3 Ano/lapr5_g61/lei22_23_s5_3dk_61_angular/EletricGo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport * as THREE from \"three\";\nimport TextSprite from \"@seregpie/three.text-sprite\";\nimport { Group, LineCurve3, MeshBasicMaterial, MeshStandardMaterial, Object3D, Vector3 } from 'three';\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/dotnet/warehouses.service\";\nimport * as i3 from \"../../services/node/routes.service\";\nimport * as i4 from \"../../services/node/truck.service\";\nimport * as i5 from \"../choose-truck-and-route/choose-truck-and-route.component\";\nimport * as i6 from \"../get-planned-route/get-planned-route.component\";\nconst _c0 = [\"canvas\"];\nexport class NetworkComponent {\n  constructor(route, warehousesService, routesService, trucksService) {\n    this.route = route;\n    this.warehousesService = warehousesService;\n    this.routesService = routesService;\n    this.trucksService = trucksService; //* Stage Properties;\n\n    this.cameraZ = 400; //* Aproximação da câmara || Coordenada Z\n\n    this.fieldOfView = 5; //* Distância da câmara\n\n    this.nearClippingPlane = 1; //* Proximidade do plano\n\n    this.farClippingPlane = 30000; //* Afastamento do plano\n\n    this.warehouses = [];\n    this.routes = [];\n    this.trucks = [];\n    this.activeTrucks = [];\n    this.manualTruckRoads = [];\n    this.warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\n    this.checkerNetworkPlanedRoutes = true;\n    this.activateMotion = false;\n    this.isAutomaticMovement = false;\n    this.activateManualMovement = false;\n    this.pathsData = new Map([]);\n    this.currentDistance = 0;\n    this.speed = 0.2;\n    this.roadsData = new Map([]);\n    this.ambientSoundLoader = new THREE.AudioLoader();\n    this.ambientListener = new THREE.AudioListener();\n    this.ambientAudio = new THREE.Audio(this.ambientListener);\n    this.truckSoundLoader = new THREE.AudioLoader();\n    this.truckListener = new THREE.AudioListener();\n    this.truckAudio = new THREE.Audio(this.truckListener);\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.importLoaders();\n    this.warehousesService.getWarehouses().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (data) {\n        _this.warehouses = data;\n        console.log(_this.warehouses);\n\n        _this.routesService.getRoutes().subscribe( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (data) {\n            _this.routes = data;\n            console.log(_this.routes);\n\n            _this.trucksService.getTrucks().subscribe( /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator(function* (data) {\n                _this.trucks = data;\n                console.log(_this.trucks);\n                yield _this.createScene();\n                yield _this.startRenderingLoop();\n              });\n\n              return function (_x3) {\n                return _ref3.apply(this, arguments);\n              };\n            }());\n          });\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  ngAfterViewInit() {}\n\n  get canvas() {\n    return this.canvasRef.nativeElement;\n  } //tamanho da janela\n\n\n  static getAspectRatio() {\n    return window.innerWidth / window.innerHeight;\n  }\n\n  createScene() {\n    //* Scene\n    this.scene = new THREE.Scene(); //* Camera\n\n    this.camera = new THREE.PerspectiveCamera(this.fieldOfView, NetworkComponent.getAspectRatio(), this.nearClippingPlane, this.farClippingPlane); //fog\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\n\n    this.camera.position.z = this.cameraZ;\n    this.scene.add(this.camera); //sounds\n\n    this.camera.add(this.ambientListener);\n    this.camera.add(this.truckListener);\n    this.addSkybox();\n    this.addWarehouses();\n    this.addLights();\n  }\n\n  addSkybox() {\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000, 1000);\n    let skyboxMaterials = [new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshStandardMaterial({\n      map: this.skyBoxGroundTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    })];\n    let skybox = new THREE.Mesh(skyboxGeo, skyboxMaterials);\n    skybox.position.y = 400;\n    skybox.receiveShadow = true;\n    this.scene.add(skybox);\n  }\n\n  startRenderingLoop() {\n    //* Renderer\n    // Use canvas element in template\n    this.renderer = new THREE.WebGLRenderer({\n      canvas: this.canvas,\n      antialias: true\n    });\n    this.renderer.setPixelRatio(window.devicePixelRatio); //definir janela\n\n    this.renderer.setSize(window.innerWidth, window.innerHeight); //ShadowMap para permitir Sombras\n\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; //Orbit Controls\n\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\n    controls.maxDistance = 1500; //900 zoom out\n\n    controls.minDistance = 50; //100 zoom in\n\n    controls.minAzimuthAngle = -Math.PI; //Rotação D 90º\n\n    controls.maxAzimuthAngle = Math.PI; //Rotação E 90º\n\n    controls.maxPolarAngle = Math.PI / 2; //Rotação Eixo Y 90º\n    // controls.minPolarAngle=Math.PI/2\n\n    let component = this;\n\n    (function render() {\n      requestAnimationFrame(render); //Render truck Movement animation\n\n      component.manualMovement();\n      component.automaticMovement(); //janelade visualização\n\n      component.renderer.setViewport(-200, 0, window.innerWidth + 200, window.innerHeight);\n      component.renderer.setClearColor(0xCADFED, 1);\n      component.renderer.render(component.scene, component.camera);\n    })();\n  }\n\n  addWarehouses() {\n    for (let i = 0; i < this.warehouses.length; i++) {\n      let warehouseBaseMaterial = [new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        map: this.roundaboutTexture\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      })];\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, warehouseBaseMaterial); //*Base da Warehouse\n\n      base.position.set(NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\n      base.name = this.warehouses[i].warehouseIdentifier;\n      base.castShadow = true;\n      base.receiveShadow = true; //Nomes cidades\n\n      let sprite = new TextSprite({\n        text: this.warehouses[i].designation,\n        alignment: 'left',\n        color: '#000000',\n        fontFamily: '\"Arial\", Times, serif',\n        fontStyle: 'italic'\n      });\n      sprite.position.set(base.position.x, base.position.y + 3.2, base.position.z);\n      this.scene.add(sprite);\n      let warehouse3D = this.warehouse3D.clone();\n      warehouse3D.name = this.warehouses[i].designation;\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\n      this.scene.add(warehouse3D);\n      this.scene.add(base);\n    }\n\n    this.addRoads();\n  }\n\n  addRoads() {\n    for (let i = 0; i < this.routes.length; i++) {\n      let ware0 = this.scene.getObjectByName(this.routes[i].departureId);\n      let ware1 = this.scene.getObjectByName(this.routes[i].arrivalId);\n\n      if (ware0 != null && ware1 != null) {\n        let teta0 = Math.atan2(-(ware1.position.z - ware0.position.z), ware1.position.x - ware0.position.x);\n        let teta1 = Math.PI + teta0;\n        let elemLigMaterial = [new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          map: this.elemLigTexture\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        })];\n        let elemLigGeometry = new THREE.BoxGeometry(0.3, 0.20, 2);\n        let elemLig0Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig0Mesh.position.set(ware0.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta0), ware0.position.y, ware0.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta0));\n        elemLig0Mesh.rotateY(teta0);\n        elemLig0Mesh.castShadow = true;\n        elemLig0Mesh.receiveShadow = true;\n        this.scene.add(elemLig0Mesh);\n        let elemLig1Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig1Mesh.position.set(ware1.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta1), ware1.position.y, ware1.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta1));\n        elemLig1Mesh.rotateY(teta1);\n        elemLig1Mesh.castShadow = true;\n        elemLig1Mesh.receiveShadow = true;\n        this.scene.add(elemLig1Mesh);\n        let roadMaterial = [new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          map: this.roadTexture\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        })];\n        let roadGeometry = new THREE.BoxGeometry(2, 0.20, Math.sqrt(Math.pow(elemLig0Mesh.position.x - elemLig1Mesh.position.x, 2) + Math.pow(elemLig0Mesh.position.y - elemLig1Mesh.position.y, 2) + Math.pow(elemLig0Mesh.position.z - elemLig1Mesh.position.z, 2)));\n        let roadMesh = new THREE.Mesh(roadGeometry, roadMaterial);\n        roadMesh.position.set((elemLig0Mesh.position.x + elemLig1Mesh.position.x) / 2, (elemLig0Mesh.position.y + elemLig1Mesh.position.y) / 2, (elemLig0Mesh.position.z + elemLig1Mesh.position.z) / 2);\n        roadMesh.castShadow = true;\n        roadMesh.receiveShadow = true;\n        this.scene.add(roadMesh);\n        let beta = Math.asin((elemLig0Mesh.position.y - elemLig1Mesh.position.y) / roadGeometry.parameters.depth);\n        let omega = teta0 + Math.PI / 2;\n        roadMesh.rotation.set(beta, omega, 0, \"ZYX\");\n        this.roadsData.set(this.routes[i].routeId, [teta0, teta1, elemLig0Mesh.position.x, elemLig0Mesh.position.y, elemLig0Mesh.position.z, elemLig1Mesh.position.x, elemLig1Mesh.position.y, elemLig1Mesh.position.z, roadMesh.position.x, roadMesh.position.y, roadMesh.position.z, beta, teta0 + Math.PI / 2]);\n      }\n    }\n  }\n\n  addLights() {\n    //*Light\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\n    this.scene.add(light_amb);\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directLight.castShadow = true;\n    this.camera.add(directLight);\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\n    spotLight.position.set(0, 500, 40);\n    spotLight.castShadow = true;\n    spotLight.target.position.set(0, 0, 40);\n    spotLight.shadow.mapSize.width = 2048;\n    spotLight.shadow.mapSize.height = 2048;\n    spotLight.shadow.camera.far = 1000;\n    this.scene.add(spotLight);\n    this.scene.add(spotLight.target);\n  }\n\n  addTruck(truckName, truckInitialPosition) {\n    const truck3D = this.truck3D.clone();\n    truck3D.name = truckName;\n    truck3D.position.set(truckInitialPosition.x, truckInitialPosition.y, truckInitialPosition.z);\n    this.scene.add(truck3D);\n\n    if (this.isAutomaticMovement) {\n      this.activeTrucks.push(this.scene.getObjectByName(truck3D.name));\n    }\n  }\n\n  setAutomaticMovementRoutAndTruck(el, map) {\n    map.forEach((value, key) => {\n      this.automaticTruck = key;\n      let path = new THREE.CurvePath();\n      let divisionCount = 10;\n\n      for (let i = 0; i < value.length - 1; i++) {\n        let road = this.getRouteByWarehouses(value[i], value[i + 1]);\n        let wareDeparture = this.scene.getObjectByName(value[i]);\n        let warehouseArrival = this.scene.getObjectByName(value[i + 1]);\n        let roadData = this.roadsData.get(road?.routeId);\n\n        if (roadData != undefined && warehouseArrival != undefined && wareDeparture != undefined) {\n          if (!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)) {\n            let rightMovement_X = 0.45 * Math.cos(roadData[NetworkComponent.TETA_0] - Math.PI / 2);\n            let rightMovement_Z = 0.45 * Math.sin(roadData[NetworkComponent.TETA_0] + Math.PI / 2);\n\n            if (i == 0) {\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z))); //W0-EL0\n            } //road\n\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\n            let nextRoadData = this.roadsData.get(this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\n\n            if (i < value.length - 2 && nextRoadData != null) {\n              //Rotunda\n              let vectorEl0_Ware = new THREE.Vector3().subVectors(warehouseArrival.position, new Vector3(roadData[NetworkComponent.EL1_X], roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z])).normalize();\n              let vectorWAre_EL1 = new THREE.Vector3().subVectors(new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z]), warehouseArrival.position).normalize();\n              let delta = vectorEl0_Ware.angleTo(vectorWAre_EL1);\n              let t = (Math.PI - delta) / divisionCount;\n\n              for (let j = 0; j < divisionCount - 1; j++) {\n                if (j == 0) {\n                  path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + j * t))));\n                }\n\n                if (j > 0 && j < divisionCount - 2) {\n                  path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + j * t))));\n                }\n\n                if (j == divisionCount - 2) {\n                  if (this.isRegisteredFirstOnRoutObject(value[i + 1], value[i + 2])) {\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + j * t))));\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + j * t)), new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z])));\n                  } else {\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + j * t))));\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + (j - 1) * t)), new Vector3(nextRoadData[NetworkComponent.EL0_X], nextRoadData[NetworkComponent.EL0_Y], nextRoadData[NetworkComponent.EL0_Z])));\n                  }\n                }\n              }\n            }\n\n            if (i == value.length - 2) {\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\n            }\n          } else {\n            let rightMovement_X = 0.45 * Math.cos(roadData[NetworkComponent.TETA_1] - Math.PI / 2);\n            let rightMovement_Z = 0.45 * Math.sin(roadData[NetworkComponent.TETA_1] + Math.PI / 2);\n\n            if (i == 0) {\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\n            } //road\n\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z))); //EL0-EL0_ROAD\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z))); //EL0-ROAD_ROAD\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z))); //ROAD-ROAD_EL1\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z))); //ROAD_EL1_EL1\n\n            let nextRoadData = this.roadsData.get(this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\n\n            if (value.length - 2 && nextRoadData != null) {\n              //Roundabout\n              let vectorEl0_Ware = new THREE.Vector3().subVectors(warehouseArrival.position, new Vector3(roadData[NetworkComponent.EL0_X], roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z])).normalize();\n              let vectorWAre_EL1 = new THREE.Vector3().subVectors(new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z]), warehouseArrival.position).normalize();\n              let delta = vectorEl0_Ware.angleTo(vectorWAre_EL1);\n              let t = (Math.PI + delta) / divisionCount;\n\n              for (let j = 0; j < divisionCount - 1; j++) {\n                if (j == 0) {\n                  path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(roadData[NetworkComponent.TETA_0] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + j * t))));\n                }\n\n                if (j > 0 && j < divisionCount - 2) {\n                  path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + j * t))));\n                }\n\n                if (j == divisionCount - 2) {\n                  if (this.isRegisteredFirstOnRoutObject(value[i + 1], value[i + 2])) {\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + j * t))));\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + j * t)), new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z])));\n                  } else {\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + (j - 1) * t)), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + j * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + j * t))));\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + (j - 1) * t), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + (j - 1) * t)), new Vector3(nextRoadData[NetworkComponent.EL0_X], nextRoadData[NetworkComponent.EL0_Y], nextRoadData[NetworkComponent.EL0_Z])));\n                  }\n                }\n              }\n            }\n\n            if (i == value.length - 2) {\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\n            }\n          }\n        }\n      }\n\n      path.autoClose = true;\n      this.pathLength = path.getLength();\n      this.pathsData.set(key, path); // @ts-ignore\n\n      this.automaticTruckInitialPosition = new Vector3(this.scene.getObjectByName(value[0])?.position.x, this.scene.getObjectByName(value[0])?.position.y, this.scene.getObjectByName(value[0])?.position.z + 2);\n      this.scrollDone(el, null);\n    });\n  }\n\n  startAutomaticMovement() {\n    //ativar o som do camião\n    this.truckAudio.play();\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x3 != null && z != null) {\n      if (x3.style.display === \"block\" && z.style.display === \"none\") {\n        z.style.display = \"block\";\n        x3.style.display = \"none\"; //ativar o movimento do camião\n\n        this.activateMotion = true;\n      }\n    }\n  }\n\n  automaticMovement() {\n    //Automatic truck movement\n    if (this.activateMotion && this.activeTrucks.length != 0) {\n      for (let i = 0; i < this.activeTrucks.length; i++) {\n        // @ts-ignore\n        let points = this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\n\n        if (points != undefined) {\n          this.activeTrucks[i]?.lookAt(points);\n          this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\n          this.currentDistance += this.speed;\n\n          if (this.currentDistance >= this.pathLength) {\n            this.activateMotion = false;\n            this.scene.remove(this.activeTrucks[i]);\n            this.pathsData.delete(this.activeTrucks[i].name);\n            this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\n            this.truckAudio.stop();\n            this.currentDistance = 0;\n            this.automaticTruckInitialPosition = new Vector3();\n          }\n        }\n      }\n    }\n  }\n\n  startManualMovement() {\n    //ativar o som do camião\n    this.truckAudio.play();\n    let optionStartManualDelivery = document.getElementById(\"OptionStartManualDelivery\");\n    let optionStopManualDelivery = document.getElementById(\"OptionStopManualDelivery\");\n\n    if (optionStartManualDelivery != null && stop != null) {\n      optionStartManualDelivery.style.display = \"none\";\n      optionStopManualDelivery.style.display = \"block\"; //ativar o movimento do camião\n\n      this.activateManualMovement = true;\n    }\n  }\n\n  stopManualMovement() {\n    //ativar o som do camião\n    this.truckAudio.stop();\n    let optionStopManualDelivery = document.getElementById(\"OptionStopManualDelivery\");\n    let optionMakeDelivery = document.getElementById(\"OptionMakeDelivery\");\n\n    if (optionStopManualDelivery != null && optionMakeDelivery != null) {\n      optionMakeDelivery.style.display = \"block\";\n      optionStopManualDelivery.style.display = \"none\"; //ativar o movimento do camião\n\n      this.activateManualMovement = false;\n    }\n  }\n\n  manualMovement() {\n    if (this.activateManualMovement) {\n      let truck = this.scene.getObjectByName(this.manualTruck);\n\n      document.onkeydown = function (e) {\n        switch (e.key) {\n          case \"a\":\n            //rodar a camara para a esquerda\n            truck?.position.set(truck?.position.x - 0.1, truck?.position.y, truck?.position.z);\n            break;\n\n          case \"d\":\n            //rodar a camara para a direita\n            truck?.position.set(truck?.position.x + 0.1, truck?.position.y, truck?.position.z);\n            break;\n\n          case \"w\":\n            //avançar - incrementar a posição da camara no eixo dos zz\n            truck?.position.set(truck?.position.x, truck?.position.y, truck?.position.z - 0.1);\n            break;\n\n          case \"s\":\n            //recuar - decrementar a posição da camara no eixo dos zz\n            truck?.position.set(truck?.position.x, truck?.position.y, truck?.position.z + 0.1);\n            break;\n\n          default:\n            break;\n        }\n      };\n    }\n  }\n\n  static getCoordinates(lat, lon, alt) {\n    let coordinatesArr = [];\n    const min = -100;\n    const max = 100;\n    const med = max / 2;\n    coordinatesArr[0] = -((max - min) / (8.7613 - 8.2451) * (lon - 8.2451) + min);\n    coordinatesArr[1] = (med - -med) / (42.1115 - 40.8387) * (lat - 40.8387) + -med;\n    coordinatesArr[2] = max / 800 * alt;\n    parseInt(coordinatesArr[0].toFixed(4));\n    parseInt(coordinatesArr[1].toFixed(4));\n    parseInt(coordinatesArr[2].toFixed(4));\n    return coordinatesArr;\n  }\n\n  onClick() {}\n\n  onMouseMove(event) {}\n\n  importLoaders() {\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\n    this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', buffer => {\n      this.truckAudio.setBuffer(buffer);\n      this.truckAudio.setLoop(true);\n      this.truckAudio.setVolume(0.5);\n    });\n    this.skyBoxTexture = new THREE.TextureLoader().load('assets/network/sky.jpg');\n    this.skyBoxGroundTexture = new THREE.TextureLoader().load('assets/network/ground.jpg');\n    this.skyBoxGroundTexture.anisotropy = 16;\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.generateMipmaps = false;\n    this.skyBoxGroundTexture.needsUpdate = true;\n    const loaderWare = new GLTFLoader();\n    loaderWare.load('/assets/network/warehouse.glb', gltf => {\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.warehouse3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    const loaderTruck = new GLTFLoader();\n    loaderTruck.load('/assets/network/Truck.glb', gltf => {\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.truck3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    this.roundaboutTexture = new THREE.TextureLoader().load('assets/network/rotunda.jpg');\n    this.elemLigTexture = new THREE.TextureLoader().load('assets/network/road.jpg');\n    this.elemLigTexture.anisotropy = 16;\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\n    this.elemLigTexture.generateMipmaps = false;\n    this.elemLigTexture.needsUpdate = true;\n    this.roadTexture = new THREE.TextureLoader().load('assets/network/road1.jpg');\n    this.roadTexture.anisotropy = 16;\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.roadTexture.minFilter = THREE.LinearFilter;\n    this.roadTexture.magFilter = THREE.LinearFilter;\n    this.roadTexture.generateMipmaps = false;\n    this.roadTexture.needsUpdate = true;\n  } //Auxiliar Methods\n\n\n  getRouteByWarehouses(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return this.routes[i];\n      }\n\n      if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return this.routes[i];\n      }\n    }\n\n    return null;\n  }\n\n  isRegisteredFirstOnRoutObject(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return true;\n      } else if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return false;\n      }\n    }\n\n    return false;\n  }\n\n  wareDesignationToWareIdConverter(wareDesignation) {\n    for (let i = 0; i < this.warehouses.length; i++) {\n      if (this.warehouses[i].designation == wareDesignation) {\n        return this.warehouses[i].warehouseIdentifier;\n      }\n    }\n\n    return \"\";\n  }\n\n  makeDelivery() {\n    let x1 = document.getElementById(\"OptionManualDelivery\");\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x1 != null && x2 != null && z != null) {\n      if (x1.style.display === \"none\" && x2.style.display === \"none\") {\n        x1.style.display = \"block\";\n        x2.style.display = \"block\";\n        z.style.display = \"none\";\n      }\n    }\n  }\n\n  scrollAutomaticDelivery(el) {\n    this.isAutomaticMovement = true;\n    let automaticSection = document.getElementById(\"AutomaticSection\");\n\n    if (automaticSection != null) {\n      automaticSection.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollManualDelivery(el) {\n    this.isAutomaticMovement = false;\n    let manualSection = document.getElementById(\"ManualSection\");\n\n    if (manualSection != null) {\n      manualSection.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollDone(el, map) {\n    let buttonDoneSection = document.getElementById(\"ButtonDoneSection\");\n\n    if (buttonDoneSection != null) {\n      buttonDoneSection.style.display = \"block\";\n    }\n\n    if (map != null) {\n      map.forEach((road, truck) => {\n        console.log(\"aquii\");\n        console.log(\"truck- \" + truck);\n        console.log(\"road- \" + road);\n        this.manualTruck = truck;\n        let roadSplit = road.trim().split(\"-\");\n\n        for (let i = 0; i < roadSplit[0].length; i++) {\n          roadSplit[0].trimStart();\n          roadSplit[0].trimEnd();\n        }\n\n        for (let i = 0; i < roadSplit[0].length; i++) {\n          roadSplit[1].trimStart();\n          roadSplit[1].trimEnd();\n        }\n\n        console.log(\"roadsplit- \" + roadSplit);\n        console.log(\"ware0 -\" + roadSplit[0] + \"AAAAAA\");\n        let ware0 = this.wareDesignationToWareIdConverter(roadSplit[0].trim());\n        let ware1 = this.wareDesignationToWareIdConverter(roadSplit[1].trim());\n        console.log(\"ware0 - \" + ware0);\n        console.log(\"ware1 - \" + ware1);\n        let vector = this.roadsData.get(this.getRouteByWarehouses(ware0, ware1).routeId);\n\n        if (!this.isRegisteredFirstOnRoutObject(ware0, ware1)) {\n          this.manualTruckInitialPosition.set(vector[NetworkComponent.EL0_X], vector[NetworkComponent.EL0_Y], vector[NetworkComponent.EL0_Z]);\n        } else {\n          this.manualTruckInitialPosition.set(vector[NetworkComponent.EL1_X], vector[NetworkComponent.EL1_Y], vector[NetworkComponent.EL1_Z]);\n        }\n      });\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollCanvas(el) {\n    if (this.isAutomaticMovement) {\n      this.addTruck(this.automaticTruck, this.automaticTruckInitialPosition);\n    } else {\n      this.addTruck(this.manualTruck, this.manualTruckInitialPosition);\n    }\n\n    let optionManualDelivery = document.getElementById(\"OptionManualDelivery\");\n    let optionAutomaticDelivery = document.getElementById(\"OptionAutomaticDelivery\");\n    let optionStartAutomaticOrManualDelivery;\n\n    if (this.isAutomaticMovement) {\n      optionStartAutomaticOrManualDelivery = document.getElementById(\"OptionStartAutomaticDelivery\");\n    } else {\n      optionStartAutomaticOrManualDelivery = document.getElementById(\"OptionStartManualDelivery\");\n    }\n\n    let automaticSection = document.getElementById(\"AutomaticSection\");\n    let manualSection = document.getElementById(\"ManualSection\");\n    let buttonDoneSection = document.getElementById(\"ButtonDoneSection\");\n\n    if (optionManualDelivery != null && optionAutomaticDelivery != null && optionStartAutomaticOrManualDelivery != null && automaticSection != null && manualSection != null && buttonDoneSection != null) {\n      optionManualDelivery.style.display = \"none\";\n      optionAutomaticDelivery.style.display = \"none\";\n      optionStartAutomaticOrManualDelivery.style.display = \"block\";\n      automaticSection.style.display = \"none\";\n      manualSection.style.display = \"none\";\n      buttonDoneSection.style.display = \"none\";\n      el.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }\n\n}\nNetworkComponent.TETA_0 = 0;\nNetworkComponent.TETA_1 = 1;\nNetworkComponent.EL0_X = 2;\nNetworkComponent.EL0_Y = 3;\nNetworkComponent.EL0_Z = 4;\nNetworkComponent.EL1_X = 5;\nNetworkComponent.EL1_Y = 6;\nNetworkComponent.EL1_Z = 7;\nNetworkComponent.ROAD_X = 8;\nNetworkComponent.ROAD_Y = 9;\nNetworkComponent.ROAD_Z = 10;\nNetworkComponent.BETA = 11;\nNetworkComponent.OMEGA = 12;\n\nNetworkComponent.ɵfac = function NetworkComponent_Factory(t) {\n  return new (t || NetworkComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.WarehousesService), i0.ɵɵdirectiveInject(i3.RoutesService), i0.ɵɵdirectiveInject(i4.TrucksService));\n};\n\nNetworkComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: NetworkComponent,\n  selectors: [[\"app-network\"]],\n  viewQuery: function NetworkComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n    }\n  },\n  inputs: {\n    cameraZ: \"cameraZ\",\n    fieldOfView: \"fieldOfView\",\n    nearClippingPlane: [\"nearClipping\", \"nearClippingPlane\"],\n    farClippingPlane: [\"farClipping\", \"farClippingPlane\"]\n  },\n  decls: 39,\n  vars: 1,\n  consts: [[\"id\", \"SectionNavbar\", 1, \"navbar\"], [\"href\", \"/views/login\"], [\"id\", \"OptionMakeDelivery\", 3, \"click\"], [\"id\", \"OptionManualDelivery\", 2, \"display\", \"none\"], [3, \"click\"], [\"id\", \"OptionAutomaticDelivery\", 2, \"display\", \"none\"], [\"id\", \"OptionStartAutomaticDelivery\", 2, \"display\", \"none\"], [\"id\", \"OptionStartManualDelivery\", 2, \"display\", \"none\"], [\"id\", \"OptionStopManualDelivery\", 2, \"display\", \"none\"], [1, \"page\"], [1, \"center\"], [\"canvasSection\", \"\"], [\"id\", \"canvas\", 3, \"mousemove\", \"click\"], [\"canvas\", \"\"], [\"Automatic\", \"\"], [\"id\", \"AutomaticSection\", 2, \"display\", \"none\", 3, \"networkChecker\", \"getRouteAndTruckEvent\"], [\"Manual\", \"\"], [\"id\", \"ManualSection\", 2, \"display\", \"none\", 3, \"getRouteAndTruckEvent\"], [2, \"align-content\", \"center\"], [\"id\", \"ButtonDoneSection\", \"role\", \"button\", 1, \"button-73\", 2, \"display\", \"none\", 3, \"click\"], [\"done\", \"\"]],\n  template: function NetworkComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r5 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"nav\", 0)(1, \"ul\")(2, \"li\")(3, \"a\", 1);\n      i0.ɵɵtext(4, \"Home\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"li\")(6, \"a\", 2);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_6_listener() {\n        return ctx.makeDelivery();\n      });\n      i0.ɵɵtext(7, \"Make Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"li\", 3)(9, \"a\", 4);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_9_listener() {\n        i0.ɵɵrestoreView(_r5);\n\n        const _r2 = i0.ɵɵreference(30);\n\n        return i0.ɵɵresetView(ctx.scrollManualDelivery(_r2));\n      });\n      i0.ɵɵtext(10, \"Manual Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"li\", 5)(12, \"a\", 4);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_12_listener() {\n        i0.ɵɵrestoreView(_r5);\n\n        const _r3 = i0.ɵɵreference(33);\n\n        return i0.ɵɵresetView(ctx.scrollAutomaticDelivery(_r3));\n      });\n      i0.ɵɵtext(13, \"Automatic Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"li\", 6)(15, \"a\", 4);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_15_listener() {\n        return ctx.startAutomaticMovement();\n      });\n      i0.ɵɵtext(16, \"Start\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"li\", 7)(18, \"a\", 4);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_18_listener() {\n        return ctx.startManualMovement();\n      });\n      i0.ɵɵtext(19, \"Start\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(20, \"li\", 8)(21, \"a\", 4);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_21_listener() {\n        return ctx.stopManualMovement();\n      });\n      i0.ɵɵtext(22, \"Stop\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(23, \"div\", 9)(24, \"div\", 10)(25, \"div\", null, 11)(27, \"canvas\", 12, 13);\n      i0.ɵɵlistener(\"mousemove\", function NetworkComponent_Template_canvas_mousemove_27_listener($event) {\n        return ctx.onMouseMove($event);\n      })(\"click\", function NetworkComponent_Template_canvas_click_27_listener() {\n        return ctx.onClick();\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(29, \"div\", null, 14)(31, \"app-get-planned-route\", 15);\n      i0.ɵɵlistener(\"getRouteAndTruckEvent\", function NetworkComponent_Template_app_get_planned_route_getRouteAndTruckEvent_31_listener($event) {\n        i0.ɵɵrestoreView(_r5);\n\n        const _r4 = i0.ɵɵreference(37);\n\n        return i0.ɵɵresetView(ctx.setAutomaticMovementRoutAndTruck(_r4, $event));\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(32, \"div\", null, 16)(34, \"app-choose-truck-and-route\", 17);\n      i0.ɵɵlistener(\"getRouteAndTruckEvent\", function NetworkComponent_Template_app_choose_truck_and_route_getRouteAndTruckEvent_34_listener($event) {\n        i0.ɵɵrestoreView(_r5);\n\n        const _r4 = i0.ɵɵreference(37);\n\n        return i0.ɵɵresetView(ctx.scrollDone(_r4, $event));\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(35, \"div\", 18)(36, \"button\", 19, 20);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_button_click_36_listener() {\n        i0.ɵɵrestoreView(_r5);\n\n        const _r0 = i0.ɵɵreference(26);\n\n        return i0.ɵɵresetView(ctx.scrollCanvas(_r0));\n      });\n      i0.ɵɵtext(38, \"Done\");\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(31);\n      i0.ɵɵproperty(\"networkChecker\", ctx.checkerNetworkPlanedRoutes);\n    }\n  },\n  dependencies: [i5.ChooseTruckAndRouteComponent, i6.GetPlannedRouteComponent],\n  styles: [\"*[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\nbody[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  font-family: \\\"Lato\\\", sans-serif;\\r\\n  background: #EFEEF4;\\r\\n  line-height: 1.6;\\r\\n  height: 100vh;\\r\\n  overflow: hidden;\\r\\n}\\r\\n\\r\\n.container[_ngcontent-%COMP%]{\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  overflow-y: scroll;\\r\\n  scroll-behavior: smooth;\\r\\n  scroll-snap-type: y mandatory;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]{\\r\\n  position: fixed;\\r\\n  top:0;\\r\\n  z-index: 1;\\r\\n  display: flex;\\r\\n  width: 100%;\\r\\n  height: 60px;\\r\\n  background: rgba(239,238,244,0.7);\\r\\n  font-weight: 700;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{\\r\\n  display: flex;\\r\\n  list-style: none;\\r\\n  width: 100%;\\r\\n  justify-content: center;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{\\r\\n  margin: 0 1rem;\\r\\n  padding: 1rem;\\r\\n  font-family: 'Secular One', sans-serif;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{\\r\\n  text-decoration: none;\\r\\n  text-transform: uppercase;\\r\\n\\r\\n  color: #778DB3;\\r\\n  font-size: 1.5rem;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{\\r\\n  color: skyblue;\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n.button-73[_ngcontent-%COMP%] {\\r\\n  background-color: #FFFFFF;\\r\\n  border-radius: 40em;\\r\\n  border-style: none;\\r\\n  box-shadow: #ADCFFF 0 -12px 6px inset;\\r\\n  box-sizing: border-box;\\r\\n  color: #000000;\\r\\n  cursor: pointer;\\r\\n  font-family: 'Secular One', sans-serif;\\r\\n  font-size: 1rem;\\r\\n  font-weight: 600;\\r\\n  padding: 1rem 1.3rem;\\r\\n  quotes: auto;\\r\\n  text-align: center;\\r\\n  text-decoration: none;\\r\\n  transition: all .15s;\\r\\n  user-select: none;\\r\\n  -webkit-user-select: none;\\r\\n  touch-action: manipulation;\\r\\n  margin-left: 47%;\\r\\n  margin-bottom: 1%;\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:hover {\\r\\n  background-color: #778DB3;\\r\\n  box-shadow: #37465f 0 -6px 8px inset;\\r\\n  transform: scale(1);\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:active {\\r\\n  transform: scale(1);\\r\\n}\\r\\n\\r\\n@media (min-width: 768px) {\\r\\n  .button-73[_ngcontent-%COMP%] {\\r\\n    font-size: 1rem;\\r\\n    padding: .75rem 2rem;\\r\\n  }\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ldHdvcmsuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFNBQVM7RUFDVCxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxTQUFTO0VBQ1QsK0JBQStCO0VBQy9CLG1CQUFtQjtFQUNuQixnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHVCQUF1QjtFQUN2Qiw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsS0FBSztFQUNMLFVBQVU7RUFDVixhQUFhO0VBQ2IsV0FBVztFQUNYLFlBQVk7RUFDWixpQ0FBaUM7RUFDakMsZ0JBQWdCOztBQUVsQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxhQUFhO0VBQ2Isc0NBQXNDOztBQUV4Qzs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQix5QkFBeUI7O0VBRXpCLGNBQWM7RUFDZCxpQkFBaUI7O0FBRW5COztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFDQSxRQUFROztBQUNSO0VBQ0UseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIscUNBQXFDO0VBQ3JDLHNCQUFzQjtFQUN0QixjQUFjO0VBQ2QsZUFBZTtFQUNmLHNDQUFzQztFQUN0QyxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLG9CQUFvQjtFQUNwQixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHFCQUFxQjtFQUNyQixvQkFBb0I7RUFDcEIsaUJBQWlCO0VBQ2pCLHlCQUF5QjtFQUN6QiwwQkFBMEI7RUFDMUIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixvQ0FBb0M7RUFDcEMsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0U7SUFDRSxlQUFlO0lBQ2Ysb0JBQW9CO0VBQ3RCO0FBQ0YiLCJmaWxlIjoibmV0d29yay5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiKntcclxuICBtYXJnaW46IDA7XHJcbiAgcGFkZGluZzogMDtcclxufVxyXG5cclxuYm9keXtcclxuICBtYXJnaW46IDA7XHJcbiAgZm9udC1mYW1pbHk6IFwiTGF0b1wiLCBzYW5zLXNlcmlmO1xyXG4gIGJhY2tncm91bmQ6ICNFRkVFRjQ7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNjtcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbn1cclxuXHJcbi5jb250YWluZXJ7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIG92ZXJmbG93LXk6IHNjcm9sbDtcclxuICBzY3JvbGwtYmVoYXZpb3I6IHNtb290aDtcclxuICBzY3JvbGwtc25hcC10eXBlOiB5IG1hbmRhdG9yeTtcclxufVxyXG5cclxuLm5hdmJhcntcclxuICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgdG9wOjA7XHJcbiAgei1pbmRleDogMTtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGhlaWdodDogNjBweDtcclxuICBiYWNrZ3JvdW5kOiByZ2JhKDIzOSwyMzgsMjQ0LDAuNyk7XHJcbiAgZm9udC13ZWlnaHQ6IDcwMDtcclxuXHJcbn1cclxuXHJcbi5uYXZiYXIgdWx7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBsaXN0LXN0eWxlOiBub25lO1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG59XHJcblxyXG4ubmF2YmFyIHVsIGxpe1xyXG4gIG1hcmdpbjogMCAxcmVtO1xyXG4gIHBhZGRpbmc6IDFyZW07XHJcbiAgZm9udC1mYW1pbHk6ICdTZWN1bGFyIE9uZScsIHNhbnMtc2VyaWY7XHJcblxyXG59XHJcblxyXG4ubmF2YmFyIHVsIGxpIGF7XHJcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XHJcblxyXG4gIGNvbG9yOiAjNzc4REIzO1xyXG4gIGZvbnQtc2l6ZTogMS41cmVtO1xyXG5cclxufVxyXG5cclxuLm5hdmJhciB1bCBsaSBhOmhvdmVye1xyXG4gIGNvbG9yOiBza3libHVlO1xyXG59XHJcbi8qIENTUyAqL1xyXG4uYnV0dG9uLTczIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRkZGO1xyXG4gIGJvcmRlci1yYWRpdXM6IDQwZW07XHJcbiAgYm9yZGVyLXN0eWxlOiBub25lO1xyXG4gIGJveC1zaGFkb3c6ICNBRENGRkYgMCAtMTJweCA2cHggaW5zZXQ7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBjb2xvcjogIzAwMDAwMDtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgZm9udC1mYW1pbHk6ICdTZWN1bGFyIE9uZScsIHNhbnMtc2VyaWY7XHJcbiAgZm9udC1zaXplOiAxcmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgcGFkZGluZzogMXJlbSAxLjNyZW07XHJcbiAgcXVvdGVzOiBhdXRvO1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgdHJhbnNpdGlvbjogYWxsIC4xNXM7XHJcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcclxuICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjtcclxuICBtYXJnaW4tbGVmdDogNDclO1xyXG4gIG1hcmdpbi1ib3R0b206IDElO1xyXG59XHJcblxyXG4uYnV0dG9uLTczOmhvdmVyIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNzc4REIzO1xyXG4gIGJveC1zaGFkb3c6ICMzNzQ2NWYgMCAtNnB4IDhweCBpbnNldDtcclxuICB0cmFuc2Zvcm06IHNjYWxlKDEpO1xyXG59XHJcblxyXG4uYnV0dG9uLTczOmFjdGl2ZSB7XHJcbiAgdHJhbnNmb3JtOiBzY2FsZSgxKTtcclxufVxyXG5cclxuQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSB7XHJcbiAgLmJ1dHRvbi03MyB7XHJcbiAgICBmb250LXNpemU6IDFyZW07XHJcbiAgICBwYWRkaW5nOiAuNzVyZW0gMnJlbTtcclxuICB9XHJcbn1cclxuIl19 */\"]\n});","map":{"version":3,"mappings":";AAAA,SAAmCA,UAAnC,QAA+E,eAA/E;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AAEA,OAAOC,UAAP,MAAuB,6BAAvB;AACA,SAAqBC,KAArB,EAA4BC,UAA5B,EAA8CC,iBAA9C,EAAiEC,oBAAjE,EAAuFC,QAAvF,EAAiGC,OAAjG,QAA+G,OAA/G;AACA,SAASC,aAAT,QAA8B,2CAA9B;AACA,SAASC,UAAT,QAA0B,uCAA1B;;;;;;;;;AAUA,OAAM,MAAOC,gBAAP,CAAuB;EAmE3BC,YAAoBC,KAApB,EAAmDC,iBAAnD,EAAgGC,aAAhG,EAAoIC,aAApI,EAA+J;IAA3I;IAA+B;IAA6C;IAAoC,mCAA2B,CA7D/J;;IACgB,eAAkB,GAAlB,CA4D+I,CA5DxH;;IACvB,mBAAsB,CAAtB,CA2D+I,CA3DrH;;IACZ,yBAA4B,CAA5B,CA0DiI,CA1DnG;;IAC/B,wBAA2B,KAA3B,CAyDkI,CAzDjG;;IAOtD,kBAAiB,EAAjB;IACA,cAAe,EAAf;IAAkB,cAAe,EAAf;IAElB,oBAAwB,EAAxB;IAKR,wBAA0B,EAA1B;IAQQ,6BAAwB,IAAIf,KAAK,CAACgB,gBAAV,CAA2B,CAA3B,EAA8B,CAA9B,EAAiC,IAAjC,EAAuC,EAAvC,CAAxB;IAOD,kCAA2B,IAA3B;IAEC,sBAAe,KAAf;IACA,2BAAoB,KAApB;IACA,8BAAuB,KAAvB;IAEA,iBAAY,IAAIC,GAAJ,CAAsC,EAAtC,CAAZ;IAGA,uBAAkB,CAAlB;IACA,aAAQ,GAAR;IAEA,iBAAY,IAAIA,GAAJ,CAA0B,EAA1B,CAAZ;IAOA,0BAAqB,IAAIjB,KAAK,CAACkB,WAAV,EAArB;IACA,uBAAgB,IAAIlB,KAAK,CAACmB,aAAV,EAAhB;IACA,oBAAa,IAAInB,KAAK,CAACoB,KAAV,CAAgB,KAAKC,eAArB,CAAb;IAEA,wBAAmB,IAAIrB,KAAK,CAACkB,WAAV,EAAnB;IACA,qBAAc,IAAIlB,KAAK,CAACmB,aAAV,EAAd;IACA,kBAAW,IAAInB,KAAK,CAACoB,KAAV,CAAgB,KAAKE,aAArB,CAAX;EAE4J;;EAEpKC,QAAQ;IAAA;;IACN,KAAKC,aAAL;IAEA,KAAKX,iBAAL,CAAuBY,aAAvB,GAAuCC,SAAvC;MAAA,6BAAiD,WAAMC,IAAN,EAAY;QAC3D,KAAI,CAACC,UAAL,GAAgBD,IAAhB;QACAE,OAAO,CAACC,GAAR,CAAY,KAAI,CAACF,UAAjB;;QAEA,KAAI,CAACd,aAAL,CAAmBiB,SAAnB,GAA+BL,SAA/B;UAAA,8BAAyC,WAAMC,IAAN,EAAY;YACnD,KAAI,CAACK,MAAL,GAAYL,IAAZ;YACAE,OAAO,CAACC,GAAR,CAAY,KAAI,CAACE,MAAjB;;YAEA,KAAI,CAACjB,aAAL,CAAmBkB,SAAnB,GAA+BP,SAA/B;cAAA,8BAAyC,WAAMC,IAAN,EAAY;gBACnD,KAAI,CAACO,MAAL,GAAYP,IAAZ;gBACAE,OAAO,CAACC,GAAR,CAAY,KAAI,CAACI,MAAjB;gBACA,MAAM,KAAI,CAACC,WAAL,EAAN;gBACA,MAAM,KAAI,CAACC,kBAAL,EAAN;cACD,CALD;;cAAA;gBAAA;cAAA;YAAA;UAMD,CAVD;;UAAA;YAAA;UAAA;QAAA;MAWD,CAfD;;MAAA;QAAA;MAAA;IAAA;EAgBD;;EAEDC,eAAe,IACd;;EAEiB,IAANC,MAAM;IAChB,OAAO,KAAKC,SAAL,CAAeC,aAAtB;EACD,CA/F0B,CAiG3B;;;EAC6B,OAAdC,cAAc;IAC3B,OAAOC,MAAM,CAACC,UAAP,GAAmBD,MAAM,CAACE,WAAjC;EACD;;EAEOT,WAAW;IAEjB;IACA,KAAKU,KAAL,GAAa,IAAI7C,KAAK,CAAC8C,KAAV,EAAb,CAHiB,CAKjB;;IACA,KAAKC,MAAL,GAAc,IAAI/C,KAAK,CAACgD,iBAAV,CACZ,KAAKC,WADO,EAEZvC,gBAAgB,CAAC+B,cAAjB,EAFY,EAGZ,KAAKS,iBAHO,EAIZ,KAAKC,gBAJO,CAAd,CANiB,CAYjB;IACA;;IAEA,KAAKJ,MAAL,CAAYK,QAAZ,CAAqBC,CAArB,GAAyB,KAAKC,OAA9B;IACA,KAAKT,KAAL,CAAWU,GAAX,CAAe,KAAKR,MAApB,EAhBiB,CAkBjB;;IACA,KAAKA,MAAL,CAAYQ,GAAZ,CAAiB,KAAKlC,eAAtB;IACA,KAAK0B,MAAL,CAAYQ,GAAZ,CAAgB,KAAKjC,aAArB;IAEA,KAAKkC,SAAL;IACA,KAAKC,aAAL;IACA,KAAKC,SAAL;EACD;;EAGOF,SAAS;IACf,IAAIG,SAAS,GAAG,IAAI3D,KAAK,CAAC4D,WAAV,CAAsB,IAAtB,EAA4B,IAA5B,EAAiC,IAAjC,CAAhB;IACA,IAAIC,eAAe,GAAE,CAAC,IAAIzD,iBAAJ,CAAsB;MAAC0D,GAAG,EAAC,KAAKC,aAAV;MAAwBC,IAAI,EAAChE,KAAK,CAACiE;IAAnC,CAAtB,CAAD,EAAsE,IAAI7D,iBAAJ,CAAsB;MAAC0D,GAAG,EAAC,KAAKC,aAAV;MAAwBC,IAAI,EAAChE,KAAK,CAACiE;IAAnC,CAAtB,CAAtE,EAA2I,IAAI7D,iBAAJ,CAAsB;MAAC0D,GAAG,EAAC,KAAKC,aAAV;MAAwBC,IAAI,EAAChE,KAAK,CAACiE;IAAnC,CAAtB,CAA3I,EAAgN,IAAI5D,oBAAJ,CAAyB;MAACyD,GAAG,EAAC,KAAKI,mBAAV;MAA8BF,IAAI,EAAChE,KAAK,CAACiE;IAAzC,CAAzB,CAAhN,EAA8R,IAAI7D,iBAAJ,CAAsB;MAAC0D,GAAG,EAAC,KAAKC,aAAV;MAAwBC,IAAI,EAAChE,KAAK,CAACiE;IAAnC,CAAtB,CAA9R,EAAmW,IAAI7D,iBAAJ,CAAsB;MAAC0D,GAAG,EAAC,KAAKC,aAAV;MAAwBC,IAAI,EAAChE,KAAK,CAACiE;IAAnC,CAAtB,CAAnW,CAArB;IAEA,IAAIE,MAAM,GAAG,IAAInE,KAAK,CAACoE,IAAV,CAAeT,SAAf,EAAyBE,eAAzB,CAAb;IACAM,MAAM,CAACf,QAAP,CAAgBiB,CAAhB,GAAkB,GAAlB;IACAF,MAAM,CAACG,aAAP,GAAqB,IAArB;IACA,KAAKzB,KAAL,CAAWU,GAAX,CAAeY,MAAf;EACD;;EAEO/B,kBAAkB;IACxB;IACA;IACA,KAAKmC,QAAL,GAAgB,IAAIvE,KAAK,CAACwE,aAAV,CAAwB;MAAElC,MAAM,EAAE,KAAKA,MAAf;MAAuBmC,SAAS,EAAE;IAAlC,CAAxB,CAAhB;IACA,KAAKF,QAAL,CAAcG,aAAd,CAA4BhC,MAAM,CAACiC,gBAAnC,EAJwB,CAMxB;;IACA,KAAKJ,QAAL,CAAcK,OAAd,CAAsBlC,MAAM,CAACC,UAA7B,EAAwCD,MAAM,CAACE,WAA/C,EAPwB,CASxB;;IACA,KAAK2B,QAAL,CAAcM,SAAd,CAAwBC,OAAxB,GAAkC,IAAlC;IACA,KAAKP,QAAL,CAAcM,SAAd,CAAwBE,IAAxB,GAA+B/E,KAAK,CAACgF,gBAArC,CAXwB,CAaxB;;IACA,IAAIC,QAAQ,GAAG,IAAIzE,aAAJ,CAAkB,KAAKuC,MAAvB,EAA+B,KAAKwB,QAAL,CAAcW,UAA7C,CAAf;IAEAD,QAAQ,CAACE,WAAT,GAAuB,IAAvB,CAhBwB,CAgBI;;IAC5BF,QAAQ,CAACG,WAAT,GAAuB,EAAvB,CAjBwB,CAiBE;;IAC1BH,QAAQ,CAACI,eAAT,GAA2B,CAACC,IAAI,CAACC,EAAjC,CAlBwB,CAkBa;;IACrCN,QAAQ,CAACO,eAAT,GAA2BF,IAAI,CAACC,EAAhC,CAnBwB,CAmBY;;IACpCN,QAAQ,CAACQ,aAAT,GAAyBH,IAAI,CAACC,EAAL,GAAQ,CAAjC,CApBwB,CAoBW;IACnC;;IAEA,IAAIG,SAAS,GAAqB,IAAlC;;IACC,UAASC,MAAT,GAAe;MACdC,qBAAqB,CAACD,MAAD,CAArB,CADc,CAId;;MACAD,SAAS,CAACG,cAAV;MAEAH,SAAS,CAACI,iBAAV,GAPc,CAUd;;MACAJ,SAAS,CAACnB,QAAV,CAAmBwB,WAAnB,CAA+B,CAAC,GAAhC,EAAqC,CAArC,EAAwCrD,MAAM,CAACC,UAAP,GAAkB,GAA1D,EAA+DD,MAAM,CAACE,WAAtE;MACA8C,SAAS,CAACnB,QAAV,CAAmByB,aAAnB,CAAiC,QAAjC,EAA2C,CAA3C;MACAN,SAAS,CAACnB,QAAV,CAAmBoB,MAAnB,CAA0BD,SAAS,CAAC7C,KAApC,EAA2C6C,SAAS,CAAC3C,MAArD;IAED,CAfA,GAAD;EAgBD;;EAEOU,aAAa;IACnB,KAAK,IAAIwC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKrE,UAAL,CAAgBsE,MAApC,EAA4CD,CAAC,EAA7C,EACA;MACE,IAAIE,qBAAqB,GAAG,CAAE,IAAInG,KAAK,CAACoG,mBAAV,CAA8B;QAACC,KAAK,EAAE;MAAR,CAA9B,CAAF,EAAmD,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;QAACtC,GAAG,EAAC,KAAKwC;MAAV,CAA/B,CAAnD,EAAiH,IAAKtG,KAAK,CAACoG,mBAAX,CAA+B;QAACC,KAAK,EAAE;MAAR,CAA/B,CAAjH,EAAoK,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;QAACC,KAAK,EAAE;MAAR,CAA/B,CAApK,EAAuN,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;QAACC,KAAK,EAAE;MAAR,CAA/B,CAAvN,EAA0Q,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;QAACC,KAAK,EAAE;MAAR,CAA/B,CAA1Q,CAA5B;MAEA,MAAME,IAAI,GAAG,IAAIvG,KAAK,CAACoE,IAAV,CAAe,KAAKoC,qBAApB,EAA2CL,qBAA3C,CAAb,CAHF,CAGiF;;MAE/EI,IAAI,CAACnD,QAAL,CAAcqD,GAAd,CACE/F,gBAAgB,CAACgG,cAAjB,CAAgC,KAAK9E,UAAL,CAAgBqE,CAAhB,EAAmBU,QAAnD,EAA6D,KAAK/E,UAAL,CAAgBqE,CAAhB,EAAmBW,SAAhF,EAA2F,KAAKhF,UAAL,CAAgBqE,CAAhB,EAAmBY,iBAA9G,EAAiI,CAAjI,CADF,EAEEnG,gBAAgB,CAACgG,cAAjB,CAAgC,KAAK9E,UAAL,CAAgBqE,CAAhB,EAAmBU,QAAnD,EAA6D,KAAK/E,UAAL,CAAgBqE,CAAhB,EAAmBW,SAAhF,EAA2F,KAAKhF,UAAL,CAAgBqE,CAAhB,EAAmBY,iBAA9G,EAAiI,CAAjI,CAFF,EAGEnG,gBAAgB,CAACgG,cAAjB,CAAgC,KAAK9E,UAAL,CAAgBqE,CAAhB,EAAmBU,QAAnD,EAA6D,KAAK/E,UAAL,CAAgBqE,CAAhB,EAAmBW,SAAhF,EAA2F,KAAKhF,UAAL,CAAgBqE,CAAhB,EAAmBY,iBAA9G,EAAiI,CAAjI,CAHF;MAKAN,IAAI,CAACO,IAAL,GAAU,KAAKlF,UAAL,CAAgBqE,CAAhB,EAAmBc,mBAA7B;MACAR,IAAI,CAACS,UAAL,GAAgB,IAAhB;MACAT,IAAI,CAACjC,aAAL,GAAmB,IAAnB,CAZF,CAcE;;MACA,IAAI2C,MAAM,GAAC,IAAIhH,UAAJ,CAAe;QAAEiH,IAAI,EAAE,KAAKtF,UAAL,CAAgBqE,CAAhB,EAAmBkB,WAA3B;QAAuCC,SAAS,EAAE,MAAlD;QACxBf,KAAK,EAAE,SADiB;QAExBgB,UAAU,EAAE,uBAFY;QAGxBC,SAAS,EAAE;MAHa,CAAf,CAAX;MAIAL,MAAM,CAAC7D,QAAP,CAAgBqD,GAAhB,CAAoBF,IAAI,CAACnD,QAAL,CAAcmE,CAAlC,EAAoChB,IAAI,CAACnD,QAAL,CAAciB,CAAd,GAAgB,GAApD,EAAwDkC,IAAI,CAACnD,QAAL,CAAcC,CAAtE;MACA,KAAKR,KAAL,CAAWU,GAAX,CAAe0D,MAAf;MAEA,IAAIO,WAAW,GAAC,KAAKA,WAAL,CAAiBC,KAAjB,EAAhB;MACAD,WAAW,CAACV,IAAZ,GAAmB,KAAKlF,UAAL,CAAgBqE,CAAhB,EAAmBkB,WAAtC;MACAK,WAAW,CAACpE,QAAZ,CAAqBqD,GAArB,CAAyBF,IAAI,CAACnD,QAAL,CAAcmE,CAAvC,EAA0ChB,IAAI,CAACnD,QAAL,CAAciB,CAAxD,EAA2DkC,IAAI,CAACnD,QAAL,CAAcC,CAAzE;MACA,KAAKR,KAAL,CAAWU,GAAX,CAAeiE,WAAf;MAEA,KAAK3E,KAAL,CAAWU,GAAX,CAAegD,IAAf;IACD;;IACD,KAAKmB,QAAL;EACD;;EAEOA,QAAQ;IAEd,KAAK,IAAIzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjE,MAAL,CAAYkE,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;MAC3C,IAAI0B,KAAK,GAAa,KAAK9E,KAAL,CAAW+E,eAAX,CAA4B,KAAK5F,MAAL,CAAYiE,CAAZ,EAAe4B,WAA3C,CAAtB;MACA,IAAIC,KAAK,GAAa,KAAKjF,KAAL,CAAW+E,eAAX,CAA4B,KAAK5F,MAAL,CAAYiE,CAAZ,EAAe8B,SAA3C,CAAtB;;MAEA,IAAGJ,KAAK,IAAE,IAAP,IAAaG,KAAK,IAAE,IAAvB,EAA4B;QAC1B,IAAIE,KAAK,GAAC1C,IAAI,CAAC2C,KAAL,CAAW,EAAEH,KAAK,CAAC1E,QAAN,CAAeC,CAAf,GAAiBsE,KAAK,CAACvE,QAAN,CAAeC,CAAlC,CAAX,EAAgDyE,KAAK,CAAC1E,QAAN,CAAemE,CAAf,GAAiBI,KAAK,CAACvE,QAAN,CAAemE,CAAhF,CAAV;QACA,IAAIW,KAAK,GAAC5C,IAAI,CAACC,EAAL,GAAQyC,KAAlB;QAEA,IAAIG,eAAe,GAAG,CAAE,IAAInI,KAAK,CAACoG,mBAAV,CAA8B;UAACC,KAAK,EAAE;QAAR,CAA9B,CAAF,EAAmD,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAAnD,EAAsG,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACtC,GAAG,EAAC,KAAKsE;QAAV,CAA/B,CAAtG,EAAiK,IAAKpI,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAAjK,EAAoN,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAApN,EAAuQ,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAAvQ,CAAtB;QACA,IAAIgC,eAAe,GAAE,IAAIrI,KAAK,CAAC4D,WAAV,CAAsB,GAAtB,EAA2B,IAA3B,EAAiC,CAAjC,CAArB;QAEA,IAAI0E,YAAY,GAAC,IAAItI,KAAK,CAACoE,IAAV,CAAeiE,eAAf,EAA+BF,eAA/B,CAAjB;QACAG,YAAY,CAAClF,QAAb,CAAsBqD,GAAtB,CAA0BkB,KAAK,CAACvE,QAAN,CAAemE,CAAf,GAAkB,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgDlD,IAAI,CAACmD,GAAL,CAAST,KAAT,CAA5F,EAA4GL,KAAK,CAACvE,QAAN,CAAeiB,CAA3H,EAA6HsD,KAAK,CAACvE,QAAN,CAAeC,CAAf,GAAiB,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgDlD,IAAI,CAACoD,GAAL,CAASV,KAAT,CAA9L;QACAM,YAAY,CAACK,OAAb,CAAqBX,KAArB;QACAM,YAAY,CAACtB,UAAb,GAAwB,IAAxB;QACAsB,YAAY,CAAChE,aAAb,GAA2B,IAA3B;QACA,KAAKzB,KAAL,CAAWU,GAAX,CAAe+E,YAAf;QAEA,IAAIM,YAAY,GAAC,IAAI5I,KAAK,CAACoE,IAAV,CAAeiE,eAAf,EAA+BF,eAA/B,CAAjB;QACAS,YAAY,CAACxF,QAAb,CAAsBqD,GAAtB,CAA0BqB,KAAK,CAAC1E,QAAN,CAAemE,CAAf,GAAkB,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgDlD,IAAI,CAACmD,GAAL,CAASP,KAAT,CAA5F,EAA4GJ,KAAK,CAAC1E,QAAN,CAAeiB,CAA3H,EAA6HyD,KAAK,CAAC1E,QAAN,CAAeC,CAAf,GAAiB,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgDlD,IAAI,CAACoD,GAAL,CAASR,KAAT,CAA9L;QACAU,YAAY,CAACD,OAAb,CAAqBT,KAArB;QACAU,YAAY,CAAC5B,UAAb,GAAwB,IAAxB;QACA4B,YAAY,CAACtE,aAAb,GAA2B,IAA3B;QACA,KAAKzB,KAAL,CAAWU,GAAX,CAAeqF,YAAf;QAEA,IAAIC,YAAY,GAAE,CAAE,IAAI7I,KAAK,CAACoG,mBAAV,CAA8B;UAACC,KAAK,EAAE;QAAR,CAA9B,CAAF,EAAmD,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAAnD,EAAsG,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACtC,GAAG,EAAC,KAAKgF;QAAV,CAA/B,CAAtG,EAA8J,IAAK9I,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAA9J,EAAiN,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAAjN,EAAoQ,IAAKrG,KAAK,CAACoG,mBAAX,CAA+B;UAACC,KAAK,EAAE;QAAR,CAA/B,CAApQ,CAAlB;QACA,IAAI0C,YAAY,GAAE,IAAI/I,KAAK,CAAC4D,WAAV,CAAsB,CAAtB,EAAyB,IAAzB,EAAgC0B,IAAI,CAAC0D,IAAL,CAAU1D,IAAI,CAAC2D,GAAL,CAASX,YAAY,CAAClF,QAAb,CAAsBmE,CAAtB,GAAwBqB,YAAY,CAACxF,QAAb,CAAsBmE,CAAvD,EAAyD,CAAzD,IAA4DjC,IAAI,CAAC2D,GAAL,CAASX,YAAY,CAAClF,QAAb,CAAsBiB,CAAtB,GAAwBuE,YAAY,CAACxF,QAAb,CAAsBiB,CAAvD,EAAyD,CAAzD,CAA5D,GAAwHiB,IAAI,CAAC2D,GAAL,CAASX,YAAY,CAAClF,QAAb,CAAsBC,CAAtB,GAAwBuF,YAAY,CAACxF,QAAb,CAAsBC,CAAvD,EAAyD,CAAzD,CAAlI,CAAhC,CAAlB;QACA,IAAI6F,QAAQ,GAAC,IAAIlJ,KAAK,CAACoE,IAAV,CAAe2E,YAAf,EAA4BF,YAA5B,CAAb;QAEAK,QAAQ,CAAC9F,QAAT,CAAkBqD,GAAlB,CAAsB,CAAC6B,YAAY,CAAClF,QAAb,CAAsBmE,CAAtB,GAAwBqB,YAAY,CAACxF,QAAb,CAAsBmE,CAA/C,IAAkD,CAAxE,EAA0E,CAACe,YAAY,CAAClF,QAAb,CAAsBiB,CAAtB,GAAwBuE,YAAY,CAACxF,QAAb,CAAsBiB,CAA/C,IAAkD,CAA5H,EAA8H,CAACiE,YAAY,CAAClF,QAAb,CAAsBC,CAAtB,GAAwBuF,YAAY,CAACxF,QAAb,CAAsBC,CAA/C,IAAkD,CAAhL;QACA6F,QAAQ,CAAClC,UAAT,GAAoB,IAApB;QACAkC,QAAQ,CAAC5E,aAAT,GAAuB,IAAvB;QACA,KAAKzB,KAAL,CAAWU,GAAX,CAAe2F,QAAf;QAEA,IAAIC,IAAI,GAAE7D,IAAI,CAAC8D,IAAL,CAAU,CAACd,YAAY,CAAClF,QAAb,CAAsBiB,CAAtB,GAAwBuE,YAAY,CAACxF,QAAb,CAAsBiB,CAA/C,IAAkD0E,YAAY,CAACR,UAAb,CAAwBc,KAApF,CAAV;QACA,IAAIC,KAAK,GAACtB,KAAK,GAAC1C,IAAI,CAACC,EAAL,GAAQ,CAAxB;QACA2D,QAAQ,CAACK,QAAT,CAAkB9C,GAAlB,CAAsB0C,IAAtB,EAA2BG,KAA3B,EAAiC,CAAjC,EAAoC,KAApC;QAEA,KAAKE,SAAL,CAAe/C,GAAf,CAAmB,KAAKzE,MAAL,CAAYiE,CAAZ,EAAewD,OAAlC,EAA0C,CAACzB,KAAD,EAAOE,KAAP,EAAaI,YAAY,CAAClF,QAAb,CAAsBmE,CAAnC,EAAqCe,YAAY,CAAClF,QAAb,CAAsBiB,CAA3D,EAA6DiE,YAAY,CAAClF,QAAb,CAAsBC,CAAnF,EAAqFuF,YAAY,CAACxF,QAAb,CAAsBmE,CAA3G,EAA6GqB,YAAY,CAACxF,QAAb,CAAsBiB,CAAnI,EAAqIuE,YAAY,CAACxF,QAAb,CAAsBC,CAA3J,EAA6J6F,QAAQ,CAAC9F,QAAT,CAAkBmE,CAA/K,EAAiL2B,QAAQ,CAAC9F,QAAT,CAAkBiB,CAAnM,EAAqM6E,QAAQ,CAAC9F,QAAT,CAAkBC,CAAvN,EAAyN8F,IAAzN,EAA+NnB,KAAK,GAAC1C,IAAI,CAACC,EAAL,GAAQ,CAA7O,CAA1C;MACD;IACF;EACF;;EAIO7B,SAAS;IACf;IAEA,MAAMgG,SAAS,GAAG,IAAI1J,KAAK,CAAC2J,YAAV,CAAuB,QAAvB,EAAiC,GAAjC,CAAlB;IACA,KAAK9G,KAAL,CAAWU,GAAX,CAAemG,SAAf;IAEA,MAAME,WAAW,GAAG,IAAI5J,KAAK,CAAC6J,gBAAV,CAA2B,QAA3B,EAAqC,GAArC,CAApB;IACAD,WAAW,CAAC5C,UAAZ,GAAuB,IAAvB;IACA,KAAKjE,MAAL,CAAYQ,GAAZ,CAAgBqG,WAAhB;IAEA,MAAME,SAAS,GAAG,IAAI9J,KAAK,CAAC+J,SAAV,CAAoB,QAApB,EAA8B,GAA9B,CAAlB;IACAD,SAAS,CAAC1G,QAAV,CAAmBqD,GAAnB,CAAuB,CAAvB,EAA0B,GAA1B,EAA+B,EAA/B;IACAqD,SAAS,CAAC9C,UAAV,GAAqB,IAArB;IACA8C,SAAS,CAACE,MAAV,CAAiB5G,QAAjB,CAA0BqD,GAA1B,CAA8B,CAA9B,EAAgC,CAAhC,EAAkC,EAAlC;IACAqD,SAAS,CAACG,MAAV,CAAiBC,OAAjB,CAAyBC,KAAzB,GAAiC,IAAjC;IACAL,SAAS,CAACG,MAAV,CAAiBC,OAAjB,CAAyBE,MAAzB,GAAkC,IAAlC;IACAN,SAAS,CAACG,MAAV,CAAiBlH,MAAjB,CAAwBsH,GAAxB,GAA6B,IAA7B;IACA,KAAKxH,KAAL,CAAWU,GAAX,CAAeuG,SAAf;IACA,KAAKjH,KAAL,CAAWU,GAAX,CAAeuG,SAAS,CAACE,MAAzB;EACD;;EAGOM,QAAQ,CAACC,SAAD,EAAkBC,oBAAlB,EAA8C;IAE5D,MAAMC,OAAO,GAAG,KAAKA,OAAL,CAAahD,KAAb,EAAhB;IACAgD,OAAO,CAAC3D,IAAR,GAAeyD,SAAf;IACAE,OAAO,CAACrH,QAAR,CAAiBqD,GAAjB,CAAqB+D,oBAAoB,CAACjD,CAA1C,EAA4CiD,oBAAoB,CAACnG,CAAjE,EAAmEmG,oBAAoB,CAACnH,CAAxF;IACA,KAAKR,KAAL,CAAWU,GAAX,CAAekH,OAAf;;IAEA,IAAG,KAAKC,mBAAR,EAA4B;MAC1B,KAAKC,YAAL,CAAkBC,IAAlB,CAAwC,KAAK/H,KAAL,CAAW+E,eAAX,CAA2B6C,OAAO,CAAC3D,IAAnC,CAAxC;IACD;EACF;;EAEM+D,gCAAgC,CAACC,EAAD,EAAgBhH,GAAhB,EAAwC;IAC7EA,GAAG,CAACiH,OAAJ,CAAY,CAACC,KAAD,EAAQC,GAAR,KAAe;MACzB,KAAKC,cAAL,GAAoBD,GAApB;MAEA,IAAIE,IAAI,GAAG,IAAInL,KAAK,CAACoL,SAAV,EAAX;MAEA,IAAIC,aAAa,GAAC,EAAlB;;MAEA,KAAI,IAAIpF,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC+E,KAAK,CAAC9E,MAAN,GAAa,CAA3B,EAA6BD,CAAC,EAA9B,EAAiC;QAC/B,IAAIqF,IAAI,GAAC,KAAKC,oBAAL,CAA0BP,KAAK,CAAC/E,CAAD,CAA/B,EAAmC+E,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAxC,CAAT;QAEA,IAAIuF,aAAa,GAAG,KAAK3I,KAAL,CAAW+E,eAAX,CAA2BoD,KAAK,CAAC/E,CAAD,CAAhC,CAApB;QACA,IAAIwF,gBAAgB,GAAE,KAAK5I,KAAL,CAAW+E,eAAX,CAA2BoD,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAhC,CAAtB;QAEA,IAAIyF,QAAQ,GAAC,KAAKlC,SAAL,CAAemC,GAAf,CAA2BL,IAAI,EAAE7B,OAAjC,CAAb;;QAEA,IAAGiC,QAAQ,IAAEE,SAAV,IAAuBH,gBAAgB,IAAEG,SAAzC,IAAqDJ,aAAa,IAAEI,SAAvE,EAAiF;UAC/E,IAAG,CAAC,KAAKC,6BAAL,CAAmCL,aAAa,EAAE1E,IAAlD,EAAwD2E,gBAAgB,EAAE3E,IAA1E,CAAJ,EAAoF;YAElF,IAAIgF,eAAe,GAAC,OAAKxG,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAkCzG,IAAI,CAACC,EAAL,GAAQ,CAAnD,CAAzB;YACA,IAAIyG,eAAe,GAAC,OAAK1G,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAkCzG,IAAI,CAACC,EAAL,GAAQ,CAAnD,CAAzB;;YAGA,IAAGU,CAAC,IAAE,CAAN,EAAS;cACPkF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYiL,aAAa,EAAEpI,QAAf,CAAwBmE,CAApC,EAAuCiE,aAAa,EAAEpI,QAAf,CAAwBiB,CAA/D,EAAkEmH,aAAa,EAAEpI,QAAf,CAAwBC,CAA1F,CAAf,EAA6G,IAAI9C,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCH,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAxE,EAAkGR,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCH,eAArI,CAA7G,CAAT,EADO,CACuQ;YAC/Q,CARiF,CAUlF;;;YACAb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCH,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAxE,EAAkGR,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCH,eAArI,CAAf,EAAsK,IAAIzL,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCP,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAR,GAAmCR,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCT,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAtK,CAAT;YACAb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCP,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAR,GAAmCR,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCT,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAf,EAAwS,IAAIzL,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAAR,GAAoCN,eAAhD,EAAiEJ,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAAzE,EAAoGX,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAAR,GAAoCN,eAAxI,CAAxS,CAAT;YACAb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAAR,GAAoCN,eAAhD,EAAiEJ,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAAzE,EAAoGX,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAAR,GAAoCN,eAAxI,CAAf,EAAyK,IAAIzL,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCb,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAR,GAAmCd,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCf,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAzK,CAAT;YACAb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCb,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAR,GAAmCd,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCf,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAf,EAAwS,IAAIzL,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCT,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAxE,EAAkGd,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCT,eAArI,CAAxS,CAAT;YAGA,IAAIU,YAAY,GAAC,KAAKlD,SAAL,CAAemC,GAAf,CAA2B,KAAKJ,oBAAL,CAA0BP,KAAK,CAAC/E,CAAC,GAAG,CAAL,CAA/B,EAAwC+E,KAAK,CAAC/E,CAAC,GAAG,CAAL,CAA7C,GAAuDwD,OAAlF,CAAjB;;YAEA,IAAIxD,CAAC,GAAE+E,KAAK,CAAC9E,MAAN,GAAa,CAAhB,IAAqBwG,YAAY,IAAE,IAAvC,EAA6C;cAAC;cAE5C,IAAIC,cAAc,GAAC,IAAI3M,KAAK,CAACO,OAAV,GAAoBqM,UAApB,CAA+BnB,gBAAgB,CAACrI,QAAhD,EAAyD,IAAI7C,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAApB,EAA6Cb,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAArD,EAA8Ed,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAtF,CAAzD,EAA0KI,SAA1K,EAAnB;cACA,IAAIC,cAAc,GAAC,IAAI9M,KAAK,CAACO,OAAV,GAAoBqM,UAApB,CAA+B,IAAIrM,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAAC6L,KAAlB,CAAxB,EAAiDG,YAAY,CAAChM,gBAAgB,CAAC8L,KAAlB,CAA7D,EAAsFE,YAAY,CAAChM,gBAAgB,CAAC+L,KAAlB,CAAlG,CAA/B,EAA2JhB,gBAAgB,CAACrI,QAA5K,EAAsLyJ,SAAtL,EAAnB;cAEA,IAAIE,KAAK,GAACJ,cAAc,CAACK,OAAf,CAAuBF,cAAvB,CAAV;cAEA,IAAIG,CAAC,GAAC,CAAC3H,IAAI,CAACC,EAAL,GAAQwH,KAAT,IAAgB1B,aAAtB;;cAEA,KAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG7B,aAAa,GAAC,CAAlC,EAAqC6B,CAAC,EAAtC,EAA0C;gBACxC,IAAGA,CAAC,IAAE,CAAN,EAAS;kBACP/B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCT,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAxE,EAAkGd,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCT,eAArI,CAAf,EAAqK,IAAIzL,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmCD,CAAC,GAACD,CAA9C,CAAlG,EAAqJxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA/K,EAAkLoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmCD,CAAC,GAACD,CAA9C,CAAxQ,CAArK,CAAT;gBACD;;gBAED,IAAGC,CAAC,GAAC,CAAF,IAAKA,CAAC,GAAC7B,aAAa,GAAC,CAAxB,EAA0B;kBACxBF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA6B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAiD,GAAlD,IAAwDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmC,CAACD,CAAC,GAAC,CAAH,IAAMD,CAAlD,CAAjG,EAAwJxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAlL,EAAqLoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmC,CAACD,CAAC,GAAC,CAAH,IAAMD,CAAlD,CAA3Q,CAAf,EAAiV,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmCD,CAAC,GAACD,CAA9C,CAAlG,EAAqJxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA/K,EAAkLoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAmCD,CAAC,GAACD,CAA9C,CAAxQ,CAAjV,CAAT;gBACD;;gBAED,IAAGC,CAAC,IAAE7B,aAAa,GAAC,CAApB,EAAsB;kBACpB,IAAG,KAAKQ,6BAAL,CAAmCb,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAxC,EAA8C+E,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAnD,CAAH,EAA8D;oBAC5DkF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAAnR,CAAnW,CAAT;oBACA9B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAAnR,CAAf,EAA6V,IAAI1M,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAAC6L,KAAlB,CAAxB,EAAkDG,YAAY,CAAChM,gBAAgB,CAAC8L,KAAlB,CAA9D,EAAwFE,YAAY,CAAChM,gBAAgB,CAAC+L,KAAlB,CAApG,CAA7V,CAAT;kBACD,CAHD,MAGK;oBACHtB,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAsCD,CAAD,GAAOD,CAArD,CAAnR,CAAnW,CAAT;oBACA9B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAqC,CAACD,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAACuL,KAAlB,CAAxB,EAAkDS,YAAY,CAAChM,gBAAgB,CAACwL,KAAlB,CAA9D,EAAwFQ,YAAY,CAAChM,gBAAgB,CAACyL,KAAlB,CAApG,CAAnW,CAAT;kBAED;gBACF;cACF;YACF;;YACD,IAAGlG,CAAC,IAAE+E,KAAK,CAAC9E,MAAN,GAAa,CAAnB,EAAsB;cACpBiF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCT,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAxE,EAAkGd,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCT,eAArI,CAAf,EAAsK,IAAIzL,OAAJ,CAAYkL,gBAAgB,EAAErI,QAAlB,CAA2BmE,CAAvC,EAA0CkE,gBAAgB,EAAErI,QAAlB,CAA2BiB,CAArE,EAAwEoH,gBAAgB,EAAErI,QAAlB,CAA2BC,CAAnG,CAAtK,CAAT;YACD;UAEF,CArDD,MAqDK;YAEH,IAAIyI,eAAe,GAAC,OAAKxG,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAkC7H,IAAI,CAACC,EAAL,GAAQ,CAAnD,CAAzB;YACA,IAAIyG,eAAe,GAAC,OAAK1G,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACyM,MAAlB,CAAR,GAAkC7H,IAAI,CAACC,EAAL,GAAQ,CAAnD,CAAzB;;YAEA,IAAGU,CAAC,IAAE,CAAN,EAAS;cACPkF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYiL,aAAa,EAAEpI,QAAf,CAAwBmE,CAApC,EAAuCiE,aAAa,EAAEpI,QAAf,CAAwBiB,CAA/D,EAAkEmH,aAAa,EAAEpI,QAAf,CAAwBC,CAA1F,CAAf,EAA6G,IAAI9C,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCT,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAxE,EAAkGd,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCT,eAArI,CAA7G,CAAT;YACD,CAPE,CAQH;;;YACAb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCT,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAxE,EAAkGd,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCT,eAArI,CAAf,EAAsK,IAAIzL,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCb,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAR,GAAmCd,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCf,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAtK,CAAT,EATG,CASsc;;YACzcb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAAC6L,KAAlB,CAAR,GAAmCb,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAAC8L,KAAlB,CAAR,GAAmCd,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAAC+L,KAAlB,CAAR,GAAmCf,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAf,EAAwS,IAAIzL,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAAR,GAAoCN,eAAhD,EAAiEJ,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAAzE,EAAoGX,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAAR,GAAoCN,eAAxI,CAAxS,CAAT,EAVG,CAUyc;;YAC5cb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAAR,GAAoCN,eAAhD,EAAiEJ,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAAzE,EAAoGX,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAAR,GAAoCN,eAAxI,CAAf,EAAyK,IAAIzL,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCP,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAR,GAAmCR,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCT,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAzK,CAAT,EAXG,CAWyc;;YAC5cb,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAa,CAACmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCP,QAAQ,CAAChL,gBAAgB,CAAC0L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAA3F,EAA4G,CAACJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAR,GAAmCR,QAAQ,CAAChL,gBAAgB,CAAC2L,MAAlB,CAA5C,IAAyE,CAArL,EAAyL,CAACX,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCT,QAAQ,CAAChL,gBAAgB,CAAC4L,MAAlB,CAA5C,IAAyE,CAA1E,GAA+EN,eAAvQ,CAAf,EAAwS,IAAIzL,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCH,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAxE,EAAkGR,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCH,eAArI,CAAxS,CAAT,EAZG,CAYsc;;YAEzc,IAAIU,YAAY,GAAC,KAAKlD,SAAL,CAAemC,GAAf,CAA2B,KAAKJ,oBAAL,CAA0BP,KAAK,CAAC/E,CAAC,GAAG,CAAL,CAA/B,EAAwC+E,KAAK,CAAC/E,CAAC,GAAG,CAAL,CAA7C,GAAuDwD,OAAlF,CAAjB;;YAEA,IAAIuB,KAAK,CAAC9E,MAAN,GAAa,CAAb,IAAkBwG,YAAY,IAAE,IAApC,EAAyC;cAAC;cAExC,IAAIC,cAAc,GAAC,IAAI3M,KAAK,CAACO,OAAV,GAAoBqM,UAApB,CAA+BnB,gBAAgB,CAACrI,QAAhD,EAAyD,IAAI7C,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAApB,EAA6CP,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAArD,EAA8ER,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAtF,CAAzD,EAA0KU,SAA1K,EAAnB;cACA,IAAIC,cAAc,GAAC,IAAI9M,KAAK,CAACO,OAAV,GAAoBqM,UAApB,CAA+B,IAAIrM,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAAC6L,KAAlB,CAAxB,EAAiDG,YAAY,CAAChM,gBAAgB,CAAC8L,KAAlB,CAA7D,EAAsFE,YAAY,CAAChM,gBAAgB,CAAC+L,KAAlB,CAAlG,CAA/B,EAA2JhB,gBAAgB,CAACrI,QAA5K,EAAsLyJ,SAAtL,EAAnB;cAEA,IAAIE,KAAK,GAACJ,cAAc,CAACK,OAAf,CAAuBF,cAAvB,CAAV;cACA,IAAIG,CAAC,GAAC,CAAC3H,IAAI,CAACC,EAAL,GAAQwH,KAAT,IAAgB1B,aAAtB;;cAEA,KAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG7B,aAAa,GAAC,CAAlC,EAAqC6B,CAAC,EAAtC,EAA0C;gBACxC,IAAGA,CAAC,IAAE,CAAN,EAAS;kBACP/B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCH,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAxE,EAAkGR,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCH,eAArI,CAAf,EAAqK,IAAIzL,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmCmB,CAAC,GAACD,CAA9C,CAA5F,EAA+IxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAzK,EAA4KoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmCmB,CAAC,GAACD,CAA9C,CAAlQ,CAArK,CAAT;gBACD;;gBAED,IAAGC,CAAC,GAAC,CAAF,IAAKA,CAAC,GAAC7B,aAAa,GAAC,CAAxB,EAA0B;kBACxBF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmC,CAACmB,CAAC,GAAC,CAAH,IAAMD,CAAlD,CAAlG,EAAyJxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAnL,EAAsLoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmC,CAACmB,CAAC,GAAC,CAAH,IAAMD,CAAlD,CAA5Q,CAAf,EAAkV,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmCmB,CAAC,GAACD,CAA9C,CAAlG,EAAqJxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA/K,EAAkLoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAgD,GAAjD,IAAwDlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAmCmB,CAAC,GAACD,CAA9C,CAAxQ,CAAlV,CAAT;gBACD;;gBAED,IAAGC,CAAC,IAAE7B,aAAa,GAAC,CAApB,EAAsB;kBACpB,IAAG,KAAKQ,6BAAL,CAAmCb,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAxC,EAA8C+E,KAAK,CAAC/E,CAAC,GAAC,CAAH,CAAnD,CAAH,EAA8D;oBAC5DkF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAAnR,CAAnW,CAAT;oBACA9B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAAnR,CAAf,EAA6V,IAAI1M,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAAC6L,KAAlB,CAAxB,EAAkDG,YAAY,CAAChM,gBAAgB,CAAC8L,KAAlB,CAA9D,EAAwFE,YAAY,CAAChM,gBAAgB,CAAC+L,KAAlB,CAApG,CAA7V,CAAT;kBACD,CAHD,MAGK;oBACHtB,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAApG,EAA8JxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAAxL,EAA2LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAsCmB,CAAD,GAAOD,CAArD,CAAnR,CAAnW,CAAT;oBACA9B,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYkL,gBAAgB,CAACrI,QAAjB,CAA0BmE,CAA1B,GAA8B,CAAC,KAAKf,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACmD,GAAL,CAASiD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAApG,EAAiKxB,gBAAgB,CAACrI,QAAjB,CAA0BiB,CAA3L,EAA8LoH,gBAAgB,CAACrI,QAAjB,CAA0BC,CAA1B,GAA8B,CAAC,KAAKmD,qBAAL,CAA2B+B,UAA3B,CAAsCC,SAAtC,GAAkD,GAAnD,IAA0DlD,IAAI,CAACoD,GAAL,CAASgD,QAAQ,CAAChL,gBAAgB,CAACqL,MAAlB,CAAR,GAAqC,CAACmB,CAAC,GAAG,CAAL,IAAUD,CAAxD,CAAtR,CAAf,EAAmW,IAAI1M,OAAJ,CAAYmM,YAAY,CAAChM,gBAAgB,CAACuL,KAAlB,CAAxB,EAAkDS,YAAY,CAAChM,gBAAgB,CAACwL,KAAlB,CAA9D,EAAwFQ,YAAY,CAAChM,gBAAgB,CAACyL,KAAlB,CAApG,CAAnW,CAAT;kBAED;gBACF;cACF;YACF;;YACD,IAAGlG,CAAC,IAAE+E,KAAK,CAAC9E,MAAN,GAAa,CAAnB,EAAsB;cACpBiF,IAAI,CAAC5H,GAAL,CAAS,IAAIpD,UAAJ,CAAe,IAAII,OAAJ,CAAYmL,QAAQ,CAAChL,gBAAgB,CAACuL,KAAlB,CAAR,GAAmCH,eAA/C,EAAgEJ,QAAQ,CAAChL,gBAAgB,CAACwL,KAAlB,CAAxE,EAAkGR,QAAQ,CAAChL,gBAAgB,CAACyL,KAAlB,CAAR,GAAmCH,eAArI,CAAf,EAAsK,IAAIzL,OAAJ,CAAYkL,gBAAgB,EAAErI,QAAlB,CAA2BmE,CAAvC,EAA0CkE,gBAAgB,EAAErI,QAAlB,CAA2BiB,CAArE,EAAwEoH,gBAAgB,EAAErI,QAAlB,CAA2BC,CAAnG,CAAtK,CAAT;YACD;UACF;QACF;MACF;;MAGD8H,IAAI,CAACiC,SAAL,GAAe,IAAf;MACA,KAAKC,UAAL,GAAgBlC,IAAI,CAACmC,SAAL,EAAhB;MACA,KAAKC,SAAL,CAAe9G,GAAf,CAAmBwE,GAAnB,EAAuBE,IAAvB,EA5HyB,CA6HzB;;MACA,KAAKqC,6BAAL,GAAmC,IAAIjN,OAAJ,CAAY,KAAKsC,KAAL,CAAW+E,eAAX,CAA2BoD,KAAK,CAAC,CAAD,CAAhC,GAAsC5H,QAAtC,CAA+CmE,CAA3D,EAA6D,KAAK1E,KAAL,CAAW+E,eAAX,CAA2BoD,KAAK,CAAC,CAAD,CAAhC,GAAsC5H,QAAtC,CAA+CiB,CAA5G,EAA8G,KAAKxB,KAAL,CAAW+E,eAAX,CAA2BoD,KAAK,CAAC,CAAD,CAAhC,GAAsC5H,QAAtC,CAA+CC,CAA/C,GAAiD,CAA/J,CAAnC;MAGA,KAAKoK,UAAL,CAAgB3C,EAAhB,EAAmB,IAAnB;IACD,CAlID;EAqID;;EAEM4C,sBAAsB;IAC3B;IACA,KAAKC,UAAL,CAAgBC,IAAhB;IAEA,IAAIC,EAAE,GAACC,QAAQ,CAACC,cAAT,CAAwB,8BAAxB,CAAP;IACA,IAAI1K,CAAC,GAACyK,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,CAAN;;IAEA,IAAIF,EAAE,IAAE,IAAJ,IAAYxK,CAAC,IAAE,IAAnB,EAAyB;MACvB,IAAIwK,EAAE,CAACG,KAAH,CAASC,OAAT,KAAqB,OAArB,IAA+B5K,CAAC,CAAC2K,KAAF,CAAQC,OAAR,KAAoB,MAAvD,EAA+D;QAC7D5K,CAAC,CAAC2K,KAAF,CAAQC,OAAR,GAAkB,OAAlB;QACAJ,EAAE,CAACG,KAAH,CAASC,OAAT,GAAmB,MAAnB,CAF6D,CAI7D;;QACA,KAAKC,cAAL,GAAoB,IAApB;MACD;IACF;EACF;;EAEOpI,iBAAiB;IACvB;IAEA,IAAI,KAAKoI,cAAL,IAAwB,KAAKvD,YAAL,CAAkBzE,MAAlB,IAA0B,CAAtD,EAAyD;MACvD,KAAI,IAAID,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAK0E,YAAL,CAAkBzE,MAAhC,EAAuCD,CAAC,EAAxC,EAA2C;QAEzC;QACA,IAAIkI,MAAM,GAAE,KAAKZ,SAAL,CAAe5B,GAAf,CAAmB,KAAKhB,YAAL,CAAkB1E,CAAlB,EAAqBa,IAAxC,EAA8CsH,QAA9C,CAAuD,KAAKC,eAAL,GAAuB,KAAKhB,UAAnF,CAAZ;;QAEA,IAAIc,MAAM,IAAEvC,SAAZ,EAAuB;UAErB,KAAKjB,YAAL,CAAkB1E,CAAlB,GAAsBqI,MAAtB,CAA6BH,MAA7B;UACA,KAAKxD,YAAL,CAAkB1E,CAAlB,GAAsB7C,QAAtB,EAAgCqD,GAAhC,CAAoC0H,MAAM,CAAC5G,CAA3C,EAA8C4G,MAAM,CAAC9J,CAArD,EAAwD8J,MAAM,CAAC9K,CAA/D;UACA,KAAKgL,eAAL,IAAwB,KAAKE,KAA7B;;UAGA,IAAI,KAAKF,eAAL,IAAwB,KAAKhB,UAAjC,EAA6C;YAC3C,KAAKa,cAAL,GAAsB,KAAtB;YACA,KAAKrL,KAAL,CAAW2L,MAAX,CAAkB,KAAK7D,YAAL,CAAkB1E,CAAlB,CAAlB;YACA,KAAKsH,SAAL,CAAekB,MAAf,CAAsB,KAAK9D,YAAL,CAAkB1E,CAAlB,EAAqBa,IAA3C;YACA,KAAK6D,YAAL,GAAoB,KAAKA,YAAL,CAAkB+D,MAAlB,CAAyBC,GAAG,IAAIA,GAAG,IAAI,KAAKhE,YAAL,CAAkB1E,CAAlB,CAAvC,CAApB;YACA,KAAK0H,UAAL,CAAgBiB,IAAhB;YACA,KAAKP,eAAL,GAAqB,CAArB;YACA,KAAKb,6BAAL,GAAmC,IAAIjN,OAAJ,EAAnC;UACD;QACF;MACF;IAEF;EACF;;EACMsO,mBAAmB;IACxB;IACA,KAAKlB,UAAL,CAAgBC,IAAhB;IAEA,IAAIkB,yBAAyB,GAAChB,QAAQ,CAACC,cAAT,CAAwB,2BAAxB,CAA9B;IACA,IAAIgB,wBAAwB,GAACjB,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,CAA7B;;IAEA,IAAIe,yBAAyB,IAAE,IAA3B,IAAmCF,IAAI,IAAE,IAA7C,EAAmD;MAEjDE,yBAAyB,CAACd,KAA1B,CAAgCC,OAAhC,GAA0C,MAA1C;MACAc,wBAAwB,CAACf,KAAzB,CAA+BC,OAA/B,GAAyC,OAAzC,CAHiD,CAKjD;;MACA,KAAKe,sBAAL,GAA8B,IAA9B;IACD;EACF;;EAGMC,kBAAkB;IACvB;IACA,KAAKtB,UAAL,CAAgBiB,IAAhB;IAEA,IAAIG,wBAAwB,GAACjB,QAAQ,CAACC,cAAT,CAAwB,0BAAxB,CAA7B;IACA,IAAImB,kBAAkB,GAACpB,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,CAAvB;;IAEA,IAAIgB,wBAAwB,IAAE,IAA1B,IAAkCG,kBAAkB,IAAE,IAA1D,EAAgE;MAC9DA,kBAAkB,CAAClB,KAAnB,CAAyBC,OAAzB,GAAmC,OAAnC;MACAc,wBAAwB,CAACf,KAAzB,CAA+BC,OAA/B,GAAyC,MAAzC,CAF8D,CAI9D;;MACA,KAAKe,sBAAL,GAA4B,KAA5B;IACD;EACF;;EAEOnJ,cAAc;IACpB,IAAG,KAAKmJ,sBAAR,EAA+B;MAC7B,IAAIG,KAAK,GAAG,KAAKtM,KAAL,CAAW+E,eAAX,CAA2B,KAAKwH,WAAhC,CAAZ;;MACAtB,QAAQ,CAACuB,SAAT,GAAqB,UAAUC,CAAV,EAAW;QAC9B,QAAQA,CAAC,CAACrE,GAAV;UACE,KAAK,GAAL;YACE;YACAkE,KAAK,EAAE/L,QAAP,CAAgBqD,GAAhB,CAAoB0I,KAAK,EAAE/L,QAAP,CAAgBmE,CAAhB,GAAmB,GAAvC,EAA2C4H,KAAK,EAAE/L,QAAP,CAAgBiB,CAA3D,EAA6D8K,KAAK,EAAE/L,QAAP,CAAgBC,CAA7E;YACA;;UAEF,KAAK,GAAL;YACE;YACA8L,KAAK,EAAE/L,QAAP,CAAgBqD,GAAhB,CAAoB0I,KAAK,EAAE/L,QAAP,CAAgBmE,CAAhB,GAAmB,GAAvC,EAA2C4H,KAAK,EAAE/L,QAAP,CAAgBiB,CAA3D,EAA6D8K,KAAK,EAAE/L,QAAP,CAAgBC,CAA7E;YACA;;UAEF,KAAK,GAAL;YACE;YACA8L,KAAK,EAAE/L,QAAP,CAAgBqD,GAAhB,CAAoB0I,KAAK,EAAE/L,QAAP,CAAgBmE,CAApC,EAAsC4H,KAAK,EAAE/L,QAAP,CAAgBiB,CAAtD,EAAwD8K,KAAK,EAAE/L,QAAP,CAAgBC,CAAhB,GAAmB,GAA3E;YACA;;UAEF,KAAK,GAAL;YACE;YACA8L,KAAK,EAAE/L,QAAP,CAAgBqD,GAAhB,CAAoB0I,KAAK,EAAE/L,QAAP,CAAgBmE,CAApC,EAAsC4H,KAAK,EAAE/L,QAAP,CAAgBiB,CAAtD,EAAwD8K,KAAK,EAAE/L,QAAP,CAAgBC,CAAhB,GAAmB,GAA3E;YACA;;UAEF;YAAQ;QArBV;MAuBD,CAxBD;IAyBD;EACF;;EAM4B,OAAdqD,cAAc,CAAC6I,GAAD,EAAaC,GAAb,EAAyBC,GAAzB,EAAoC;IAC/D,IAAIC,cAAc,GAAW,EAA7B;IACA,MAAMC,GAAG,GAAC,CAAC,GAAX;IACA,MAAMC,GAAG,GAAC,GAAV;IACA,MAAMC,GAAG,GAACD,GAAG,GAAC,CAAd;IAEAF,cAAc,CAAC,CAAD,CAAd,GAAkB,EAAG,CAACE,GAAG,GAAED,GAAN,KAAa,SAAO,MAApB,CAAD,IAA+BH,GAAG,GAAC,MAAnC,IAA4CG,GAA9C,CAAlB;IACAD,cAAc,CAAC,CAAD,CAAd,GAAqB,CAACG,GAAG,GAAE,CAACA,GAAP,KAAc,UAAQ,OAAtB,CAAD,IAAkCN,GAAG,GAAC,OAAtC,IAAgD,CAACM,GAArE;IACAH,cAAc,CAAC,CAAD,CAAd,GAAsBE,GAAG,GAAG,GAAP,GAAcH,GAAnC;IACAK,QAAQ,CAAEJ,cAAc,CAAC,CAAD,CAAd,CAAkBK,OAAlB,CAA0B,CAA1B,CAAF,CAAR;IACAD,QAAQ,CAAEJ,cAAc,CAAC,CAAD,CAAd,CAAkBK,OAAlB,CAA0B,CAA1B,CAAF,CAAR;IACAD,QAAQ,CAAEJ,cAAc,CAAC,CAAD,CAAd,CAAkBK,OAAlB,CAA0B,CAA1B,CAAF,CAAR;IAEA,OAAOL,cAAP;EACD;;EAGDM,OAAO,IAEN;;EAEDC,WAAW,CAACC,KAAD,EAAkB,CAE5B;;EAEM1O,aAAa;IAClB;;;;;;IAOA,KAAK2O,gBAAL,CAAsBC,IAAtB,CAA2B,sCAA3B,EAAoEC,MAAD,IAAW;MAC5E,KAAK1C,UAAL,CAAgB2C,SAAhB,CAA2BD,MAA3B;MACA,KAAK1C,UAAL,CAAgB4C,OAAhB,CAAyB,IAAzB;MACA,KAAK5C,UAAL,CAAgB6C,SAAhB,CAA2B,GAA3B;IACD,CAJD;IAMA,KAAKzM,aAAL,GAAmB,IAAI/D,KAAK,CAACyQ,aAAV,GAA0BL,IAA1B,CAA+B,wBAA/B,CAAnB;IAEA,KAAKlM,mBAAL,GAAyB,IAAIlE,KAAK,CAACyQ,aAAV,GAA0BL,IAA1B,CAA+B,2BAA/B,CAAzB;IACA,KAAKlM,mBAAL,CAAyBwM,UAAzB,GAAsC,EAAtC;IACA,KAAKxM,mBAAL,CAAyByM,KAAzB,GAAiC,KAAKzM,mBAAL,CAAyB0M,KAAzB,GAAiC5Q,KAAK,CAAC6Q,sBAAxE;IACA,KAAK3M,mBAAL,CAAyB4M,SAAzB,GAAqC9Q,KAAK,CAAC+Q,YAA3C;IACA,KAAK7M,mBAAL,CAAyB8M,SAAzB,GAAqChR,KAAK,CAAC+Q,YAA3C;IACA,KAAK7M,mBAAL,CAAyB+M,eAAzB,GAA2C,KAA3C;IACA,KAAK/M,mBAAL,CAAyBgN,WAAzB,GAAuC,IAAvC;IAEA,MAAMC,UAAU,GAAG,IAAI1Q,UAAJ,EAAnB;IACA0Q,UAAU,CAACf,IAAX,CAAgB,+BAAhB,EAAkDgB,IAAD,IAAS;MACxDA,IAAI,CAACvO,KAAL,CAAWwO,KAAX,CAAiB5K,GAAjB,CAAqB,IAArB,EAA2B,IAA3B,EAAiC,IAAjC;MACA2K,IAAI,CAACvO,KAAL,CAAWmE,UAAX,GAAsB,IAAtB;MACAoK,IAAI,CAACvO,KAAL,CAAWyB,aAAX,GAAyB,IAAzB;MACA,KAAKkD,WAAL,GAAiB4J,IAAI,CAACvO,KAAtB;IACD,CALD,EAKG+I,SALH,EAKc,UAAU0F,KAAV,EAAe;MAE3BzP,OAAO,CAACyP,KAAR,CAAcA,KAAd;IACD,CARD;IASA,MAAMC,WAAW,GAAG,IAAI9Q,UAAJ,EAApB;IACA8Q,WAAW,CAACnB,IAAZ,CAAiB,2BAAjB,EAA+CgB,IAAD,IAAS;MACrDA,IAAI,CAACvO,KAAL,CAAWwO,KAAX,CAAiB5K,GAAjB,CAAqB,GAArB,EAA0B,GAA1B,EAA+B,GAA/B;MACA2K,IAAI,CAACvO,KAAL,CAAWmE,UAAX,GAAsB,IAAtB;MACAoK,IAAI,CAACvO,KAAL,CAAWyB,aAAX,GAAyB,IAAzB;MACA,KAAKmG,OAAL,GAAa2G,IAAI,CAACvO,KAAlB;IACD,CALD,EAKG+I,SALH,EAKc,UAAU0F,KAAV,EAAe;MAE3BzP,OAAO,CAACyP,KAAR,CAAcA,KAAd;IACD,CARD;IASA,KAAKhL,iBAAL,GAAuB,IAAItG,KAAK,CAACyQ,aAAV,GAA0BL,IAA1B,CAA+B,4BAA/B,CAAvB;IAEA,KAAKhI,cAAL,GAAoB,IAAIpI,KAAK,CAACyQ,aAAV,GAA0BL,IAA1B,CAA+B,yBAA/B,CAApB;IACA,KAAKhI,cAAL,CAAoBsI,UAApB,GAAiC,EAAjC;IACA,KAAKtI,cAAL,CAAoBuI,KAApB,GAA4B,KAAKvI,cAAL,CAAoBwI,KAApB,GAA4B5Q,KAAK,CAAC6Q,sBAA9D;IACA,KAAKzI,cAAL,CAAoB0I,SAApB,GAAgC9Q,KAAK,CAAC+Q,YAAtC;IACA,KAAK3I,cAAL,CAAoB4I,SAApB,GAAgChR,KAAK,CAAC+Q,YAAtC;IACA,KAAK3I,cAAL,CAAoB6I,eAApB,GAAsC,KAAtC;IACA,KAAK7I,cAAL,CAAoB8I,WAApB,GAAkC,IAAlC;IAEA,KAAKpI,WAAL,GAAiB,IAAI9I,KAAK,CAACyQ,aAAV,GAA0BL,IAA1B,CAA+B,0BAA/B,CAAjB;IACA,KAAKtH,WAAL,CAAiB4H,UAAjB,GAA8B,EAA9B;IACA,KAAK5H,WAAL,CAAiB6H,KAAjB,GAAyB,KAAK7H,WAAL,CAAiB8H,KAAjB,GAAyB5Q,KAAK,CAAC6Q,sBAAxD;IACA,KAAK/H,WAAL,CAAiBgI,SAAjB,GAA6B9Q,KAAK,CAAC+Q,YAAnC;IACA,KAAKjI,WAAL,CAAiBkI,SAAjB,GAA6BhR,KAAK,CAAC+Q,YAAnC;IACA,KAAKjI,WAAL,CAAiBmI,eAAjB,GAAmC,KAAnC;IACA,KAAKnI,WAAL,CAAiBoI,WAAjB,GAA+B,IAA/B;EACD,CA5nB0B,CA+nB3B;;;EACO3F,oBAAoB,CAACiG,eAAD,EAAqBC,eAArB,EAAwC;IACjE,KAAI,IAAIxL,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKjE,MAAL,CAAYkE,MAA1B,EAAiCD,CAAC,EAAlC,EAAqC;MACnC,IAAGuL,eAAe,IAAE,KAAKxP,MAAL,CAAYiE,CAAZ,EAAe8B,SAAhC,IAA8C0J,eAAe,IAAE,KAAKzP,MAAL,CAAYiE,CAAZ,EAAe4B,WAAjF,EAA6F;QAC3F,OAAO,KAAK7F,MAAL,CAAYiE,CAAZ,CAAP;MACD;;MACD,IAAGuL,eAAe,IAAE,KAAKxP,MAAL,CAAYiE,CAAZ,EAAe4B,WAAhC,IAA+C4J,eAAe,IAAE,KAAKzP,MAAL,CAAYiE,CAAZ,EAAe8B,SAAlF,EAA4F;QAC1F,OAAO,KAAK/F,MAAL,CAAYiE,CAAZ,CAAP;MACD;IACF;;IACD,OAAO,IAAP;EACD;;EACM4F,6BAA6B,CAAC2F,eAAD,EAAqBC,eAArB,EAAwC;IAC1E,KAAI,IAAIxL,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKjE,MAAL,CAAYkE,MAA1B,EAAiCD,CAAC,EAAlC,EAAqC;MACnC,IAAGuL,eAAe,IAAE,KAAKxP,MAAL,CAAYiE,CAAZ,EAAe8B,SAAhC,IAA8C0J,eAAe,IAAE,KAAKzP,MAAL,CAAYiE,CAAZ,EAAe4B,WAAjF,EAA6F;QAC3F,OAAO,IAAP;MACD,CAFD,MAEM,IAAG2J,eAAe,IAAE,KAAKxP,MAAL,CAAYiE,CAAZ,EAAe4B,WAAhC,IAA+C4J,eAAe,IAAE,KAAKzP,MAAL,CAAYiE,CAAZ,EAAe8B,SAAlF,EAA4F;QAChG,OAAO,KAAP;MACD;IACF;;IACD,OAAO,KAAP;EACD;;EAEM2J,gCAAgC,CAACC,eAAD,EAAuB;IAC5D,KAAI,IAAI1L,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAKrE,UAAL,CAAgBsE,MAA9B,EAAqCD,CAAC,EAAtC,EAAyC;MACvC,IAAG,KAAKrE,UAAL,CAAgBqE,CAAhB,EAAmBkB,WAAnB,IAAgCwK,eAAnC,EAAmD;QACjD,OAAO,KAAK/P,UAAL,CAAgBqE,CAAhB,EAAmBc,mBAA1B;MACD;IACF;;IACD,OAAO,EAAP;EACD;;EAEM6K,YAAY;IACjB,IAAIC,EAAE,GAAG/D,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,CAAT;IACA,IAAI+D,EAAE,GAAGhE,QAAQ,CAACC,cAAT,CAAwB,yBAAxB,CAAT;IAEA,IAAI1K,CAAC,GAACyK,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,CAAN;;IAEA,IAAI8D,EAAE,IAAE,IAAJ,IAAYC,EAAE,IAAE,IAAhB,IAAsBzO,CAAC,IAAE,IAA7B,EAAmC;MACjC,IAAIwO,EAAE,CAAC7D,KAAH,CAASC,OAAT,KAAqB,MAArB,IAA8B6D,EAAE,CAAC9D,KAAH,CAASC,OAAT,KAAqB,MAAvD,EAA+D;QAC7D4D,EAAE,CAAC7D,KAAH,CAASC,OAAT,GAAmB,OAAnB;QACA6D,EAAE,CAAC9D,KAAH,CAASC,OAAT,GAAmB,OAAnB;QACA5K,CAAC,CAAC2K,KAAF,CAAQC,OAAR,GAAgB,MAAhB;MACD;IACF;EACF;;EAEM8D,uBAAuB,CAACjH,EAAD,EAAgB;IAC5C,KAAKJ,mBAAL,GAAyB,IAAzB;IACA,IAAIsH,gBAAgB,GAAClE,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,CAArB;;IACA,IAAGiE,gBAAgB,IAAE,IAArB,EAA0B;MACxBA,gBAAgB,CAAChE,KAAjB,CAAuBC,OAAvB,GAA+B,OAA/B;IACD;;IACDnD,EAAE,CAACmH,cAAH,CAAkB;MAACC,QAAQ,EAAE;IAAX,CAAlB;EAED;;EAEMC,oBAAoB,CAACrH,EAAD,EAAgB;IACzC,KAAKJ,mBAAL,GAAyB,KAAzB;IAEA,IAAI0H,aAAa,GAACtE,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAlB;;IACA,IAAGqE,aAAa,IAAE,IAAlB,EAAuB;MACrBA,aAAa,CAACpE,KAAd,CAAoBC,OAApB,GAA4B,OAA5B;IACD;;IACDnD,EAAE,CAACmH,cAAH,CAAkB;MAACC,QAAQ,EAAE;IAAX,CAAlB;EAED;;EAGMzE,UAAU,CAAC3C,EAAD,EAAiBhH,GAAjB,EAAwB;IACvC,IAAIuO,iBAAiB,GAACvE,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAtB;;IACA,IAAGsE,iBAAiB,IAAE,IAAtB,EAA2B;MACzBA,iBAAiB,CAACrE,KAAlB,CAAwBC,OAAxB,GAAgC,OAAhC;IACD;;IACD,IAAGnK,GAAG,IAAE,IAAR,EAAa;MACXA,GAAG,CAACiH,OAAJ,CAAY,CAACO,IAAD,EAAO6D,KAAP,KAAgB;QAC1BtN,OAAO,CAACC,GAAR,CAAY,OAAZ;QACAD,OAAO,CAACC,GAAR,CAAY,YAAUqN,KAAtB;QACAtN,OAAO,CAACC,GAAR,CAAY,WAASwJ,IAArB;QAEA,KAAK8D,WAAL,GAAiBD,KAAjB;QAEA,IAAImD,SAAS,GAAGhH,IAAI,CAACiH,IAAL,GAAYC,KAAZ,CAAkB,GAAlB,CAAhB;;QACA,KAAK,IAAIvM,CAAC,GAAC,CAAX,EAAaA,CAAC,GAAEqM,SAAS,CAAC,CAAD,CAAT,CAAapM,MAA7B,EAAoCD,CAAC,EAArC,EAAwC;UACtCqM,SAAS,CAAC,CAAD,CAAT,CAAaG,SAAb;UACAH,SAAS,CAAC,CAAD,CAAT,CAAaI,OAAb;QACD;;QACD,KAAK,IAAIzM,CAAC,GAAC,CAAX,EAAaA,CAAC,GAAEqM,SAAS,CAAC,CAAD,CAAT,CAAapM,MAA7B,EAAoCD,CAAC,EAArC,EAAwC;UACtCqM,SAAS,CAAC,CAAD,CAAT,CAAaG,SAAb;UACAH,SAAS,CAAC,CAAD,CAAT,CAAaI,OAAb;QACD;;QACD7Q,OAAO,CAACC,GAAR,CAAY,gBAAcwQ,SAA1B;QACAzQ,OAAO,CAACC,GAAR,CAAY,YAAUwQ,SAAS,CAAC,CAAD,CAAnB,GAAuB,QAAnC;QAEA,IAAI3K,KAAK,GAAC,KAAK+J,gCAAL,CAAsCY,SAAS,CAAC,CAAD,CAAT,CAAaC,IAAb,EAAtC,CAAV;QACA,IAAIzK,KAAK,GAAC,KAAK4J,gCAAL,CAAsCY,SAAS,CAAC,CAAD,CAAT,CAAaC,IAAb,EAAtC,CAAV;QAEA1Q,OAAO,CAACC,GAAR,CAAY,aAAW6F,KAAvB;QACA9F,OAAO,CAACC,GAAR,CAAY,aAAWgG,KAAvB;QAEA,IAAI6K,MAAM,GAAE,KAAKnJ,SAAL,CAAemC,GAAf,CAA2B,KAAKJ,oBAAL,CAA0B5D,KAA1B,EAAgCG,KAAhC,EAAuC2B,OAAlE,CAAZ;;QACA,IAAG,CAAC,KAAKoC,6BAAL,CAAmClE,KAAnC,EAAyCG,KAAzC,CAAJ,EAAoD;UAClD,KAAK8K,0BAAL,CAAgCnM,GAAhC,CAAoCkM,MAAM,CAACjS,gBAAgB,CAACuL,KAAlB,CAA1C,EAAmE0G,MAAM,CAACjS,gBAAgB,CAACwL,KAAlB,CAAzE,EAAkGyG,MAAM,CAACjS,gBAAgB,CAACyL,KAAlB,CAAxG;QACD,CAFD,MAEK;UACH,KAAKyG,0BAAL,CAAgCnM,GAAhC,CAAoCkM,MAAM,CAACjS,gBAAgB,CAAC6L,KAAlB,CAA1C,EAAmEoG,MAAM,CAACjS,gBAAgB,CAAC8L,KAAlB,CAAzE,EAAkGmG,MAAM,CAACjS,gBAAgB,CAAC+L,KAAlB,CAAxG;QACD;MACF,CA/BD;IAgCD;;IACD3B,EAAE,CAACmH,cAAH,CAAkB;MAACC,QAAQ,EAAE;IAAX,CAAlB;EACD;;EAEMW,YAAY,CAAC/H,EAAD,EAAgB;IACjC,IAAI,KAAKJ,mBAAT,EAA8B;MAC5B,KAAKJ,QAAL,CAAc,KAAKY,cAAnB,EAAmC,KAAKsC,6BAAxC;IACD,CAFD,MAEO;MACL,KAAKlD,QAAL,CAAc,KAAK8E,WAAnB,EAAgC,KAAKwD,0BAArC;IACD;;IAED,IAAIE,oBAAoB,GAAGhF,QAAQ,CAACC,cAAT,CAAwB,sBAAxB,CAA3B;IACA,IAAIgF,uBAAuB,GAAGjF,QAAQ,CAACC,cAAT,CAAwB,yBAAxB,CAA9B;IACA,IAAIiF,oCAAJ;;IAEA,IAAI,KAAKtI,mBAAT,EAA8B;MAC5BsI,oCAAoC,GAAGlF,QAAQ,CAACC,cAAT,CAAwB,8BAAxB,CAAvC;IACD,CAFD,MAEM;MACJiF,oCAAoC,GAAGlF,QAAQ,CAACC,cAAT,CAAwB,2BAAxB,CAAvC;IACD;;IAED,IAAIiE,gBAAgB,GAAClE,QAAQ,CAACC,cAAT,CAAwB,kBAAxB,CAArB;IACA,IAAIqE,aAAa,GAACtE,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAlB;IACA,IAAIsE,iBAAiB,GAACvE,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,CAAtB;;IAEA,IAAI+E,oBAAoB,IAAE,IAAtB,IAA8BC,uBAAuB,IAAE,IAAvD,IAA6DC,oCAAoC,IAAE,IAAnG,IAA2GhB,gBAAgB,IAAE,IAA7H,IAAqII,aAAa,IAAE,IAApJ,IAA2JC,iBAAiB,IAAE,IAAlL,EAAwL;MACtLS,oBAAoB,CAAC9E,KAArB,CAA2BC,OAA3B,GAAqC,MAArC;MACA8E,uBAAuB,CAAC/E,KAAxB,CAA8BC,OAA9B,GAAwC,MAAxC;MACA+E,oCAAoC,CAAChF,KAArC,CAA2CC,OAA3C,GAAmD,OAAnD;MACA+D,gBAAgB,CAAChE,KAAjB,CAAuBC,OAAvB,GAA+B,MAA/B;MACAmE,aAAa,CAACpE,KAAd,CAAoBC,OAApB,GAA4B,MAA5B;MACAoE,iBAAiB,CAACrE,KAAlB,CAAwBC,OAAxB,GAAgC,MAAhC;MAEAnD,EAAE,CAACmH,cAAH,CAAkB;QAACC,QAAQ,EAAE;MAAX,CAAlB;IACD;EAEF;;AA9wB0B;AAqDZxR,0BAAO,CAAP;AAAwBA,0BAAO,CAAP;AACxBA,yBAAM,CAAN;AAAuBA,yBAAM,CAAN;AAAuBA,yBAAM,CAAN;AAC9CA,yBAAM,CAAN;AAAuBA,yBAAM,CAAN;AAAuBA,yBAAM,CAAN;AAC9CA,0BAAO,CAAP;AAAwBA,0BAAO,CAAP;AAAwBA,0BAAO,EAAP;AAChDA,wBAAK,EAAL;AAAuBA,yBAAM,EAAN;;;mBAzD3BA,kBAAgBuS;AAAA;;;QAAhBvS;EAAgBwS;EAAAC;IAAA;;;;;;;;;;;;;;;;;;;;;;;MChB7BF,+BAAuC,CAAvC,EAAuC,IAAvC,EAAuC,CAAvC,EAAuC,IAAvC,EAAuC,CAAvC,EAAuC,GAAvC,EAAuC,CAAvC;MAG6BA;MAAIA;MAE7BA,2BAAK,CAAL,EAAK,GAAL,EAAK,CAAL;MAC6BA;QAAA,OAASG,kBAAT;MAAuB,CAAvB;MAAyBH;MAAaA;MAGnEA,8BAAoD,CAApD,EAAoD,GAApD,EAAoD,CAApD;MAAwDA;QAAAA;;QAAA;;QAAA,OAASA,6CAAT;MAAwC,CAAxC;MAA0CA;MAAeA;MACjHA,+BAAuD,EAAvD,EAAuD,GAAvD,EAAuD,CAAvD;MAA2DA;QAAAA;;QAAA;;QAAA,OAASA,gDAAT;MAAwC,CAAxC;MAA0CA;MAAkBA;MACvHA,+BAA4D,EAA5D,EAA4D,GAA5D,EAA4D,CAA5D;MAAgEA;QAAA,OAASG,4BAAT;MAAiC,CAAjC;MAAmCH;MAAKA;MACxGA,+BAAyD,EAAzD,EAAyD,GAAzD,EAAyD,CAAzD;MAA6DA;QAAA,OAASG,yBAAT;MAA8B,CAA9B;MAAgCH;MAAKA;MAClGA,+BAAwD,EAAxD,EAAwD,GAAxD,EAAwD,CAAxD;MAA4DA;QAAA,OAASG,wBAAT;MAA6B,CAA7B;MAA+BH;MAAIA;MAKnGA,gCAAkB,EAAlB,EAAkB,KAAlB,EAAkB,EAAlB,EAAkB,EAAlB,EAAkB,KAAlB,EAAkB,IAAlB,EAAkB,EAAlB,EAAkB,EAAlB,EAAkB,QAAlB,EAAkB,EAAlB,EAAkB,EAAlB;MAImCA;QAAA,OAAaG,uBAAb;MAAgC,CAAhC,EAAiC,OAAjC,EAAiC;QAAA,OAAUA,aAAV;MAAmB,CAApD;MAAsDH;MAGrFA,uCAAgB,EAAhB,EAAgB,uBAAhB,EAAgB,EAAhB;MACmHA;QAAAA;;QAAA;;QAAA,OAAyBA,iEAAzB;MAAsE,CAAtE;MAAyEA;MAG5LA,uCAAa,EAAb,EAAa,4BAAb,EAAa,EAAb;MACwEA;QAAAA;;QAAA;;QAAA,OAAyBA,2CAAzB;MAAgD,CAAhD;MAAkDA;MAG1HA,iCAAoC,EAApC,EAAoC,QAApC,EAAoC,EAApC,EAAoC,EAApC;MAE6FA;QAAAA;;QAAA;;QAAA,OAASA,qCAAT;MAAoC,CAApC;MAAsCA;MAAIA;;;;MATlEA;MAAAA","names":["ElementRef","THREE","TextSprite","Group","LineCurve3","MeshBasicMaterial","MeshStandardMaterial","Object3D","Vector3","OrbitControls","GLTFLoader","NetworkComponent","constructor","route","warehousesService","routesService","trucksService","CylinderGeometry","Map","AudioLoader","AudioListener","Audio","ambientListener","truckListener","ngOnInit","importLoaders","getWarehouses","subscribe","data","warehouses","console","log","getRoutes","routes","getTrucks","trucks","createScene","startRenderingLoop","ngAfterViewInit","canvas","canvasRef","nativeElement","getAspectRatio","window","innerWidth","innerHeight","scene","Scene","camera","PerspectiveCamera","fieldOfView","nearClippingPlane","farClippingPlane","position","z","cameraZ","add","addSkybox","addWarehouses","addLights","skyboxGeo","BoxGeometry","skyboxMaterials","map","skyBoxTexture","side","BackSide","skyBoxGroundTexture","skybox","Mesh","y","receiveShadow","renderer","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","type","PCFSoftShadowMap","controls","domElement","maxDistance","minDistance","minAzimuthAngle","Math","PI","maxAzimuthAngle","maxPolarAngle","component","render","requestAnimationFrame","manualMovement","automaticMovement","setViewport","setClearColor","i","length","warehouseBaseMaterial","MeshLambertMaterial","color","roundaboutTexture","base","warehouseBaseGeometry","set","getCoordinates","latitude","longitude","warehouseAltitude","name","warehouseIdentifier","castShadow","sprite","text","designation","alignment","fontFamily","fontStyle","x","warehouse3D","clone","addRoads","ware0","getObjectByName","departureId","ware1","arrivalId","teta0","atan2","teta1","elemLigMaterial","elemLigTexture","elemLigGeometry","elemLig0Mesh","parameters","radiusTop","cos","sin","rotateY","elemLig1Mesh","roadMaterial","roadTexture","roadGeometry","sqrt","pow","roadMesh","beta","asin","depth","omega","rotation","roadsData","routeId","light_amb","AmbientLight","directLight","DirectionalLight","spotLight","SpotLight","target","shadow","mapSize","width","height","far","addTruck","truckName","truckInitialPosition","truck3D","isAutomaticMovement","activeTrucks","push","setAutomaticMovementRoutAndTruck","el","forEach","value","key","automaticTruck","path","CurvePath","divisionCount","road","getRouteByWarehouses","wareDeparture","warehouseArrival","roadData","get","undefined","isRegisteredFirstOnRoutObject","rightMovement_X","TETA_0","rightMovement_Z","EL0_X","EL0_Y","EL0_Z","ROAD_X","ROAD_Y","ROAD_Z","EL1_X","EL1_Y","EL1_Z","nextRoadData","vectorEl0_Ware","subVectors","normalize","vectorWAre_EL1","delta","angleTo","t","j","TETA_1","autoClose","pathLength","getLength","pathsData","automaticTruckInitialPosition","scrollDone","startAutomaticMovement","truckAudio","play","x3","document","getElementById","style","display","activateMotion","points","getPoint","currentDistance","lookAt","speed","remove","delete","filter","obj","stop","startManualMovement","optionStartManualDelivery","optionStopManualDelivery","activateManualMovement","stopManualMovement","optionMakeDelivery","truck","manualTruck","onkeydown","e","lat","lon","alt","coordinatesArr","min","max","med","parseInt","toFixed","onClick","onMouseMove","event","truckSoundLoader","load","buffer","setBuffer","setLoop","setVolume","TextureLoader","anisotropy","wrapS","wrapT","MirroredRepeatWrapping","minFilter","LinearFilter","magFilter","generateMipmaps","needsUpdate","loaderWare","gltf","scale","error","loaderTruck","ware1Identifier","ware2Identifier","wareDesignationToWareIdConverter","wareDesignation","makeDelivery","x1","x2","scrollAutomaticDelivery","automaticSection","scrollIntoView","behavior","scrollManualDelivery","manualSection","buttonDoneSection","roadSplit","trim","split","trimStart","trimEnd","vector","manualTruckInitialPosition","scrollCanvas","optionManualDelivery","optionAutomaticDelivery","optionStartAutomaticOrManualDelivery","i0","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.ts","C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.html"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport * as THREE from \"three\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport TextSprite from \"@seregpie/three.text-sprite\";\r\nimport {BoxGeometry, Group, LineCurve3, Mesh, MeshBasicMaterial, MeshStandardMaterial, Object3D, Vector3} from 'three';\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport { GLTFLoader} from \"three/examples/jsm/loaders/GLTFLoader\";\r\nimport {WarehousesService} from \"../../services/dotnet/warehouses.service\";\r\nimport {RoutesService} from \"../../services/node/routes.service\";\r\nimport {TrucksService} from \"../../services/node/truck.service\";\r\n\r\n@Component({\r\n  selector: 'app-network',\r\n  templateUrl: './network.component.html',\r\n  styleUrls: ['./network.component.css']\r\n})\r\nexport class NetworkComponent implements OnInit, AfterViewInit {\r\n\r\n  //tipo do canvas\r\n  @ViewChild('canvas')\r\n  private canvasRef: ElementRef;\r\n\r\n  //* Stage Properties;\r\n  @Input() public cameraZ: number = 400; //* Aproximação da câmara || Coordenada Z\r\n  @Input() public fieldOfView: number = 5;  //* Distância da câmara\r\n  @Input('nearClipping') public nearClippingPlane: number = 1;//* Proximidade do plano\r\n  @Input('farClipping') public farClippingPlane: number = 30000;//* Afastamento do plano\r\n\r\n\r\n  private renderer!: THREE.WebGLRenderer;\r\n  private scene!: THREE.Scene;\r\n  private camera!: THREE.PerspectiveCamera;\r\n\r\n  private warehouses:any[]=[];\r\n  private routes:Route[]=[];trucks:Truck[]=[];\r\n\r\n  private activeTrucks:Object3D[]=[];\r\n\r\n  private automaticTruck:string;\r\n  manualTruck:string;\r\n  manualTruckChosenRoad:string;\r\n  manualTruckRoads:string[]=[]\r\n\r\n  private automaticTruckInitialPosition:Vector3;\r\n  private manualTruckInitialPosition:Vector3;\r\n\r\n  private skyBoxTexture:THREE.Texture;\r\n  private skyBoxGroundTexture:THREE.Texture;\r\n\r\n  private warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\r\n  private warehouse3D: Group;\r\n  private roundaboutTexture: THREE.Texture ;\r\n  private elemLigTexture: THREE.Texture ;\r\n  private roadTexture:THREE.Texture;\r\n  private truck3D:Group;\r\n\r\n  public checkerNetworkPlanedRoutes=true;\r\n\r\n  private activateMotion=false;\r\n  private isAutomaticMovement=false;\r\n  private activateManualMovement=false;\r\n\r\n  private pathsData = new Map<string, THREE.CurvePath<any>>([]);\r\n\r\n  private pathLength:number;\r\n  private currentDistance = 0;\r\n  private speed = 0.2;\r\n\r\n  private roadsData = new Map<string, number[]>([]);\r\n  private static TETA_0=0;private static TETA_1=1;\r\n  private static EL0_X=2;private static EL0_Y=3;private static EL0_Z=4;\r\n  private static EL1_X=5;private static EL1_Y=6;private static EL1_Z=7;\r\n  private static ROAD_X=8;private static ROAD_Y=9;private static ROAD_Z=10;\r\n  private static BETA=11;private static OMEGA=12;\r\n\r\n  private ambientSoundLoader = new THREE.AudioLoader();\r\n  private ambientListener=new THREE.AudioListener();\r\n  private ambientAudio=new THREE.Audio(this.ambientListener);\r\n\r\n  private truckSoundLoader = new THREE.AudioLoader();\r\n  private truckListener=new THREE.AudioListener();\r\n  private truckAudio=new THREE.Audio(this.truckListener);\r\n\r\n  constructor(private route: ActivatedRoute,private  warehousesService:WarehousesService, private routesService:RoutesService,private trucksService:TrucksService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.importLoaders();\r\n\r\n    this.warehousesService.getWarehouses().subscribe(async data=>{\r\n      this.warehouses=data;\r\n      console.log(this.warehouses)\r\n\r\n      this.routesService.getRoutes().subscribe(async data=>{\r\n        this.routes=data;\r\n        console.log(this.routes)\r\n\r\n        this.trucksService.getTrucks().subscribe(async data=>{\r\n          this.trucks=data;\r\n          console.log(this.trucks)\r\n          await this.createScene();\r\n          await this.startRenderingLoop();\r\n        })\r\n      })\r\n    })\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n  }\r\n\r\n  private get canvas(): HTMLCanvasElement {\r\n    return this.canvasRef.nativeElement;\r\n  }\r\n\r\n  //tamanho da janela\r\n  private static getAspectRatio() {\r\n    return window.innerWidth/ window.innerHeight;\r\n  }\r\n\r\n  private createScene() {\r\n\r\n    //* Scene\r\n    this.scene = new THREE.Scene();\r\n\r\n    //* Camera\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      this.fieldOfView,\r\n      NetworkComponent.getAspectRatio(),\r\n      this.nearClippingPlane,\r\n      this.farClippingPlane\r\n    );\r\n    //fog\r\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\r\n\r\n    this.camera.position.z = this.cameraZ;\r\n    this.scene.add(this.camera);\r\n\r\n    //sounds\r\n    this.camera.add( this.ambientListener);\r\n    this.camera.add(this.truckListener);\r\n\r\n    this.addSkybox();\r\n    this.addWarehouses()\r\n    this.addLights()\r\n  }\r\n\r\n\r\n  private addSkybox(){\r\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000,1000);\r\n    let skyboxMaterials= [new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshStandardMaterial({map:this.skyBoxGroundTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide})];\r\n\r\n    let skybox = new THREE.Mesh(skyboxGeo,skyboxMaterials);\r\n    skybox.position.y=400;\r\n    skybox.receiveShadow=true;\r\n    this.scene.add(skybox);\r\n  }\r\n\r\n  private startRenderingLoop() {\r\n    //* Renderer\r\n    // Use canvas element in template\r\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n    //definir janela\r\n    this.renderer.setSize(window.innerWidth,window.innerHeight);\r\n\r\n    //ShadowMap para permitir Sombras\r\n    this.renderer.shadowMap.enabled = true;\r\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n    //Orbit Controls\r\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\r\n\r\n    controls.maxDistance = 1500;//900 zoom out\r\n    controls.minDistance = 50;//100 zoom in\r\n    controls.minAzimuthAngle = -Math.PI ;//Rotação D 90º\r\n    controls.maxAzimuthAngle = Math.PI ;//Rotação E 90º\r\n    controls.maxPolarAngle = Math.PI/2 //Rotação Eixo Y 90º\r\n    // controls.minPolarAngle=Math.PI/2\r\n\r\n    let component: NetworkComponent = this;\r\n    (function render() {\r\n      requestAnimationFrame(render);\r\n\r\n\r\n      //Render truck Movement animation\r\n      component.manualMovement();\r\n\r\n      component.automaticMovement();\r\n\r\n\r\n      //janelade visualização\r\n      component.renderer.setViewport(-200, 0, window.innerWidth+200, window.innerHeight);\r\n      component.renderer.setClearColor(0xCADFED, 1);\r\n      component.renderer.render(component.scene, component.camera);\r\n\r\n    }());\r\n  }\r\n\r\n  private addWarehouses(){\r\n    for (let i = 0; i < this.warehouses.length; i++)\r\n    {\r\n      let warehouseBaseMaterial = [ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({map:this.roundaboutTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n\r\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, warehouseBaseMaterial);//*Base da Warehouse\r\n\r\n      base.position.set(\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\r\n\r\n      base.name=this.warehouses[i].warehouseIdentifier;\r\n      base.castShadow=true;\r\n      base.receiveShadow=true;\r\n\r\n      //Nomes cidades\r\n      let sprite=new TextSprite({ text: this.warehouses[i].designation,alignment: 'left',\r\n        color: '#000000',\r\n        fontFamily: '\"Arial\", Times, serif',\r\n        fontStyle: 'italic',});\r\n      sprite.position.set(base.position.x,base.position.y+3.2,base.position.z);\r\n      this.scene.add(sprite)\r\n\r\n      let warehouse3D=this.warehouse3D.clone();\r\n      warehouse3D.name = this.warehouses[i].designation;\r\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\r\n      this.scene.add(warehouse3D);\r\n\r\n      this.scene.add(base);\r\n    }\r\n    this.addRoads();\r\n  }\r\n\r\n  private addRoads() {\r\n\r\n    for (let i = 0; i < this.routes.length; i++) {\r\n      let ware0 = <Object3D>this.scene.getObjectByName((this.routes[i].departureId));\r\n      let ware1 = <Object3D>this.scene.getObjectByName((this.routes[i].arrivalId));\r\n\r\n      if(ware0!=null&&ware1!=null){\r\n        let teta0=Math.atan2(-(ware1.position.z-ware0.position.z),ware1.position.x-ware0.position.x);\r\n        let teta1=Math.PI+teta0;\r\n\r\n        let elemLigMaterial = [ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({map:this.elemLigTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n        let elemLigGeometry =new THREE.BoxGeometry(0.3, 0.20, 2);\r\n\r\n        let elemLig0Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig0Mesh.position.set(ware0.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta0),ware0.position.y,ware0.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta0));\r\n        elemLig0Mesh.rotateY(teta0)\r\n        elemLig0Mesh.castShadow=true;\r\n        elemLig0Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig0Mesh)\r\n\r\n        let elemLig1Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig1Mesh.position.set(ware1.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta1),ware1.position.y,ware1.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta1));\r\n        elemLig1Mesh.rotateY(teta1)\r\n        elemLig1Mesh.castShadow=true;\r\n        elemLig1Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig1Mesh)\r\n\r\n        let roadMaterial =[ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({map:this.roadTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n        let roadGeometry =new THREE.BoxGeometry(2, 0.20,  Math.sqrt(Math.pow(elemLig0Mesh.position.x-elemLig1Mesh.position.x,2)+Math.pow(elemLig0Mesh.position.y-elemLig1Mesh.position.y,2)+Math.pow(elemLig0Mesh.position.z-elemLig1Mesh.position.z,2)));\r\n        let roadMesh=new THREE.Mesh(roadGeometry,roadMaterial);\r\n\r\n        roadMesh.position.set((elemLig0Mesh.position.x+elemLig1Mesh.position.x)/2,(elemLig0Mesh.position.y+elemLig1Mesh.position.y)/2,(elemLig0Mesh.position.z+elemLig1Mesh.position.z)/2);\r\n        roadMesh.castShadow=true;\r\n        roadMesh.receiveShadow=true;\r\n        this.scene.add(roadMesh)\r\n\r\n        let beta =Math.asin((elemLig0Mesh.position.y-elemLig1Mesh.position.y)/roadGeometry.parameters.depth);\r\n        let omega=teta0+Math.PI/2;\r\n        roadMesh.rotation.set(beta,omega,0, \"ZYX\")\r\n\r\n        this.roadsData.set(this.routes[i].routeId,[teta0,teta1,elemLig0Mesh.position.x,elemLig0Mesh.position.y,elemLig0Mesh.position.z,elemLig1Mesh.position.x,elemLig1Mesh.position.y,elemLig1Mesh.position.z,roadMesh.position.x,roadMesh.position.y,roadMesh.position.z,beta,(teta0+Math.PI/2)])\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  private addLights(){\r\n    //*Light\r\n\r\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\r\n    this.scene.add(light_amb);\r\n\r\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    directLight.castShadow=true;\r\n    this.camera.add(directLight);\r\n\r\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\r\n    spotLight.position.set(0, 500, 40);\r\n    spotLight.castShadow=true;\r\n    spotLight.target.position.set(0,0,40);\r\n    spotLight.shadow.mapSize.width = 2048;\r\n    spotLight.shadow.mapSize.height = 2048;\r\n    spotLight.shadow.camera.far =1000;\r\n    this.scene.add(spotLight);\r\n    this.scene.add(spotLight.target);\r\n  }\r\n\r\n\r\n  private addTruck(truckName:string,truckInitialPosition:Vector3){\r\n\r\n    const truck3D = this.truck3D.clone();\r\n    truck3D.name = truckName;\r\n    truck3D.position.set(truckInitialPosition.x,truckInitialPosition.y,truckInitialPosition.z);\r\n    this.scene.add(truck3D);\r\n\r\n    if(this.isAutomaticMovement){\r\n      this.activeTrucks.push(<Object3D<Event>>this.scene.getObjectByName(truck3D.name))\r\n    }\r\n  }\r\n\r\n  public setAutomaticMovementRoutAndTruck(el:HTMLElement,map:Map<string,string[]>){\r\n    map.forEach((value, key) => {\r\n      this.automaticTruck=key;\r\n\r\n      let path = new THREE.CurvePath();\r\n\r\n      let divisionCount=10;\r\n\r\n      for(let i=0;i<value.length-1;i++){\r\n        let road=this.getRouteByWarehouses(value[i],value[i+1]);\r\n\r\n        let wareDeparture = this.scene.getObjectByName(value[i]);\r\n        let warehouseArrival= this.scene.getObjectByName(value[i+1])\r\n\r\n        let roadData=this.roadsData.get(<string>road?.routeId);\r\n\r\n        if(roadData!=undefined && warehouseArrival!=undefined &&wareDeparture!=undefined){\r\n          if(!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)){\r\n\r\n            let rightMovement_X=0.45*Math.cos(roadData[NetworkComponent.TETA_0]-Math.PI/2);\r\n            let rightMovement_Z=0.45*Math.sin(roadData[NetworkComponent.TETA_0]+Math.PI/2);\r\n\r\n\r\n            if(i==0) {\r\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z)));//W0-EL0\r\n            }\r\n\r\n            //road\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\r\n\r\n\r\n            let nextRoadData=this.roadsData.get(<string>this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\r\n\r\n            if( i< value.length-2 && nextRoadData!=null) {//Rotunda\r\n\r\n              let vectorEl0_Ware=new THREE.Vector3().subVectors(warehouseArrival.position,new Vector3(roadData[NetworkComponent.EL1_X],roadData[NetworkComponent.EL1_Y],roadData[NetworkComponent.EL1_Z])).normalize();\r\n              let vectorWAre_EL1=new THREE.Vector3().subVectors(new Vector3(nextRoadData[NetworkComponent.EL1_X],nextRoadData[NetworkComponent.EL1_Y],nextRoadData[NetworkComponent.EL1_Z]),warehouseArrival.position).normalize();\r\n\r\n              let delta=vectorEl0_Ware.angleTo(vectorWAre_EL1) ;\r\n\r\n              let t=(Math.PI-delta)/divisionCount;\r\n\r\n              for (let j = 0; j < divisionCount-1; j++) {\r\n                if(j==0) {\r\n                  path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z),new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.cos(roadData[NetworkComponent.TETA_1]+(j*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_1]+(j*t)))));\r\n                }\r\n\r\n                if(j>0&&j<divisionCount-2){\r\n                  path.add(new LineCurve3(new Vector3(warehouseArrival.position.x +(this.warehouseBaseGeometry.parameters.radiusTop -0.5)* Math.cos(roadData[NetworkComponent.TETA_1]+((j-1)*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_1]+((j-1)*t))),new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.cos(roadData[NetworkComponent.TETA_1]+(j*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_1]+(j*t)))));\r\n                }\r\n\r\n                if(j==divisionCount-2){\r\n                  if(this.isRegisteredFirstOnRoutObject(value[i+1],value[i+2])) {\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j - 1) * t))), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j ) * t)))));\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j ) * t))), new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z])));\r\n                  }else{\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j - 1) * t))), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j ) * t)))));\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_1] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_1] + ((j - 1) * t))), new Vector3(nextRoadData[NetworkComponent.EL0_X], nextRoadData[NetworkComponent.EL0_Y], nextRoadData[NetworkComponent.EL0_Z])));\r\n\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            if(i==value.length-2) {\r\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\r\n            }\r\n\r\n          }else{\r\n\r\n            let rightMovement_X=0.45*Math.cos(roadData[NetworkComponent.TETA_1]-Math.PI/2);\r\n            let rightMovement_Z=0.45*Math.sin(roadData[NetworkComponent.TETA_1]+Math.PI/2);\r\n\r\n            if(i==0) {\r\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\r\n            }\r\n            //road\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));//EL0-EL0_ROAD\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));//EL0-ROAD_ROAD\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));//ROAD-ROAD_EL1\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z)));//ROAD_EL1_EL1\r\n\r\n            let nextRoadData=this.roadsData.get(<string>this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\r\n\r\n            if( value.length-2 && nextRoadData!=null){//Roundabout\r\n\r\n              let vectorEl0_Ware=new THREE.Vector3().subVectors(warehouseArrival.position,new Vector3(roadData[NetworkComponent.EL0_X],roadData[NetworkComponent.EL0_Y],roadData[NetworkComponent.EL0_Z])).normalize();\r\n              let vectorWAre_EL1=new THREE.Vector3().subVectors(new Vector3(nextRoadData[NetworkComponent.EL1_X],nextRoadData[NetworkComponent.EL1_Y],nextRoadData[NetworkComponent.EL1_Z]),warehouseArrival.position).normalize();\r\n\r\n              let delta=vectorEl0_Ware.angleTo(vectorWAre_EL1) ;\r\n              let t=(Math.PI+delta)/divisionCount;\r\n\r\n              for (let j = 0; j < divisionCount-1; j++) {\r\n                if(j==0) {\r\n                  path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z),new Vector3(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(roadData[NetworkComponent.TETA_0]+(j*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_0]+(j*t)))));\r\n                }\r\n\r\n                if(j>0&&j<divisionCount-2){\r\n                  path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.cos(roadData[NetworkComponent.TETA_0]+((j-1)*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_0]+((j-1)*t))),new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.cos(roadData[NetworkComponent.TETA_0]+(j*t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop-0.5) * Math.sin(roadData[NetworkComponent.TETA_0]+(j*t)))));\r\n                }\r\n\r\n                if(j==divisionCount-2){\r\n                  if(this.isRegisteredFirstOnRoutObject(value[i+1],value[i+2])) {\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j - 1) * t))), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j ) * t)))));\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j ) * t))), new Vector3(nextRoadData[NetworkComponent.EL1_X], nextRoadData[NetworkComponent.EL1_Y], nextRoadData[NetworkComponent.EL1_Z])));\r\n                  }else{\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j - 1) * t))), new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j ) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j ) * t)))));\r\n                    path.add(new LineCurve3(new Vector3(warehouseArrival.position.x + (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.cos(roadData[NetworkComponent.TETA_0] + ((j - 1) * t)), warehouseArrival.position.y, warehouseArrival.position.z - (this.warehouseBaseGeometry.parameters.radiusTop - 0.5) * Math.sin(roadData[NetworkComponent.TETA_0] + ((j - 1) * t))), new Vector3(nextRoadData[NetworkComponent.EL0_X], nextRoadData[NetworkComponent.EL0_Y], nextRoadData[NetworkComponent.EL0_Z])));\r\n\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            if(i==value.length-2) {\r\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n      path.autoClose=true;\r\n      this.pathLength=path.getLength();\r\n      this.pathsData.set(key,path);\r\n      // @ts-ignore\r\n      this.automaticTruckInitialPosition=new Vector3(this.scene.getObjectByName(value[0])?.position.x,this.scene.getObjectByName(value[0])?.position.y,this.scene.getObjectByName(value[0])?.position.z+2);\r\n\r\n\r\n      this.scrollDone(el,null);\r\n    });\r\n\r\n\r\n  }\r\n\r\n  public startAutomaticMovement(){\r\n    //ativar o som do camião\r\n    this.truckAudio.play();\r\n\r\n    let x3=document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x3!=null && z!=null) {\r\n      if (x3.style.display === \"block\" &&z.style.display === \"none\") {\r\n        z.style.display = \"block\";\r\n        x3.style.display = \"none\";\r\n\r\n        //ativar o movimento do camião\r\n        this.activateMotion=true;\r\n      }\r\n    }\r\n  }\r\n\r\n  private automaticMovement() {\r\n    //Automatic truck movement\r\n\r\n    if (this.activateMotion  && this.activeTrucks.length!=0) {\r\n      for(let i=0;i<this.activeTrucks.length;i++){\r\n\r\n        // @ts-ignore\r\n        let points =this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\r\n\r\n        if (points!=undefined) {\r\n\r\n          this.activeTrucks[i]?.lookAt(points);\r\n          this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\r\n          this.currentDistance += this.speed;\r\n\r\n\r\n          if (this.currentDistance >= this.pathLength) {\r\n            this.activateMotion = false;\r\n            this.scene.remove(this.activeTrucks[i]);\r\n            this.pathsData.delete(this.activeTrucks[i].name);\r\n            this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\r\n            this.truckAudio.stop();\r\n            this.currentDistance=0;\r\n            this.automaticTruckInitialPosition=new Vector3();\r\n          }\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n  public startManualMovement(){\r\n    //ativar o som do camião\r\n    this.truckAudio.play();\r\n\r\n    let optionStartManualDelivery=document.getElementById(\"OptionStartManualDelivery\");\r\n    let optionStopManualDelivery=document.getElementById(\"OptionStopManualDelivery\");\r\n\r\n    if (optionStartManualDelivery!=null && stop!=null) {\r\n\r\n      optionStartManualDelivery.style.display = \"none\";\r\n      optionStopManualDelivery.style.display = \"block\";\r\n\r\n      //ativar o movimento do camião\r\n      this.activateManualMovement = true;\r\n    }\r\n  }\r\n\r\n\r\n  public stopManualMovement(){\r\n    //ativar o som do camião\r\n    this.truckAudio.stop();\r\n\r\n    let optionStopManualDelivery=document.getElementById(\"OptionStopManualDelivery\");\r\n    let optionMakeDelivery=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (optionStopManualDelivery!=null && optionMakeDelivery!=null) {\r\n      optionMakeDelivery.style.display = \"block\";\r\n      optionStopManualDelivery.style.display = \"none\";\r\n\r\n      //ativar o movimento do camião\r\n      this.activateManualMovement=false;\r\n    }\r\n  }\r\n\r\n  private manualMovement(){\r\n    if(this.activateManualMovement){\r\n      let truck = this.scene.getObjectByName(this.manualTruck);\r\n      document.onkeydown = function (e) {\r\n        switch (e.key) {\r\n          case \"a\":\r\n            //rodar a camara para a esquerda\r\n            truck?.position.set(truck?.position.x- 0.1,truck?.position.y,truck?.position.z) ;\r\n            break;\r\n\r\n          case \"d\":\r\n            //rodar a camara para a direita\r\n            truck?.position.set(truck?.position.x+ 0.1,truck?.position.y,truck?.position.z) ;\r\n            break;\r\n\r\n          case \"w\":\r\n            //avançar - incrementar a posição da camara no eixo dos zz\r\n            truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z- 0.1) ;\r\n            break;\r\n\r\n          case \"s\":\r\n            //recuar - decrementar a posição da camara no eixo dos zz\r\n            truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z+ 0.1) ;\r\n            break;\r\n\r\n          default:break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  private static getCoordinates(lat:number, lon:number, alt: number):any {\r\n    let coordinatesArr: number[]=[];\r\n    const min=-100;\r\n    const max=100;\r\n    const med=max/2;\r\n\r\n    coordinatesArr[0]=-(((max-(min))/(8.7613-8.2451))*(lon-8.2451)+(min));\r\n    coordinatesArr[1]=((((med-(-med))/(42.1115-40.8387))*(lat-40.8387)+(-med)));\r\n    coordinatesArr[2]=((((max / 800) * alt)));\r\n    parseInt( coordinatesArr[0].toFixed(4));\r\n    parseInt( coordinatesArr[1].toFixed(4));\r\n    parseInt( coordinatesArr[2].toFixed(4));\r\n\r\n    return coordinatesArr;\r\n  }\r\n\r\n\r\n  onClick() {\r\n\r\n  }\r\n\r\n  onMouseMove(event: MouseEvent) {\r\n\r\n  }\r\n\r\n  public importLoaders(){\r\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\r\n\r\n    this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', (buffer) => {\r\n      this.truckAudio.setBuffer( buffer );\r\n      this.truckAudio.setLoop( true );\r\n      this.truckAudio.setVolume( 0.5 );\r\n    });\r\n\r\n    this.skyBoxTexture=new THREE.TextureLoader().load('assets/network/sky.jpg');\r\n\r\n    this.skyBoxGroundTexture=new THREE.TextureLoader().load('assets/network/ground.jpg');\r\n    this.skyBoxGroundTexture.anisotropy = 16;\r\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.generateMipmaps = false;\r\n    this.skyBoxGroundTexture.needsUpdate = true;\r\n\r\n    const loaderWare = new GLTFLoader();\r\n    loaderWare.load('/assets/network/warehouse.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.warehouse3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    const loaderTruck = new GLTFLoader();\r\n    loaderTruck.load('/assets/network/Truck.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.truck3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    this.roundaboutTexture=new THREE.TextureLoader().load('assets/network/rotunda.jpg')\r\n\r\n    this.elemLigTexture=new THREE.TextureLoader().load('assets/network/road.jpg')\r\n    this.elemLigTexture.anisotropy = 16;\r\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.generateMipmaps = false;\r\n    this.elemLigTexture.needsUpdate = true;\r\n\r\n    this.roadTexture=new THREE.TextureLoader().load('assets/network/road1.jpg')\r\n    this.roadTexture.anisotropy = 16;\r\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.roadTexture.minFilter = THREE.LinearFilter;\r\n    this.roadTexture.magFilter = THREE.LinearFilter;\r\n    this.roadTexture.generateMipmaps = false;\r\n    this.roadTexture.needsUpdate = true;\r\n  }\r\n\r\n\r\n  //Auxiliar Methods\r\n  public getRouteByWarehouses(ware1Identifier:any,ware2Identifier:any):Route | null{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return this.routes[i];\r\n      }\r\n      if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return this.routes[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  public isRegisteredFirstOnRoutObject(ware1Identifier:any,ware2Identifier:any):boolean{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return true;\r\n      }else if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public wareDesignationToWareIdConverter(wareDesignation:string):string{\r\n    for(let i=0;i<this.warehouses.length;i++){\r\n      if(this.warehouses[i].designation==wareDesignation){\r\n        return this.warehouses[i].warehouseIdentifier\r\n      }\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public makeDelivery() {//bloquear o make delivery e mostrar as opcoes de automatic ou manual movement\r\n    let x1 = document.getElementById(\"OptionManualDelivery\");\r\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\r\n\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x1!=null && x2!=null&&z!=null) {\r\n      if (x1.style.display === \"none\" &&x2.style.display === \"none\") {\r\n        x1.style.display = \"block\";\r\n        x2.style.display = \"block\";\r\n        z.style.display=\"none\"\r\n      }\r\n    }\r\n  }\r\n\r\n  public scrollAutomaticDelivery(el: HTMLElement) {\r\n    this.isAutomaticMovement=true;\r\n    let automaticSection=document.getElementById(\"AutomaticSection\");\r\n    if(automaticSection!=null){\r\n      automaticSection.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n  public scrollManualDelivery(el: HTMLElement) {\r\n    this.isAutomaticMovement=false;\r\n\r\n    let manualSection=document.getElementById(\"ManualSection\");\r\n    if(manualSection!=null){\r\n      manualSection.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n\r\n  public scrollDone(el: HTMLElement,map:any){\r\n    let buttonDoneSection=document.getElementById(\"ButtonDoneSection\")\r\n    if(buttonDoneSection!=null){\r\n      buttonDoneSection.style.display=\"block\"\r\n    }\r\n    if(map!=null){\r\n      map.forEach((road, truck) => {\r\n        console.log(\"aquii\")\r\n        console.log(\"truck- \"+truck)\r\n        console.log(\"road- \"+road)\r\n\r\n        this.manualTruck=truck;\r\n\r\n        let roadSplit = road.trim().split(\"-\");\r\n        for (let i=0;i< roadSplit[0].length;i++){\r\n          roadSplit[0].trimStart();\r\n          roadSplit[0].trimEnd();\r\n        }\r\n        for (let i=0;i< roadSplit[0].length;i++){\r\n          roadSplit[1].trimStart();\r\n          roadSplit[1].trimEnd();\r\n        }\r\n        console.log(\"roadsplit- \"+roadSplit)\r\n        console.log(\"ware0 -\"+roadSplit[0]+\"AAAAAA\")\r\n\r\n        let ware0=this.wareDesignationToWareIdConverter(roadSplit[0].trim());\r\n        let ware1=this.wareDesignationToWareIdConverter(roadSplit[1].trim());\r\n\r\n        console.log(\"ware0 - \"+ware0)\r\n        console.log(\"ware1 - \"+ware1)\r\n\r\n        let vector= this.roadsData.get(<string>this.getRouteByWarehouses(ware0,ware1).routeId);\r\n        if(!this.isRegisteredFirstOnRoutObject(ware0,ware1)){\r\n          this.manualTruckInitialPosition.set(vector[NetworkComponent.EL0_X],vector[NetworkComponent.EL0_Y],vector[NetworkComponent.EL0_Z])\r\n        }else{\r\n          this.manualTruckInitialPosition.set(vector[NetworkComponent.EL1_X],vector[NetworkComponent.EL1_Y],vector[NetworkComponent.EL1_Z])\r\n        }\r\n      });\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n  }\r\n\r\n  public scrollCanvas(el: HTMLElement) {\r\n    if (this.isAutomaticMovement) {\r\n      this.addTruck(this.automaticTruck, this.automaticTruckInitialPosition)\r\n    } else {\r\n      this.addTruck(this.manualTruck, this.manualTruckInitialPosition)\r\n    }\r\n\r\n    let optionManualDelivery = document.getElementById(\"OptionManualDelivery\");\r\n    let optionAutomaticDelivery = document.getElementById(\"OptionAutomaticDelivery\");\r\n    let optionStartAutomaticOrManualDelivery;\r\n\r\n    if (this.isAutomaticMovement) {\r\n      optionStartAutomaticOrManualDelivery = document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    } else{\r\n      optionStartAutomaticOrManualDelivery = document.getElementById(\"OptionStartManualDelivery\");\r\n    }\r\n\r\n    let automaticSection=document.getElementById(\"AutomaticSection\");\r\n    let manualSection=document.getElementById(\"ManualSection\");\r\n    let buttonDoneSection=document.getElementById(\"ButtonDoneSection\")\r\n\r\n    if (optionManualDelivery!=null && optionAutomaticDelivery!=null&&optionStartAutomaticOrManualDelivery!=null && automaticSection!=null && manualSection!=null &&buttonDoneSection!=null) {\r\n      optionManualDelivery.style.display = \"none\";\r\n      optionAutomaticDelivery.style.display = \"none\";\r\n      optionStartAutomaticOrManualDelivery.style.display=\"block\"\r\n      automaticSection.style.display=\"none\"\r\n      manualSection.style.display=\"none\"\r\n      buttonDoneSection.style.display=\"none\";\r\n\r\n      el.scrollIntoView({behavior: 'smooth'});\r\n    }\r\n\r\n  }\r\n\r\n\r\n}\r\n","<nav class=\"navbar\" id=\"SectionNavbar\">\r\n  <ul>\r\n    <li >\r\n      <a href=\"/views/login\">Home</a>\r\n    </li>\r\n    <li >\r\n      <a id=\"OptionMakeDelivery\" (click)=\"makeDelivery()\">Make Delivery</a>\r\n    </li>\r\n\r\n    <li id=\"OptionManualDelivery\" style=\"display: none\"> <a (click)=\"scrollManualDelivery(Automatic)\">Manual Delivery</a></li>\r\n    <li id=\"OptionAutomaticDelivery\" style=\"display: none\"> <a (click)=\"scrollAutomaticDelivery(Manual)\">Automatic Delivery</a></li>\r\n    <li id=\"OptionStartAutomaticDelivery\" style=\"display: none\"> <a (click)=\"startAutomaticMovement()\">Start</a></li>\r\n    <li id=\"OptionStartManualDelivery\" style=\"display: none\"> <a (click)=\"startManualMovement()\">Start</a></li>\r\n    <li id=\"OptionStopManualDelivery\" style=\"display: none\"> <a (click)=\"stopManualMovement()\">Stop</a></li>\r\n\r\n  </ul>\r\n</nav>\r\n\r\n<div class=\"page\">\r\n  <div class=\"center\">\r\n\r\n    <div #canvasSection>\r\n      <canvas #canvas id=\"canvas\"  (mousemove)=\"onMouseMove($event)\" (click)=\"onClick()\"></canvas>\r\n    </div>\r\n\r\n    <div #Automatic>\r\n      <app-get-planned-route id=\"AutomaticSection\" style=\"display: none\" [networkChecker]=\"checkerNetworkPlanedRoutes\" (getRouteAndTruckEvent)=\"setAutomaticMovementRoutAndTruck(done,$event)\" ></app-get-planned-route>\r\n    </div>\r\n\r\n    <div #Manual>\r\n       <app-choose-truck-and-route id=\"ManualSection\" style=\"display: none\" (getRouteAndTruckEvent)=\"scrollDone(done,$event)\"></app-choose-truck-and-route>\r\n    </div>\r\n\r\n    <div  style=\"align-content: center\">\r\n      <!-- HTML !-->\r\n      <button #done id=\"ButtonDoneSection\" class=\"button-73\" role=\"button\" style=\"display: none\" (click)=\"scrollCanvas(canvasSection)\">Done</button>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}