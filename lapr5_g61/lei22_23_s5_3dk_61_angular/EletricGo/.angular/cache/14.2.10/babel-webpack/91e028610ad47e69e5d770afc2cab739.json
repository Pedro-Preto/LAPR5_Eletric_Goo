{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/pedro/OneDrive/Documentos/Eng.Informatica_Projects/3 Ano/lapr5_g61/lei22_23_s5_3dk_61_angular/EletricGo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport * as THREE from \"three\";\nimport TextSprite from \"@seregpie/three.text-sprite\";\nimport { Group, LineCurve3, MeshBasicMaterial, MeshStandardMaterial, Object3D, Vector3 } from 'three';\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/dotnet/warehouses.service\";\nimport * as i3 from \"../../services/node/routes.service\";\nimport * as i4 from \"../../services/node/truck.service\";\nimport * as i5 from \"../get-planned-route/get-planned-route.component\";\nconst _c0 = [\"canvas\"];\nexport class NetworkComponent {\n  constructor(route, warehousesService, routesService, trucksService) {\n    this.route = route;\n    this.warehousesService = warehousesService;\n    this.routesService = routesService;\n    this.trucksService = trucksService;\n    this.checkerNetworkTruck = 1;\n    this.checkerNetworkPlanedRoutes = 1; //* Stage Properties;\n\n    this.cameraZ = 400; //* Aproximação da câmara || Coordenada Z\n\n    this.fieldOfView = 5; //* Distância da câmara\n\n    this.nearClippingPlane = 1; //* Proximidade do plano\n\n    this.farClippingPlane = 30000; //* Afastamento do plano\n\n    this.warehouses = [];\n    this.routes = [];\n    this.trucks = [];\n    this.activeTrucks = [];\n    this.warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\n    this.warehouseBaseMaterial = new THREE.MeshLambertMaterial({\n      color: 0xffffff\n    });\n    this.activateMotion = 0;\n    this.isAutomaticMovement = 0;\n    this.pathsData = new Map([]);\n    this.pathsData_Warehouses = new Map();\n    this.currentDistance = 0;\n    this.speed = 0.2;\n    this.roadsData = new Map([]);\n    this.ambientSoundLoader = new THREE.AudioLoader();\n    this.ambientListener = new THREE.AudioListener();\n    this.ambientAudio = new THREE.Audio(this.ambientListener);\n    this.truckSoundLoader = new THREE.AudioLoader();\n    this.truckListener = new THREE.AudioListener();\n    this.truckAudio = new THREE.Audio(this.truckListener);\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.importLoaders();\n    this.warehousesService.getWarehouses().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (data) {\n        _this.warehouses = data;\n        console.log(_this.warehouses);\n\n        _this.routesService.getRoutes().subscribe( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (data) {\n            _this.routes = data;\n            console.log(_this.routes);\n\n            _this.trucksService.getTrucks().subscribe( /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator(function* (data) {\n                _this.trucks = data;\n                console.log(_this.trucks);\n                yield _this.createScene();\n                yield _this.startRenderingLoop();\n              });\n\n              return function (_x3) {\n                return _ref3.apply(this, arguments);\n              };\n            }());\n          });\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  ngAfterViewInit() {}\n\n  get canvas() {\n    return this.canvasRef.nativeElement;\n  } //tamanho da janela\n\n\n  static getAspectRatio() {\n    return window.innerWidth / window.innerHeight;\n  }\n\n  createScene() {\n    //* Scene\n    this.scene = new THREE.Scene(); //* Camera\n\n    this.camera = new THREE.PerspectiveCamera(this.fieldOfView, NetworkComponent.getAspectRatio(), this.nearClippingPlane, this.farClippingPlane); //fog\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\n\n    this.camera.position.z = this.cameraZ;\n    this.scene.add(this.camera); //sounds\n\n    this.camera.add(this.ambientListener);\n    this.camera.add(this.truckListener);\n    this.addSkybox();\n    this.addWarehouses();\n    this.addLights();\n  }\n\n  addSkybox() {\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000, 1000);\n    let skyboxMaterials = [new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshStandardMaterial({\n      map: this.skyBoxGroundTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    })];\n    let skybox = new THREE.Mesh(skyboxGeo, skyboxMaterials);\n    skybox.position.y = 400;\n    skybox.receiveShadow = true;\n    this.scene.add(skybox);\n  }\n\n  startRenderingLoop() {\n    //* Renderer\n    // Use canvas element in template\n    this.renderer = new THREE.WebGLRenderer({\n      canvas: this.canvas,\n      antialias: true\n    });\n    this.renderer.setPixelRatio(window.devicePixelRatio); //definir janela\n\n    this.renderer.setSize(window.innerWidth, window.innerHeight); //ShadowMap para permitir Sombras\n\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; //Orbit Controls\n\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\n    controls.maxDistance = 1500; //900 zoom out\n\n    controls.minDistance = 50; //100 zoom in\n\n    controls.minAzimuthAngle = -Math.PI; //Rotação D 90º\n\n    controls.maxAzimuthAngle = Math.PI; //Rotação E 90º\n\n    controls.maxPolarAngle = Math.PI / 2; //Rotação Eixo Y 90º\n    // controls.minPolarAngle=Math.PI/2\n\n    let component = this;\n\n    (function render() {\n      requestAnimationFrame(render); //Render truck Movement animation\n\n      component.manualMovement();\n      component.automaticMovement(); //janelade visualização\n\n      component.renderer.setViewport(-200, 0, window.innerWidth + 200, window.innerHeight);\n      component.renderer.setClearColor(0xCADFED, 1);\n      component.renderer.render(component.scene, component.camera);\n    })();\n  }\n\n  addWarehouses() {\n    for (let i = 0; i < this.warehouses.length; i++) {\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, this.warehouseBaseMaterial); //*Base da Warehouse\n\n      base.position.set(NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\n      base.name = this.warehouses[i].warehouseIdentifier;\n      base.castShadow = true;\n      base.receiveShadow = true; //Nomes cidades\n\n      let sprite = new TextSprite({\n        text: this.warehouses[i].designation,\n        alignment: 'left',\n        color: '#000000',\n        fontFamily: '\"Arial\", Times, serif',\n        fontStyle: 'italic'\n      });\n      sprite.position.set(base.position.x, base.position.y + 3.2, base.position.z);\n      this.scene.add(sprite);\n      let warehouse3D = this.warehouse3D.clone();\n      warehouse3D.name = this.warehouses[i].designation;\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\n      this.scene.add(warehouse3D);\n      this.scene.add(base);\n      this.warehouseBaseMaterial.map = this.roundaboutTexture;\n    }\n\n    this.addRoads();\n  }\n\n  addRoads() {\n    for (let i = 0; i < this.routes.length; i++) {\n      let ware0 = this.scene.getObjectByName(this.routes[i].departureId);\n      let ware1 = this.scene.getObjectByName(this.routes[i].arrivalId);\n\n      if (ware0 != null && ware1 != null) {\n        let teta0 = Math.atan2(-(ware1.position.z - ware0.position.z), ware1.position.x - ware0.position.x);\n        let teta1 = Math.PI + teta0;\n        let elemLigMaterial = new THREE.MeshLambertMaterial({\n          color: 0xffffff\n        });\n        elemLigMaterial.map = this.elemLigTexture;\n        let elemLigGeometry = new THREE.BoxGeometry(0.3, 0.20, 2);\n        let elemLig0Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig0Mesh.position.set(ware0.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta0), ware0.position.y, ware0.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta0));\n        elemLig0Mesh.rotateY(teta0);\n        elemLig0Mesh.castShadow = true;\n        elemLig0Mesh.receiveShadow = true;\n        this.scene.add(elemLig0Mesh);\n        let elemLig1Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig1Mesh.position.set(ware1.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta1), ware1.position.y, ware1.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta1));\n        elemLig1Mesh.rotateY(teta1);\n        elemLig1Mesh.castShadow = true;\n        elemLig1Mesh.receiveShadow = true;\n        this.scene.add(elemLig1Mesh);\n        let roadMaterial = new THREE.MeshLambertMaterial({\n          color: 0xffffff\n        });\n        roadMaterial.map = this.roadTexture;\n        let roadGeometry = new THREE.BoxGeometry(2, 0.20, Math.sqrt(Math.pow(elemLig0Mesh.position.x - elemLig1Mesh.position.x, 2) + Math.pow(elemLig0Mesh.position.y - elemLig1Mesh.position.y, 2) + Math.pow(elemLig0Mesh.position.z - elemLig1Mesh.position.z, 2)));\n        let roadMesh = new THREE.Mesh(roadGeometry, roadMaterial);\n        roadMesh.position.set((elemLig0Mesh.position.x + elemLig1Mesh.position.x) / 2, (elemLig0Mesh.position.y + elemLig1Mesh.position.y) / 2, (elemLig0Mesh.position.z + elemLig1Mesh.position.z) / 2);\n        roadMesh.castShadow = true;\n        roadMesh.receiveShadow = true;\n        this.scene.add(roadMesh);\n        let beta = Math.asin((elemLig0Mesh.position.y - elemLig1Mesh.position.y) / roadGeometry.parameters.depth);\n        let omega = teta0 + Math.PI / 2;\n        roadMesh.rotation.set(beta, omega, 0, \"ZYX\");\n        this.roadsData.set(this.routes[i].routeId, [teta0, teta1, elemLig0Mesh.position.x, elemLig0Mesh.position.y, elemLig0Mesh.position.z, elemLig1Mesh.position.x, elemLig1Mesh.position.y, elemLig1Mesh.position.z, roadMesh.position.x, roadMesh.position.y, roadMesh.position.z, beta, teta0 + Math.PI / 2]);\n      }\n    }\n  }\n\n  addLights() {\n    //*Light\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\n    this.scene.add(light_amb);\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directLight.castShadow = true;\n    this.camera.add(directLight);\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\n    spotLight.position.set(0, 500, 40);\n    spotLight.castShadow = true;\n    spotLight.target.position.set(0, 0, 40);\n    spotLight.shadow.mapSize.width = 2048;\n    spotLight.shadow.mapSize.height = 2048;\n    spotLight.shadow.camera.far = 1000;\n    this.scene.add(spotLight);\n    this.scene.add(spotLight.target);\n  }\n\n  addTruck(truckName) {\n    // @ts-ignore\n    const ware0 = this.scene.getObjectByName(this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE0]); // @ts-ignore\n\n    const ware1 = this.scene.getObjectByName(this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE1]);\n\n    if (ware0 != null && ware1 != null) {\n      const truck3D = this.truck3D.clone();\n      truck3D.name = truckName;\n      truck3D.position.set(ware0?.position.x, ware0.position.y, ware0.position.z + 2);\n      this.scene.add(truck3D);\n\n      if (this.isAutomaticMovement == 1) {\n        this.activeTrucks.push(this.scene.getObjectByName(truck3D.name));\n        this.isAutomaticMovement = 0;\n      }\n    }\n  }\n\n  setAutomaticMovementRoutAndTruck(el, map) {\n    map.forEach((value, key) => {\n      let path = new THREE.CurvePath();\n\n      for (let i = 0; i < value.length - 1; i++) {\n        let road = this.getRouteByWarehouses(value[i], value[i + 1]);\n        let wareDeparture = this.scene.getObjectByName(value[i]);\n        let warehouseArrival = this.scene.getObjectByName(value[i + 1]);\n        let roadData = this.roadsData.get(road?.routeId);\n\n        if (roadData != undefined) {\n          if (!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)) {\n            path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL0_X], roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z]))); //W0-EL0\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X], roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z]), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2))); //EL0-EL0_ROAD\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2), new Vector3(roadData[NetworkComponent.ROAD_X], roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z]))); //EL0-ROAD_ROAD\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X], roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z]), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2))); //ROAD-ROAD_EL1\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2), new Vector3(roadData[NetworkComponent.EL1_X], roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z]))); //ROAD_EL1_EL1\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X], roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z]), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z))); //WARE1\n          } else {\n            path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL1_X], roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z]))); //W0-EL0\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X], roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z]), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2))); //EL0-EL0_ROAD\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2), new Vector3(roadData[NetworkComponent.ROAD_X], roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z]))); //EL0-ROAD_ROAD\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X], roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z]), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2))); //ROAD-ROAD_EL1\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2), new Vector3(roadData[NetworkComponent.EL0_X], roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z]))); //ROAD_EL1_EL1\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X], roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z]), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z))); //WARE1\n          }\n        }\n      }\n\n      path.autoClose = true;\n      this.pathLength = path.getLength();\n      this.pathsData_Warehouses.set(key, [value[0], value[1], value[value.length - 1]]);\n      this.pathsData.set(key, path);\n      this.addTruck(key);\n    });\n    this.scrollDone(el);\n  }\n\n  startAutomaticMovement() {\n    //ativar o som do camião\n    this.truckAudio.play();\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x3 != null && z != null) {\n      if (x3.style.display === \"block\" && z.style.display === \"none\") {\n        z.style.display = \"block\";\n        x3.style.display = \"none\"; //ativar o movimento do camião\n\n        this.activateMotion = 1;\n      }\n    }\n  }\n\n  automaticMovement() {\n    //Automatic truck movement\n    if (this.activateMotion == 1 && this.activeTrucks.length != 0) {\n      for (let i = 0; i < this.activeTrucks.length; i++) {\n        // @ts-ignore\n        const wareDeparture = this.scene.getObjectByName(this.pathsData_Warehouses.get(this.activeTrucks[i].name)[NetworkComponent.WARE0]); // @ts-ignore\n\n        const wareArrival = this.scene.getObjectByName(this.pathsData_Warehouses.get(this.activeTrucks[i].name)[NetworkComponent.WARE_FINAL]);\n\n        if (wareDeparture != null && wareArrival != null) {\n          // @ts-ignore\n          let points = this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\n\n          if (points != undefined) {\n            this.activeTrucks[i]?.lookAt(points);\n            this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\n            this.currentDistance += this.speed;\n            console.log(\"Departure  : \" + wareDeparture?.position.x + \" \" + wareDeparture?.position.y + \" \" + wareDeparture?.position.z);\n            console.log(\"Arrival  : \" + wareArrival?.position.x + \" \" + wareArrival?.position.y + \" \" + wareArrival?.position.z);\n            console.log(\"=========================\");\n            console.log(\"Truck : \" + this.activeTrucks[i].name + \" -> \" + this.activeTrucks[i].position.x + \" \" + this.activeTrucks[i].position.y + \" \" + this.activeTrucks[i].position.z);\n            console.log(\"\\n\");\n\n            if (parseInt(Math.abs(wareArrival?.position.x).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.x).toFixed(2)) && parseInt(Math.abs(wareArrival?.position.y).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.y).toFixed(2)) && parseInt(Math.abs(wareArrival?.position.z).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.z).toFixed(2))) {\n              this.activateMotion = 0;\n              console.log(\"aquiiiiiiii\");\n              this.truckAudio.stop();\n              this.currentDistance = 0;\n              console.log(this.activeTrucks.length);\n              console.log(this.activeTrucks[i]);\n              console.log(\"removido da cena \" + this.scene.remove(this.activeTrucks[i]));\n              console.log(\"caminho removido \" + this.pathsData.delete(this.activeTrucks[i].name));\n              this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\n              console.log(this.activeTrucks);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  manualMovement() {\n    /*\r\n     document.onkeydown = function (e) {\r\n       switch (e.key) {\r\n         case \"a\":\r\n           //rodar a camara para a esquerda\r\n           truck?.position.set(truck?.position.x- 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n               case \"d\":\r\n           //rodar a camara para a direita\r\n           truck?.position.set(truck?.position.x+ 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n               case \"w\":\r\n           //avançar - incrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z- 0.1) ;\r\n           break;\r\n               case \"s\":\r\n           //recuar - decrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z+ 0.1) ;\r\n           break;\r\n               case \"p\":\r\n           //subir - incrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y+ 0.1,truck?.position.z) ;\r\n           break;\r\n               case \"l\":\r\n           //descer - decrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y- 0.1,truck?.position.z) ;\r\n           break;\r\n               default:break;\r\n       }\r\n             switch (e.keyCode){\r\n         case 39://right key\r\n           truck?.rotateY(5 * Math.PI / 180);\r\n           break;\r\n               case 37://lef key\r\n           truck?.rotateY(-5 * Math.PI / 180);\r\n           break;\r\n               case 38://up key\r\n           truck?.rotateX(-5 * Math.PI / 180);\r\n           break;\r\n               case 40://down key\r\n           truck?.rotateX(5 * Math.PI / 180);\r\n           break;\r\n               default:break;\r\n       }\r\n         }*/\n  }\n\n  static getCoordinates(lat, lon, alt) {\n    let coordinatesArr = [];\n    const min = -100;\n    const max = 100;\n    const med = max / 2;\n    coordinatesArr[0] = -((max - min) / (8.7613 - 8.2451) * (lon - 8.2451) + min);\n    coordinatesArr[1] = (med - -med) / (42.1115 - 40.8387) * (lat - 40.8387) + -med;\n    coordinatesArr[2] = max / 800 * alt;\n    parseInt(coordinatesArr[0].toFixed(4));\n    parseInt(coordinatesArr[1].toFixed(4));\n    parseInt(coordinatesArr[2].toFixed(4));\n    return coordinatesArr;\n  }\n\n  onClick() {}\n\n  onMouseMove(event) {}\n\n  importLoaders() {\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\n    this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', buffer => {\n      this.truckAudio.setBuffer(buffer);\n      this.truckAudio.setLoop(true);\n      this.truckAudio.setVolume(0.5);\n    });\n    this.skyBoxTexture = new THREE.TextureLoader().load('assets/network/sky.jpg');\n    this.skyBoxGroundTexture = new THREE.TextureLoader().load('assets/network/ground.jpg');\n    this.skyBoxGroundTexture.anisotropy = 16;\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.generateMipmaps = false;\n    this.skyBoxGroundTexture.needsUpdate = true;\n    const loaderWare = new GLTFLoader();\n    loaderWare.load('/assets/network/warehouse.glb', gltf => {\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.warehouse3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    const loaderTruck = new GLTFLoader();\n    loaderTruck.load('/assets/network/Truck.glb', gltf => {\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.truck3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    this.roundaboutTexture = new THREE.TextureLoader().load('assets/network/rotunda.jpg');\n    this.elemLigTexture = new THREE.TextureLoader().load('assets/network/road.jpg');\n    this.elemLigTexture.anisotropy = 16;\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\n    this.elemLigTexture.generateMipmaps = false;\n    this.elemLigTexture.needsUpdate = true;\n    this.roadTexture = new THREE.TextureLoader().load('assets/network/road1.jpg');\n    this.roadTexture.anisotropy = 16;\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.roadTexture.minFilter = THREE.LinearFilter;\n    this.roadTexture.magFilter = THREE.LinearFilter;\n    this.roadTexture.generateMipmaps = false;\n    this.roadTexture.needsUpdate = true;\n  } //Auxiliar Methods\n\n\n  getRouteByWarehouses(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return this.routes[i];\n      } else if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return this.routes[i];\n      }\n    }\n\n    return null;\n  }\n\n  isRegisteredFirstOnRoutObject(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return true;\n      } else if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return false;\n      }\n    }\n\n    return false;\n  }\n\n  makeDelivery() {\n    let x1 = document.getElementById(\"OptionManualDelivery\");\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x1 != null && x2 != null && z != null) {\n      if (x1.style.display === \"none\" && x2.style.display === \"none\") {\n        x1.style.display = \"block\";\n        x2.style.display = \"block\";\n        z.style.display = \"none\";\n      }\n    }\n  }\n\n  scrollAutomaticDelivery(el) {\n    this.isAutomaticMovement = 1;\n    let x = document.getElementById(\"AutomaticSection\");\n\n    if (x != null) {\n      x.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollDone(el) {\n    let done = document.getElementById(\"ButtonDoneSection\");\n\n    if (done != null) {\n      done.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollCanvas(el) {\n    let x1 = document.getElementById(\"OptionManualDelivery\");\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\n    let x5 = document.getElementById(\"AutomaticSection\");\n    let done = document.getElementById(\"ButtonDoneSection\");\n\n    if (x1 != null && x2 != null && x3 != null && x5 != null && done != null) {\n      if (x1.style.display === \"block\" && x2.style.display === \"block\") {\n        x1.style.display = \"none\";\n        x2.style.display = \"none\";\n        x3.style.display = \"block\";\n        x5.style.display = \"none\";\n        done.style.display = \"none\";\n      }\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n}\nNetworkComponent.WARE0 = 0;\nNetworkComponent.WARE1 = 1;\nNetworkComponent.WARE_FINAL = 2;\nNetworkComponent.TETA_0 = 0;\nNetworkComponent.TETA_1 = 1;\nNetworkComponent.EL0_X = 2;\nNetworkComponent.EL0_Y = 3;\nNetworkComponent.EL0_Z = 4;\nNetworkComponent.EL1_X = 5;\nNetworkComponent.EL1_Y = 6;\nNetworkComponent.EL1_Z = 7;\nNetworkComponent.ROAD_X = 8;\nNetworkComponent.ROAD_Y = 9;\nNetworkComponent.ROAD_Z = 10;\nNetworkComponent.BETA = 11;\nNetworkComponent.OMEGA = 12;\n\nNetworkComponent.ɵfac = function NetworkComponent_Factory(t) {\n  return new (t || NetworkComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.WarehousesService), i0.ɵɵdirectiveInject(i3.RoutesService), i0.ɵɵdirectiveInject(i4.TrucksService));\n};\n\nNetworkComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: NetworkComponent,\n  selectors: [[\"app-network\"]],\n  viewQuery: function NetworkComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n    }\n  },\n  inputs: {\n    cameraZ: \"cameraZ\",\n    fieldOfView: \"fieldOfView\",\n    nearClippingPlane: [\"nearClipping\", \"nearClippingPlane\"],\n    farClippingPlane: [\"farClipping\", \"farClippingPlane\"]\n  },\n  decls: 30,\n  vars: 1,\n  consts: [[\"id\", \"SectionNavbar\", 1, \"navbar\"], [\"href\", \"/views/login\"], [\"id\", \"OptionMakeDelivery\", 3, \"click\"], [\"id\", \"OptionManualDelivery\", 2, \"display\", \"none\"], [\"id\", \"OptionAutomaticDelivery\", 2, \"display\", \"none\"], [3, \"click\"], [\"id\", \"OptionStartAutomaticDelivery\", 2, \"display\", \"none\"], [1, \"page\"], [1, \"center\"], [\"canvasSection\", \"\"], [\"id\", \"canvas\", 3, \"mousemove\", \"click\"], [\"canvas\", \"\"], [\"listRoutesSection\", \"\"], [\"id\", \"AutomaticSection\", 2, \"display\", \"none\", 3, \"networkChecker\", \"getRouteAndTruckEvent\"], [2, \"align-content\", \"center\"], [\"done\", \"\"], [\"id\", \"ButtonDoneSection\", \"role\", \"button\", 1, \"button-73\", 2, \"display\", \"none\", 3, \"click\"]],\n  template: function NetworkComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r4 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"nav\", 0)(1, \"ul\")(2, \"li\")(3, \"a\", 1);\n      i0.ɵɵtext(4, \"Home\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"li\")(6, \"a\", 2);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_6_listener() {\n        return ctx.makeDelivery();\n      });\n      i0.ɵɵtext(7, \"Make Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"li\", 3)(9, \"a\");\n      i0.ɵɵtext(10, \"Manual Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"li\", 4)(12, \"a\", 5);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_12_listener() {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r2 = i0.ɵɵreference(24);\n\n        return i0.ɵɵresetView(ctx.scrollAutomaticDelivery(_r2));\n      });\n      i0.ɵɵtext(13, \"Automatic Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"li\", 6)(15, \"a\", 5);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_15_listener() {\n        return ctx.startAutomaticMovement();\n      });\n      i0.ɵɵtext(16, \"Start\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 7)(18, \"div\", 8)(19, \"div\", null, 9)(21, \"canvas\", 10, 11);\n      i0.ɵɵlistener(\"mousemove\", function NetworkComponent_Template_canvas_mousemove_21_listener($event) {\n        return ctx.onMouseMove($event);\n      })(\"click\", function NetworkComponent_Template_canvas_click_21_listener() {\n        return ctx.onClick();\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(23, \"div\", null, 12)(25, \"app-get-planned-route\", 13);\n      i0.ɵɵlistener(\"getRouteAndTruckEvent\", function NetworkComponent_Template_app_get_planned_route_getRouteAndTruckEvent_25_listener($event) {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r3 = i0.ɵɵreference(27);\n\n        return i0.ɵɵresetView(ctx.setAutomaticMovementRoutAndTruck(_r3, $event));\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"div\", 14, 15)(28, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_button_click_28_listener() {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r0 = i0.ɵɵreference(20);\n\n        return i0.ɵɵresetView(ctx.scrollCanvas(_r0));\n      });\n      i0.ɵɵtext(29, \"Done\");\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(25);\n      i0.ɵɵproperty(\"networkChecker\", ctx.checkerNetworkPlanedRoutes);\n    }\n  },\n  dependencies: [i5.GetPlannedRouteComponent],\n  styles: [\"*[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\nbody[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  font-family: \\\"Lato\\\", sans-serif;\\r\\n  background: #EFEEF4;\\r\\n  line-height: 1.6;\\r\\n  height: 100vh;\\r\\n  overflow: hidden;\\r\\n}\\r\\n\\r\\n.container[_ngcontent-%COMP%]{\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  overflow-y: scroll;\\r\\n  scroll-behavior: smooth;\\r\\n  scroll-snap-type: y mandatory;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]{\\r\\n  position: fixed;\\r\\n  top:0;\\r\\n  z-index: 1;\\r\\n  display: flex;\\r\\n  width: 100%;\\r\\n  height: 60px;\\r\\n  background: rgba(239,238,244,0.7);\\r\\n  font-weight: 700;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{\\r\\n  display: flex;\\r\\n  list-style: none;\\r\\n  width: 100%;\\r\\n  justify-content: center;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{\\r\\n  margin: 0 1rem;\\r\\n  padding: 1rem;\\r\\n  font-family: 'Secular One', sans-serif;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{\\r\\n  text-decoration: none;\\r\\n  text-transform: uppercase;\\r\\n\\r\\n  color: #778DB3;\\r\\n  font-size: 1.5rem;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{\\r\\n  color: skyblue;\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n.button-73[_ngcontent-%COMP%] {\\r\\n  -webkit-appearance: none;\\r\\n          appearance: none;\\r\\n  background-color: #FFFFFF;\\r\\n  border-radius: 40em;\\r\\n  border-style: none;\\r\\n  box-shadow: #ADCFFF 0 -12px 6px inset;\\r\\n  box-sizing: border-box;\\r\\n  color: #000000;\\r\\n  cursor: pointer;\\r\\n  display: inline-block;\\r\\n  font-family: -apple-system,sans-serif;\\r\\n  font-size: 1.2rem;\\r\\n  font-weight: 700;\\r\\n  letter-spacing: -.24px;\\r\\n  margin: 0;\\r\\n  outline: none;\\r\\n  padding: 1rem 1.3rem;\\r\\n  quotes: auto;\\r\\n  text-align: center;\\r\\n  text-decoration: none;\\r\\n  transition: all .15s;\\r\\n  user-select: none;\\r\\n  -webkit-user-select: none;\\r\\n  touch-action: manipulation;\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:hover {\\r\\n  background-color: #FFC229;\\r\\n  box-shadow: #FF6314 0 -6px 8px inset;\\r\\n  transform: scale(1.125);\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:active {\\r\\n  transform: scale(1.025);\\r\\n}\\r\\n\\r\\n@media (min-width: 768px) {\\r\\n  .button-73[_ngcontent-%COMP%] {\\r\\n    font-size: 1.5rem;\\r\\n    padding: .75rem 2rem;\\r\\n  }\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ldHdvcmsuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFNBQVM7RUFDVCxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxTQUFTO0VBQ1QsK0JBQStCO0VBQy9CLG1CQUFtQjtFQUNuQixnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHVCQUF1QjtFQUN2Qiw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsS0FBSztFQUNMLFVBQVU7RUFDVixhQUFhO0VBQ2IsV0FBVztFQUNYLFlBQVk7RUFDWixpQ0FBaUM7RUFDakMsZ0JBQWdCOztBQUVsQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxhQUFhO0VBQ2Isc0NBQXNDOztBQUV4Qzs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQix5QkFBeUI7O0VBRXpCLGNBQWM7RUFDZCxpQkFBaUI7O0FBRW5COztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFDQSxRQUFROztBQUNSO0VBQ0Usd0JBQWdCO1VBQWhCLGdCQUFnQjtFQUNoQix5QkFBeUI7RUFDekIsbUJBQW1CO0VBQ25CLGtCQUFrQjtFQUNsQixxQ0FBcUM7RUFDckMsc0JBQXNCO0VBQ3RCLGNBQWM7RUFDZCxlQUFlO0VBQ2YscUJBQXFCO0VBQ3JCLHFDQUFxQztFQUNyQyxpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLHNCQUFzQjtFQUN0QixTQUFTO0VBQ1QsYUFBYTtFQUNiLG9CQUFvQjtFQUNwQixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHFCQUFxQjtFQUNyQixvQkFBb0I7RUFDcEIsaUJBQWlCO0VBQ2pCLHlCQUF5QjtFQUN6QiwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsb0NBQW9DO0VBQ3BDLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFO0lBQ0UsaUJBQWlCO0lBQ2pCLG9CQUFvQjtFQUN0QjtBQUNGIiwiZmlsZSI6Im5ldHdvcmsuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIip7XHJcbiAgbWFyZ2luOiAwO1xyXG4gIHBhZGRpbmc6IDA7XHJcbn1cclxuXHJcbmJvZHl7XHJcbiAgbWFyZ2luOiAwO1xyXG4gIGZvbnQtZmFtaWx5OiBcIkxhdG9cIiwgc2Fucy1zZXJpZjtcclxuICBiYWNrZ3JvdW5kOiAjRUZFRUY0O1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjY7XHJcbiAgaGVpZ2h0OiAxMDB2aDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG59XHJcblxyXG4uY29udGFpbmVye1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGhlaWdodDogMTAwJTtcclxuICBvdmVyZmxvdy15OiBzY3JvbGw7XHJcbiAgc2Nyb2xsLWJlaGF2aW9yOiBzbW9vdGg7XHJcbiAgc2Nyb2xsLXNuYXAtdHlwZTogeSBtYW5kYXRvcnk7XHJcbn1cclxuXHJcbi5uYXZiYXJ7XHJcbiAgcG9zaXRpb246IGZpeGVkO1xyXG4gIHRvcDowO1xyXG4gIHotaW5kZXg6IDE7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICB3aWR0aDogMTAwJTtcclxuICBoZWlnaHQ6IDYwcHg7XHJcbiAgYmFja2dyb3VuZDogcmdiYSgyMzksMjM4LDI0NCwwLjcpO1xyXG4gIGZvbnQtd2VpZ2h0OiA3MDA7XHJcblxyXG59XHJcblxyXG4ubmF2YmFyIHVse1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgbGlzdC1zdHlsZTogbm9uZTtcclxuICB3aWR0aDogMTAwJTtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxufVxyXG5cclxuLm5hdmJhciB1bCBsaXtcclxuICBtYXJnaW46IDAgMXJlbTtcclxuICBwYWRkaW5nOiAxcmVtO1xyXG4gIGZvbnQtZmFtaWx5OiAnU2VjdWxhciBPbmUnLCBzYW5zLXNlcmlmO1xyXG5cclxufVxyXG5cclxuLm5hdmJhciB1bCBsaSBhe1xyXG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xyXG5cclxuICBjb2xvcjogIzc3OERCMztcclxuICBmb250LXNpemU6IDEuNXJlbTtcclxuXHJcbn1cclxuXHJcbi5uYXZiYXIgdWwgbGkgYTpob3ZlcntcclxuICBjb2xvcjogc2t5Ymx1ZTtcclxufVxyXG4vKiBDU1MgKi9cclxuLmJ1dHRvbi03MyB7XHJcbiAgYXBwZWFyYW5jZTogbm9uZTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRkZGO1xyXG4gIGJvcmRlci1yYWRpdXM6IDQwZW07XHJcbiAgYm9yZGVyLXN0eWxlOiBub25lO1xyXG4gIGJveC1zaGFkb3c6ICNBRENGRkYgMCAtMTJweCA2cHggaW5zZXQ7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBjb2xvcjogIzAwMDAwMDtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLHNhbnMtc2VyaWY7XHJcbiAgZm9udC1zaXplOiAxLjJyZW07XHJcbiAgZm9udC13ZWlnaHQ6IDcwMDtcclxuICBsZXR0ZXItc3BhY2luZzogLS4yNHB4O1xyXG4gIG1hcmdpbjogMDtcclxuICBvdXRsaW5lOiBub25lO1xyXG4gIHBhZGRpbmc6IDFyZW0gMS4zcmVtO1xyXG4gIHF1b3RlczogYXV0bztcclxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gIHRyYW5zaXRpb246IGFsbCAuMTVzO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG4gIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgdG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247XHJcbn1cclxuXHJcbi5idXR0b24tNzM6aG92ZXIge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNGRkMyMjk7XHJcbiAgYm94LXNoYWRvdzogI0ZGNjMxNCAwIC02cHggOHB4IGluc2V0O1xyXG4gIHRyYW5zZm9ybTogc2NhbGUoMS4xMjUpO1xyXG59XHJcblxyXG4uYnV0dG9uLTczOmFjdGl2ZSB7XHJcbiAgdHJhbnNmb3JtOiBzY2FsZSgxLjAyNSk7XHJcbn1cclxuXHJcbkBtZWRpYSAobWluLXdpZHRoOiA3NjhweCkge1xyXG4gIC5idXR0b24tNzMge1xyXG4gICAgZm9udC1zaXplOiAxLjVyZW07XHJcbiAgICBwYWRkaW5nOiAuNzVyZW0gMnJlbTtcclxuICB9XHJcbn1cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["ElementRef","THREE","TextSprite","Group","LineCurve3","MeshBasicMaterial","MeshStandardMaterial","Object3D","Vector3","OrbitControls","GLTFLoader","NetworkComponent","constructor","route","warehousesService","routesService","trucksService","CylinderGeometry","MeshLambertMaterial","color","Map","AudioLoader","AudioListener","Audio","ambientListener","truckListener","ngOnInit","importLoaders","getWarehouses","subscribe","data","warehouses","console","log","getRoutes","routes","getTrucks","trucks","createScene","startRenderingLoop","ngAfterViewInit","canvas","canvasRef","nativeElement","getAspectRatio","window","innerWidth","innerHeight","scene","Scene","camera","PerspectiveCamera","fieldOfView","nearClippingPlane","farClippingPlane","position","z","cameraZ","add","addSkybox","addWarehouses","addLights","skyboxGeo","BoxGeometry","skyboxMaterials","map","skyBoxTexture","side","BackSide","skyBoxGroundTexture","skybox","Mesh","y","receiveShadow","renderer","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","type","PCFSoftShadowMap","controls","domElement","maxDistance","minDistance","minAzimuthAngle","Math","PI","maxAzimuthAngle","maxPolarAngle","component","render","requestAnimationFrame","manualMovement","automaticMovement","setViewport","setClearColor","i","length","base","warehouseBaseGeometry","warehouseBaseMaterial","set","getCoordinates","latitude","longitude","warehouseAltitude","name","warehouseIdentifier","castShadow","sprite","text","designation","alignment","fontFamily","fontStyle","x","warehouse3D","clone","roundaboutTexture","addRoads","ware0","getObjectByName","departureId","ware1","arrivalId","teta0","atan2","teta1","elemLigMaterial","elemLigTexture","elemLigGeometry","elemLig0Mesh","parameters","radiusTop","cos","sin","rotateY","elemLig1Mesh","roadMaterial","roadTexture","roadGeometry","sqrt","pow","roadMesh","beta","asin","depth","omega","rotation","roadsData","routeId","light_amb","AmbientLight","directLight","DirectionalLight","spotLight","SpotLight","target","shadow","mapSize","width","height","far","addTruck","truckName","pathsData_Warehouses","get","WARE0","WARE1","truck3D","isAutomaticMovement","activeTrucks","push","setAutomaticMovementRoutAndTruck","el","forEach","value","key","path","CurvePath","road","getRouteByWarehouses","wareDeparture","warehouseArrival","roadData","undefined","isRegisteredFirstOnRoutObject","EL0_X","EL0_Y","EL0_Z","ROAD_X","ROAD_Y","ROAD_Z","EL1_X","EL1_Y","EL1_Z","autoClose","pathLength","getLength","pathsData","scrollDone","startAutomaticMovement","truckAudio","play","x3","document","getElementById","style","display","activateMotion","wareArrival","WARE_FINAL","points","getPoint","currentDistance","lookAt","speed","parseInt","abs","toFixed","stop","remove","delete","filter","obj","lat","lon","alt","coordinatesArr","min","max","med","onClick","onMouseMove","event","truckSoundLoader","load","buffer","setBuffer","setLoop","setVolume","TextureLoader","anisotropy","wrapS","wrapT","MirroredRepeatWrapping","minFilter","LinearFilter","magFilter","generateMipmaps","needsUpdate","loaderWare","gltf","scale","error","loaderTruck","ware1Identifier","ware2Identifier","makeDelivery","x1","x2","scrollAutomaticDelivery","scrollIntoView","behavior","done","scrollCanvas","x5","i0","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.ts","C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.html"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport * as THREE from \"three\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport TextSprite from \"@seregpie/three.text-sprite\";\r\nimport {CatmullRomCurve3, Group, LineCurve3, MeshBasicMaterial, MeshStandardMaterial, Object3D, Vector3} from 'three';\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport { GLTFLoader} from \"three/examples/jsm/loaders/GLTFLoader\";\r\nimport {WarehousesService} from \"../../services/dotnet/warehouses.service\";\r\nimport {RoutesService} from \"../../services/node/routes.service\";\r\nimport {TrucksService} from \"../../services/node/truck.service\";\r\nimport * as net from \"net\";\r\n\r\n@Component({\r\n  selector: 'app-network',\r\n  templateUrl: './network.component.html',\r\n  styleUrls: ['./network.component.css']\r\n})\r\nexport class NetworkComponent implements OnInit, AfterViewInit {\r\n\r\n  public checkerNetworkTruck:number=1\r\n  public checkerNetworkPlanedRoutes:number=1\r\n\r\n  //tipo do canvas\r\n  @ViewChild('canvas')\r\n  private canvasRef: ElementRef;\r\n\r\n  //* Stage Properties;\r\n  @Input() public cameraZ: number = 400; //* Aproximação da câmara || Coordenada Z\r\n  @Input() public fieldOfView: number = 5;  //* Distância da câmara\r\n  @Input('nearClipping') public nearClippingPlane: number = 1;//* Proximidade do plano\r\n  @Input('farClipping') public farClippingPlane: number = 30000;//* Afastamento do plano\r\n\r\n\r\n  private renderer!: THREE.WebGLRenderer;\r\n  private scene!: THREE.Scene;\r\n  private camera!: THREE.PerspectiveCamera;\r\n\r\n  private warehouses:any[]=[];\r\n  private routes:Route[]=[];\r\n  private trucks:Truck[]=[];\r\n  private activeTrucks:Object3D[]=[];\r\n\r\n  private skyBoxTexture:THREE.Texture;\r\n  private skyBoxGroundTexture:THREE.Texture;\r\n\r\n  private warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\r\n  private warehouseBaseMaterial = new THREE.MeshLambertMaterial({ color: 0xffffff });\r\n  private warehouse3D: Group;\r\n  private roundaboutTexture: THREE.Texture ;\r\n  private elemLigTexture: THREE.Texture ;\r\n  private roadTexture:THREE.Texture;\r\n  private truck3D:Group;\r\n\r\n  private activateMotion=0;\r\n  private isAutomaticMovement=0;\r\n\r\n  private pathsData = new Map<string, THREE.CurvePath<any>>([]);\r\n  private pathsData_Warehouses=new Map<string,string[]>();\r\n  private static WARE0=0;  private static WARE1=1;private static WARE_FINAL=2;\r\n\r\n  private pathLength:number;\r\n  private currentDistance = 0;\r\n  private speed = 0.2;\r\n\r\n  private roadsData = new Map<string, number[]>([]);\r\n  private static TETA_0=0;private static TETA_1=1;\r\n  private static EL0_X=2;private static EL0_Y=3;private static EL0_Z=4;\r\n  private static EL1_X=5;private static EL1_Y=6;private static EL1_Z=7;\r\n  private static ROAD_X=8;private static ROAD_Y=9;private static ROAD_Z=10;\r\n  private static BETA=11;private static OMEGA=12;\r\n\r\n  private ambientSoundLoader = new THREE.AudioLoader();\r\n  private ambientListener=new THREE.AudioListener();\r\n  private ambientAudio=new THREE.Audio(this.ambientListener);\r\n\r\n  private truckSoundLoader = new THREE.AudioLoader();\r\n  private truckListener=new THREE.AudioListener();\r\n  private truckAudio=new THREE.Audio(this.truckListener);\r\n\r\n  constructor(private route: ActivatedRoute,private  warehousesService:WarehousesService, private routesService:RoutesService,private trucksService:TrucksService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.importLoaders();\r\n\r\n    this.warehousesService.getWarehouses().subscribe(async data=>{\r\n      this.warehouses=data;\r\n      console.log(this.warehouses)\r\n\r\n      this.routesService.getRoutes().subscribe(async data=>{\r\n        this.routes=data;\r\n        console.log(this.routes)\r\n\r\n        this.trucksService.getTrucks().subscribe(async data=>{\r\n          this.trucks=data;\r\n          console.log(this.trucks)\r\n          await this.createScene();\r\n          await this.startRenderingLoop();\r\n        })\r\n      })\r\n    })\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n  }\r\n\r\n  private get canvas(): HTMLCanvasElement {\r\n    return this.canvasRef.nativeElement;\r\n  }\r\n\r\n  //tamanho da janela\r\n  private static getAspectRatio() {\r\n    return window.innerWidth/ window.innerHeight;\r\n  }\r\n\r\n  private createScene() {\r\n\r\n    //* Scene\r\n    this.scene = new THREE.Scene();\r\n\r\n    //* Camera\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      this.fieldOfView,\r\n      NetworkComponent.getAspectRatio(),\r\n      this.nearClippingPlane,\r\n      this.farClippingPlane\r\n    );\r\n    //fog\r\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\r\n\r\n    this.camera.position.z = this.cameraZ;\r\n    this.scene.add(this.camera);\r\n\r\n    //sounds\r\n    this.camera.add( this.ambientListener);\r\n    this.camera.add(this.truckListener);\r\n\r\n    this.addSkybox();\r\n    this.addWarehouses()\r\n    this.addLights()\r\n  }\r\n\r\n\r\n  private addSkybox(){\r\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000,1000);\r\n    let skyboxMaterials= [\r\n      new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}),\r\n      new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}),\r\n      new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}),\r\n      new MeshStandardMaterial({map:this.skyBoxGroundTexture,side:THREE.BackSide}),\r\n      new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}),\r\n      new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide})\r\n    ];\r\n\r\n    let skybox = new THREE.Mesh(skyboxGeo,skyboxMaterials);\r\n    skybox.position.y=400;\r\n    skybox.receiveShadow=true;\r\n    this.scene.add(skybox);\r\n  }\r\n\r\n  private startRenderingLoop() {\r\n    //* Renderer\r\n    // Use canvas element in template\r\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n    //definir janela\r\n    this.renderer.setSize(window.innerWidth,window.innerHeight);\r\n\r\n    //ShadowMap para permitir Sombras\r\n    this.renderer.shadowMap.enabled = true;\r\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n    //Orbit Controls\r\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\r\n\r\n    controls.maxDistance = 1500;//900 zoom out\r\n    controls.minDistance = 50;//100 zoom in\r\n    controls.minAzimuthAngle = -Math.PI ;//Rotação D 90º\r\n    controls.maxAzimuthAngle = Math.PI ;//Rotação E 90º\r\n    controls.maxPolarAngle = Math.PI/2 //Rotação Eixo Y 90º\r\n    // controls.minPolarAngle=Math.PI/2\r\n\r\n    let component: NetworkComponent = this;\r\n    (function render() {\r\n      requestAnimationFrame(render);\r\n\r\n\r\n      //Render truck Movement animation\r\n      component.manualMovement();\r\n\r\n      component.automaticMovement();\r\n\r\n\r\n      //janelade visualização\r\n      component.renderer.setViewport(-200, 0, window.innerWidth+200, window.innerHeight);\r\n      component.renderer.setClearColor(0xCADFED, 1);\r\n      component.renderer.render(component.scene, component.camera);\r\n\r\n    }());\r\n  }\r\n\r\n  private addWarehouses(){\r\n    for (let i = 0; i < this.warehouses.length; i++)\r\n    {\r\n\r\n\r\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, this.warehouseBaseMaterial);//*Base da Warehouse\r\n\r\n      base.position.set(\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\r\n\r\n      base.name=this.warehouses[i].warehouseIdentifier;\r\n      base.castShadow=true;\r\n      base.receiveShadow=true;\r\n\r\n      //Nomes cidades\r\n      let sprite=new TextSprite({ text: this.warehouses[i].designation,alignment: 'left',\r\n        color: '#000000',\r\n        fontFamily: '\"Arial\", Times, serif',\r\n        fontStyle: 'italic',});\r\n      sprite.position.set(base.position.x,base.position.y+3.2,base.position.z);\r\n      this.scene.add(sprite)\r\n\r\n      let warehouse3D=this.warehouse3D.clone();\r\n      warehouse3D.name = this.warehouses[i].designation;\r\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\r\n      this.scene.add(warehouse3D);\r\n\r\n      this.scene.add(base);\r\n      this.warehouseBaseMaterial.map = this.roundaboutTexture;\r\n    }\r\n    this.addRoads();\r\n  }\r\n\r\n  private addRoads() {\r\n\r\n    for (let i = 0; i < this.routes.length; i++) {\r\n      let ware0 = <Object3D>this.scene.getObjectByName((this.routes[i].departureId));\r\n      let ware1 = <Object3D>this.scene.getObjectByName((this.routes[i].arrivalId));\r\n\r\n      if(ware0!=null&&ware1!=null){\r\n        let teta0=Math.atan2(-(ware1.position.z-ware0.position.z),ware1.position.x-ware0.position.x);\r\n        let teta1=Math.PI+teta0;\r\n\r\n        let elemLigMaterial = new THREE.MeshLambertMaterial({color: 0xffffff});\r\n        elemLigMaterial.map= this.elemLigTexture;\r\n        let elemLigGeometry =new THREE.BoxGeometry(0.3, 0.20, 2);\r\n\r\n        let elemLig0Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig0Mesh.position.set(ware0.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta0),ware0.position.y,ware0.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta0));\r\n        elemLig0Mesh.rotateY(teta0)\r\n        elemLig0Mesh.castShadow=true;\r\n        elemLig0Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig0Mesh)\r\n\r\n\r\n        let elemLig1Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig1Mesh.position.set(ware1.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta1),ware1.position.y,ware1.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta1));\r\n        elemLig1Mesh.rotateY(teta1)\r\n        elemLig1Mesh.castShadow=true;\r\n        elemLig1Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig1Mesh)\r\n\r\n        let roadMaterial = new THREE.MeshLambertMaterial({color: 0xffffff});\r\n        roadMaterial.map= this.roadTexture;\r\n\r\n        let roadGeometry =new THREE.BoxGeometry(2, 0.20,  Math.sqrt(Math.pow(elemLig0Mesh.position.x-elemLig1Mesh.position.x,2)+Math.pow(elemLig0Mesh.position.y-elemLig1Mesh.position.y,2)+Math.pow(elemLig0Mesh.position.z-elemLig1Mesh.position.z,2)));\r\n        let roadMesh=new THREE.Mesh(roadGeometry,roadMaterial);\r\n        roadMesh.position.set((elemLig0Mesh.position.x+elemLig1Mesh.position.x)/2,(elemLig0Mesh.position.y+elemLig1Mesh.position.y)/2,(elemLig0Mesh.position.z+elemLig1Mesh.position.z)/2);\r\n        roadMesh.castShadow=true;\r\n        roadMesh.receiveShadow=true;\r\n        this.scene.add(roadMesh)\r\n\r\n        let beta =Math.asin((elemLig0Mesh.position.y-elemLig1Mesh.position.y)/roadGeometry.parameters.depth);\r\n\r\n        let omega=teta0+Math.PI/2;\r\n        roadMesh.rotation.set(beta,omega,0, \"ZYX\")\r\n\r\n        this.roadsData.set(this.routes[i].routeId,[teta0,teta1,elemLig0Mesh.position.x,elemLig0Mesh.position.y,elemLig0Mesh.position.z,elemLig1Mesh.position.x,elemLig1Mesh.position.y,elemLig1Mesh.position.z,roadMesh.position.x,roadMesh.position.y,roadMesh.position.z,beta,(teta0+Math.PI/2)])\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  private addLights(){\r\n    //*Light\r\n\r\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\r\n    this.scene.add(light_amb);\r\n\r\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    directLight.castShadow=true;\r\n    this.camera.add(directLight);\r\n\r\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\r\n    spotLight.position.set(0, 500, 40);\r\n    spotLight.castShadow=true;\r\n    spotLight.target.position.set(0,0,40);\r\n    spotLight.shadow.mapSize.width = 2048;\r\n    spotLight.shadow.mapSize.height = 2048;\r\n    spotLight.shadow.camera.far =1000;\r\n    this.scene.add(spotLight);\r\n    this.scene.add(spotLight.target);\r\n  }\r\n\r\n\r\n  private addTruck(truckName:string){\r\n\r\n    // @ts-ignore\r\n    const ware0 =  this.scene.getObjectByName( this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE0]);\r\n    // @ts-ignore\r\n    const ware1 =  this.scene.getObjectByName( this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE1]);\r\n\r\n\r\n    if(ware0!=null&&ware1!=null){\r\n      const truck3D = this.truck3D.clone();\r\n      truck3D.name = truckName;\r\n      truck3D.position.set(ware0?.position.x, ware0.position.y, ware0.position.z+2);\r\n      this.scene.add(truck3D);\r\n\r\n        if(this.isAutomaticMovement==1){\r\n          this.activeTrucks.push(<Object3D<Event>>this.scene.getObjectByName(truck3D.name))\r\n          this.isAutomaticMovement=0;\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  public setAutomaticMovementRoutAndTruck(el:HTMLElement,map:Map<string,string[]>){\r\n    map.forEach((value, key) => {\r\n      let path = new THREE.CurvePath();\r\n\r\n\r\n      for(let i=0;i<value.length-1;i++){\r\n        let road=this.getRouteByWarehouses(value[i],value[i+1]);\r\n\r\n        let wareDeparture = this.scene.getObjectByName(value[i]);\r\n        let warehouseArrival= this.scene.getObjectByName(value[i+1])\r\n\r\n        let roadData=this.roadsData.get(<string>road?.routeId);\r\n\r\n        if(roadData!=undefined){\r\n         if(!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)){\r\n           path.add(new LineCurve3(new Vector3(wareDeparture?.position.x,wareDeparture?.position.y,wareDeparture?.position.z),new Vector3(roadData[NetworkComponent.EL0_X],roadData[NetworkComponent.EL0_Y],roadData[NetworkComponent.EL0_Z])));//W0-EL0\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X],roadData[NetworkComponent.EL0_Y],roadData[NetworkComponent.EL0_Z]),new Vector3((roadData[NetworkComponent.EL0_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL0_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL0_Z]+roadData[NetworkComponent.ROAD_Z])/2)));//EL0-EL0_ROAD\r\n           path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL0_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL0_Z]+roadData[NetworkComponent.ROAD_Z])/2),new Vector3(roadData[NetworkComponent.ROAD_X],roadData[NetworkComponent.ROAD_Y],roadData[NetworkComponent.ROAD_Z])));//EL0-ROAD_ROAD\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X],roadData[NetworkComponent.ROAD_Y],roadData[NetworkComponent.ROAD_Z]),new Vector3((roadData[NetworkComponent.EL1_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL1_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL1_Z]+roadData[NetworkComponent.ROAD_Z])/2)));//ROAD-ROAD_EL1\r\n           path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL1_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL1_Z]+roadData[NetworkComponent.ROAD_Z])/2),new Vector3(roadData[NetworkComponent.EL1_X],roadData[NetworkComponent.EL1_Y],roadData[NetworkComponent.EL1_Z])));//ROAD_EL1_EL1\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X],roadData[NetworkComponent.EL1_Y],roadData[NetworkComponent.EL1_Z]),new Vector3(warehouseArrival?.position.x,warehouseArrival?.position.y,warehouseArrival?.position.z)));//WARE1\r\n         }else{\r\n           path.add(new LineCurve3(new Vector3(wareDeparture?.position.x,wareDeparture?.position.y,wareDeparture?.position.z),new Vector3(roadData[NetworkComponent.EL1_X],roadData[NetworkComponent.EL1_Y],roadData[NetworkComponent.EL1_Z])));//W0-EL0\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X],roadData[NetworkComponent.EL1_Y],roadData[NetworkComponent.EL1_Z]),new Vector3((roadData[NetworkComponent.EL1_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL1_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL1_Z]+roadData[NetworkComponent.ROAD_Z])/2)));//EL0-EL0_ROAD\r\n           path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL1_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL1_Z]+roadData[NetworkComponent.ROAD_Z])/2),new Vector3(roadData[NetworkComponent.ROAD_X],roadData[NetworkComponent.ROAD_Y],roadData[NetworkComponent.ROAD_Z])));//EL0-ROAD_ROAD\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X],roadData[NetworkComponent.ROAD_Y],roadData[NetworkComponent.ROAD_Z]),new Vector3((roadData[NetworkComponent.EL0_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL0_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL0_Z]+roadData[NetworkComponent.ROAD_Z])/2)));//ROAD-ROAD_EL1\r\n           path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X]+roadData[NetworkComponent.ROAD_X])/2,(roadData[NetworkComponent.EL0_Y]+roadData[NetworkComponent.ROAD_Y])/2,(roadData[NetworkComponent.EL0_Z]+roadData[NetworkComponent.ROAD_Z])/2),new Vector3(roadData[NetworkComponent.EL0_X],roadData[NetworkComponent.EL0_Y],roadData[NetworkComponent.EL0_Z])));//ROAD_EL1_EL1\r\n           path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X],roadData[NetworkComponent.EL0_Y],roadData[NetworkComponent.EL0_Z]),new Vector3(warehouseArrival?.position.x,warehouseArrival?.position.y,warehouseArrival?.position.z)));//WARE1\r\n\r\n         }\r\n        }\r\n      }\r\n      path.autoClose=true;\r\n      this.pathLength=path.getLength();\r\n      this.pathsData_Warehouses.set(key,[value[0],value[1],value[value.length-1]]);\r\n      this.pathsData.set(key,path);\r\n      this.addTruck(key)\r\n\r\n    });\r\n\r\n    this.scrollDone(el);\r\n  }\r\n\r\n  public startAutomaticMovement(){\r\n    //ativar o som do camião\r\n    this.truckAudio.play();\r\n\r\n    let x3=document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x3!=null && z!=null) {\r\n      if (x3.style.display === \"block\" &&z.style.display === \"none\") {\r\n        z.style.display = \"block\";\r\n        x3.style.display = \"none\";\r\n\r\n        //ativar o movimento do camião\r\n        this.activateMotion=1;\r\n      }\r\n    }\r\n  }\r\n\r\n  private automaticMovement() {\r\n    //Automatic truck movement\r\n\r\n    if (this.activateMotion == 1 && this.activeTrucks.length!=0) {\r\n      for(let i=0;i<this.activeTrucks.length;i++){\r\n\r\n        // @ts-ignore\r\n        const wareDeparture = this.scene.getObjectByName( this.pathsData_Warehouses.get(this.activeTrucks[i].name)[NetworkComponent.WARE0]);\r\n        // @ts-ignore\r\n        const wareArrival = this.scene.getObjectByName(this.pathsData_Warehouses.get(this.activeTrucks[i].name)[NetworkComponent.WARE_FINAL]);\r\n\r\n        if(wareDeparture!=null&&wareArrival!=null){\r\n\r\n\r\n            // @ts-ignore\r\n            let points =this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\r\n\r\n            if (points!=undefined) {\r\n\r\n              this.activeTrucks[i]?.lookAt(points);\r\n              this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\r\n              this.currentDistance += this.speed;\r\n\r\n\r\n              console.log(\"Departure  : \" + wareDeparture?.position.x + \" \" + wareDeparture?.position.y + \" \" + wareDeparture?.position.z)\r\n              console.log(\"Arrival  : \" + wareArrival?.position.x + \" \" + wareArrival?.position.y + \" \" + wareArrival?.position.z)\r\n              console.log(\"=========================\")\r\n              console.log(\"Truck : \"+this.activeTrucks[i].name +\" -> \"+ this.activeTrucks[i].position.x + \" \" + this.activeTrucks[i].position.y + \" \" + this.activeTrucks[i].position.z)\r\n              console.log(\"\\n\")\r\n\r\n              if (parseInt(Math.abs(wareArrival?.position.x).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.x).toFixed(2)) && parseInt(Math.abs(wareArrival?.position.y).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.y).toFixed(2)) && parseInt(Math.abs(wareArrival?.position.z).toFixed(2)) == parseInt(Math.abs(this.activeTrucks[i]?.position.z).toFixed(2))) {\r\n                this.activateMotion = 0;\r\n                console.log(\"aquiiiiiiii\")\r\n                this.truckAudio.stop();\r\n                this.currentDistance=0;\r\n                console.log(this.activeTrucks.length)\r\n\r\n                console.log(this.activeTrucks[i])\r\n                console.log(\"removido da cena \"+  this.scene.remove(this.activeTrucks[i]))\r\n                console.log(\"caminho removido \"+ this.pathsData.delete(this.activeTrucks[i].name));\r\n                this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\r\n              console.log(this.activeTrucks)\r\n\r\n              }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  private manualMovement(){\r\n    /*\r\n     document.onkeydown = function (e) {\r\n       switch (e.key) {\r\n         case \"a\":\r\n           //rodar a camara para a esquerda\r\n           truck?.position.set(truck?.position.x- 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"d\":\r\n           //rodar a camara para a direita\r\n           truck?.position.set(truck?.position.x+ 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"w\":\r\n           //avançar - incrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z- 0.1) ;\r\n           break;\r\n\r\n         case \"s\":\r\n           //recuar - decrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z+ 0.1) ;\r\n           break;\r\n\r\n         case \"p\":\r\n           //subir - incrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y+ 0.1,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"l\":\r\n           //descer - decrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y- 0.1,truck?.position.z) ;\r\n           break;\r\n\r\n         default:break;\r\n       }\r\n\r\n       switch (e.keyCode){\r\n         case 39://right key\r\n           truck?.rotateY(5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 37://lef key\r\n           truck?.rotateY(-5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 38://up key\r\n           truck?.rotateX(-5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 40://down key\r\n           truck?.rotateX(5 * Math.PI / 180);\r\n           break;\r\n\r\n         default:break;\r\n       }\r\n\r\n   }*/\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  private static getCoordinates(lat:number, lon:number, alt: number):any {\r\n    let coordinatesArr: number[]=[];\r\n    const min=-100;\r\n    const max=100;\r\n    const med=max/2;\r\n\r\n    coordinatesArr[0]=-(((max-(min))/(8.7613-8.2451))*(lon-8.2451)+(min));\r\n    coordinatesArr[1]=((((med-(-med))/(42.1115-40.8387))*(lat-40.8387)+(-med)));\r\n    coordinatesArr[2]=((((max / 800) * alt)));\r\n    parseInt( coordinatesArr[0].toFixed(4));\r\n    parseInt( coordinatesArr[1].toFixed(4));\r\n    parseInt( coordinatesArr[2].toFixed(4));\r\n\r\n    return coordinatesArr;\r\n  }\r\n\r\n\r\n  onClick() {\r\n\r\n  }\r\n\r\n  onMouseMove(event: MouseEvent) {\r\n\r\n  }\r\n\r\n  public importLoaders(){\r\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\r\n\r\n    this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', (buffer) => {\r\n       this.truckAudio.setBuffer( buffer );\r\n       this.truckAudio.setLoop( true );\r\n       this.truckAudio.setVolume( 0.5 );\r\n     });\r\n\r\n    this.skyBoxTexture=new THREE.TextureLoader().load('assets/network/sky.jpg');\r\n\r\n    this.skyBoxGroundTexture=new THREE.TextureLoader().load('assets/network/ground.jpg');\r\n    this.skyBoxGroundTexture.anisotropy = 16;\r\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.generateMipmaps = false;\r\n    this.skyBoxGroundTexture.needsUpdate = true;\r\n\r\n    const loaderWare = new GLTFLoader();\r\n    loaderWare.load('/assets/network/warehouse.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.warehouse3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    const loaderTruck = new GLTFLoader();\r\n    loaderTruck.load('/assets/network/Truck.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.truck3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    this.roundaboutTexture=new THREE.TextureLoader().load('assets/network/rotunda.jpg')\r\n\r\n    this.elemLigTexture=new THREE.TextureLoader().load('assets/network/road.jpg')\r\n    this.elemLigTexture.anisotropy = 16;\r\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.generateMipmaps = false;\r\n    this.elemLigTexture.needsUpdate = true;\r\n\r\n    this.roadTexture=new THREE.TextureLoader().load('assets/network/road1.jpg')\r\n    this.roadTexture.anisotropy = 16;\r\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.roadTexture.minFilter = THREE.LinearFilter;\r\n    this.roadTexture.magFilter = THREE.LinearFilter;\r\n    this.roadTexture.generateMipmaps = false;\r\n    this.roadTexture.needsUpdate = true;\r\n  }\r\n\r\n\r\n  //Auxiliar Methods\r\n  public getRouteByWarehouses(ware1Identifier:any,ware2Identifier:any):Route | null{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return this.routes[i];\r\n      }else if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return this.routes[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  public isRegisteredFirstOnRoutObject(ware1Identifier:any,ware2Identifier:any):boolean{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return true;\r\n      }else if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public makeDelivery() {//bloquear o make delivery e mostrar as opcoes de automatic ou manual movement\r\n    let x1 = document.getElementById(\"OptionManualDelivery\");\r\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\r\n\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x1!=null && x2!=null&&z!=null) {\r\n      if (x1.style.display === \"none\" &&x2.style.display === \"none\") {\r\n        x1.style.display = \"block\";\r\n        x2.style.display = \"block\";\r\n        z.style.display=\"none\"\r\n      }\r\n    }\r\n  }\r\n\r\n  public scrollAutomaticDelivery(el: HTMLElement) {\r\n    this.isAutomaticMovement=1;\r\n    let x=document.getElementById(\"AutomaticSection\");\r\n    if(x!=null){\r\n      x.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n\r\n  public scrollDone(el: HTMLElement){\r\n    let done=document.getElementById(\"ButtonDoneSection\")\r\n    if(done!=null){\r\n      done.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n  }\r\n\r\n  public scrollCanvas(el: HTMLElement) {\r\n    let x1 = document.getElementById(\"OptionManualDelivery\");\r\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\r\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    let x5=document.getElementById(\"AutomaticSection\");\r\n    let done=document.getElementById(\"ButtonDoneSection\")\r\n\r\n    if (x1!=null && x2!=null&&x3!=null&&x5!=null&&done!=null) {\r\n      if (x1.style.display === \"block\" &&x2.style.display === \"block\") {\r\n        x1.style.display = \"none\";\r\n        x2.style.display = \"none\";\r\n        x3.style.display=\"block\"\r\n        x5.style.display=\"none\"\r\n        done.style.display=\"none\";\r\n      }\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n","\r\n<nav class=\"navbar\" id=\"SectionNavbar\">\r\n    <ul>\r\n      <li >\r\n        <a href=\"/views/login\">Home</a>\r\n      </li>\r\n      <li >\r\n          <a id=\"OptionMakeDelivery\" (click)=\"makeDelivery()\">Make Delivery</a>\r\n      </li>\r\n\r\n       <li id=\"OptionManualDelivery\" style=\"display: none\"> <a>Manual Delivery</a></li>\r\n      <li id=\"OptionAutomaticDelivery\" style=\"display: none\"> <a (click)=\"scrollAutomaticDelivery(listRoutesSection)\">Automatic Delivery</a></li>\r\n      <li id=\"OptionStartAutomaticDelivery\" style=\"display: none\"> <a (click)=\"startAutomaticMovement()\">Start</a></li>\r\n    </ul>\r\n  </nav>\r\n\r\n  <div class=\"page\">\r\n    <div class=\"center\">\r\n\r\n      <div #canvasSection>\r\n        <canvas #canvas id=\"canvas\"  (mousemove)=\"onMouseMove($event)\" (click)=\"onClick()\"></canvas>\r\n      </div>\r\n\r\n      <div #listRoutesSection>\r\n        <app-get-planned-route id=\"AutomaticSection\" style=\"display: none\" [networkChecker]=\"checkerNetworkPlanedRoutes\" (getRouteAndTruckEvent)=\"setAutomaticMovementRoutAndTruck(done,$event)\" ></app-get-planned-route>\r\n      </div>\r\n      <div #done style=\"align-content: center\">\r\n        <!-- HTML !-->\r\n        <button id=\"ButtonDoneSection\" class=\"button-73\" role=\"button\" style=\"display: none\" (click)=\"scrollCanvas(canvasSection)\">Done</button>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}