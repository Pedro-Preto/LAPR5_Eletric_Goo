{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/pedro/OneDrive/Documentos/Eng.Informatica_Projects/3 Ano/lapr5_g61/lei22_23_s5_3dk_61_angular/EletricGo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport * as THREE from \"three\";\nimport TextSprite from \"@seregpie/three.text-sprite\";\nimport { BoxGeometry, LineCurve3, Mesh, MeshBasicMaterial, MeshStandardMaterial, Vector3 } from 'three';\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/dotnet/warehouses.service\";\nimport * as i3 from \"../../services/node/routes.service\";\nimport * as i4 from \"../../services/node/truck.service\";\nimport * as i5 from \"../get-planned-route/get-planned-route.component\";\nconst _c0 = [\"canvas\"];\nexport class NetworkComponent {\n  constructor(route, warehousesService, routesService, trucksService) {\n    this.route = route;\n    this.warehousesService = warehousesService;\n    this.routesService = routesService;\n    this.trucksService = trucksService; //* Stage Properties;\n\n    this.cameraZ = 400; //* Aproximação da câmara || Coordenada Z\n\n    this.fieldOfView = 5; //* Distância da câmara\n\n    this.nearClippingPlane = 1; //* Proximidade do plano\n\n    this.farClippingPlane = 30000; //* Afastamento do plano\n\n    this.warehouses = [];\n    this.routes = [];\n    this.trucks = [];\n    this.activeTrucks = [];\n    this.warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\n    this.checkerNetworkPlanedRoutes = true;\n    this.activateMotion = false;\n    this.isAutomaticMovement = false;\n    this.pathsData = new Map([]);\n    this.pathsData_Warehouses = new Map();\n    this.currentDistance = 0;\n    this.speed = 0.2;\n    this.roadsData = new Map([]);\n    this.ambientSoundLoader = new THREE.AudioLoader();\n    this.ambientListener = new THREE.AudioListener();\n    this.ambientAudio = new THREE.Audio(this.ambientListener);\n    this.truckSoundLoader = new THREE.AudioLoader();\n    this.truckListener = new THREE.AudioListener();\n    this.truckAudio = new THREE.Audio(this.truckListener);\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.importLoaders();\n    this.warehousesService.getWarehouses().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (data) {\n        _this.warehouses = data;\n        console.log(_this.warehouses);\n\n        _this.routesService.getRoutes().subscribe( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (data) {\n            _this.routes = data;\n            console.log(_this.routes);\n\n            _this.trucksService.getTrucks().subscribe( /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator(function* (data) {\n                _this.trucks = data;\n                console.log(_this.trucks);\n                yield _this.createScene();\n                yield _this.startRenderingLoop();\n              });\n\n              return function (_x3) {\n                return _ref3.apply(this, arguments);\n              };\n            }());\n          });\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  ngAfterViewInit() {}\n\n  get canvas() {\n    return this.canvasRef.nativeElement;\n  } //tamanho da janela\n\n\n  static getAspectRatio() {\n    return window.innerWidth / window.innerHeight;\n  }\n\n  createScene() {\n    //* Scene\n    this.scene = new THREE.Scene(); //* Camera\n\n    this.camera = new THREE.PerspectiveCamera(this.fieldOfView, NetworkComponent.getAspectRatio(), this.nearClippingPlane, this.farClippingPlane); //fog\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\n\n    this.camera.position.z = this.cameraZ;\n    this.scene.add(this.camera); //sounds\n\n    this.camera.add(this.ambientListener);\n    this.camera.add(this.truckListener);\n    this.addSkybox();\n    this.addWarehouses();\n    this.addLights();\n  }\n\n  addSkybox() {\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000, 1000);\n    let skyboxMaterials = [new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshStandardMaterial({\n      map: this.skyBoxGroundTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    }), new MeshBasicMaterial({\n      map: this.skyBoxTexture,\n      side: THREE.BackSide\n    })];\n    let skybox = new THREE.Mesh(skyboxGeo, skyboxMaterials);\n    skybox.position.y = 400;\n    skybox.receiveShadow = true;\n    this.scene.add(skybox);\n  }\n\n  startRenderingLoop() {\n    //* Renderer\n    // Use canvas element in template\n    this.renderer = new THREE.WebGLRenderer({\n      canvas: this.canvas,\n      antialias: true\n    });\n    this.renderer.setPixelRatio(window.devicePixelRatio); //definir janela\n\n    this.renderer.setSize(window.innerWidth, window.innerHeight); //ShadowMap para permitir Sombras\n\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; //Orbit Controls\n\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\n    controls.maxDistance = 1500; //900 zoom out\n\n    controls.minDistance = 50; //100 zoom in\n\n    controls.minAzimuthAngle = -Math.PI; //Rotação D 90º\n\n    controls.maxAzimuthAngle = Math.PI; //Rotação E 90º\n\n    controls.maxPolarAngle = Math.PI / 2; //Rotação Eixo Y 90º\n    // controls.minPolarAngle=Math.PI/2\n\n    let component = this;\n\n    (function render() {\n      requestAnimationFrame(render); //Render truck Movement animation\n\n      component.manualMovement();\n      component.automaticMovement(); //janelade visualização\n\n      component.renderer.setViewport(-200, 0, window.innerWidth + 200, window.innerHeight);\n      component.renderer.setClearColor(0xCADFED, 1);\n      component.renderer.render(component.scene, component.camera);\n    })();\n  }\n\n  addWarehouses() {\n    for (let i = 0; i < this.warehouses.length; i++) {\n      let warehouseBaseMaterial = [new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        map: this.roundaboutTexture\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      }), new THREE.MeshLambertMaterial({\n        color: 0x000000\n      })];\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, warehouseBaseMaterial); //*Base da Warehouse\n\n      base.position.set(NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1], NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\n      base.name = this.warehouses[i].warehouseIdentifier;\n      base.castShadow = true;\n      base.receiveShadow = true; //Nomes cidades\n\n      let sprite = new TextSprite({\n        text: this.warehouses[i].designation,\n        alignment: 'left',\n        color: '#000000',\n        fontFamily: '\"Arial\", Times, serif',\n        fontStyle: 'italic'\n      });\n      sprite.position.set(base.position.x, base.position.y + 3.2, base.position.z);\n      this.scene.add(sprite);\n      let warehouse3D = this.warehouse3D.clone();\n      warehouse3D.name = this.warehouses[i].designation;\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\n      this.scene.add(warehouse3D);\n      this.scene.add(base);\n    }\n\n    this.addRoads();\n  }\n\n  addRoads() {\n    for (let i = 0; i < this.routes.length; i++) {\n      let ware0 = this.scene.getObjectByName(this.routes[i].departureId);\n      let ware1 = this.scene.getObjectByName(this.routes[i].arrivalId);\n\n      if (ware0 != null && ware1 != null) {\n        let teta0 = Math.atan2(-(ware1.position.z - ware0.position.z), ware1.position.x - ware0.position.x);\n        let teta1 = Math.PI + teta0;\n        let elemLigMaterial = [new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          map: this.elemLigTexture\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        })];\n        let elemLigGeometry = new THREE.BoxGeometry(0.3, 0.20, 2);\n        let elemLig0Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig0Mesh.position.set(ware0.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta0), ware0.position.y, ware0.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta0));\n        elemLig0Mesh.rotateY(teta0);\n        elemLig0Mesh.castShadow = true;\n        elemLig0Mesh.receiveShadow = true;\n        this.scene.add(elemLig0Mesh);\n        let elemLig1Mesh = new THREE.Mesh(elemLigGeometry, elemLigMaterial);\n        elemLig1Mesh.position.set(ware1.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(teta1), ware1.position.y, ware1.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(teta1));\n        elemLig1Mesh.rotateY(teta1);\n        elemLig1Mesh.castShadow = true;\n        elemLig1Mesh.receiveShadow = true;\n        this.scene.add(elemLig1Mesh);\n        let roadMaterial = [new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          map: this.roadTexture\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        }), new THREE.MeshLambertMaterial({\n          color: 0x000000\n        })];\n        let roadGeometry = new THREE.BoxGeometry(2, 0.20, Math.sqrt(Math.pow(elemLig0Mesh.position.x - elemLig1Mesh.position.x, 2) + Math.pow(elemLig0Mesh.position.y - elemLig1Mesh.position.y, 2) + Math.pow(elemLig0Mesh.position.z - elemLig1Mesh.position.z, 2)));\n        let roadMesh = new THREE.Mesh(roadGeometry, roadMaterial);\n        roadMesh.position.set((elemLig0Mesh.position.x + elemLig1Mesh.position.x) / 2, (elemLig0Mesh.position.y + elemLig1Mesh.position.y) / 2, (elemLig0Mesh.position.z + elemLig1Mesh.position.z) / 2);\n        roadMesh.castShadow = true;\n        roadMesh.receiveShadow = true;\n        this.scene.add(roadMesh);\n        let beta = Math.asin((elemLig0Mesh.position.y - elemLig1Mesh.position.y) / roadGeometry.parameters.depth);\n        let omega = teta0 + Math.PI / 2;\n        roadMesh.rotation.set(beta, omega, 0, \"ZYX\");\n        this.roadsData.set(this.routes[i].routeId, [teta0, teta1, elemLig0Mesh.position.x, elemLig0Mesh.position.y, elemLig0Mesh.position.z, elemLig1Mesh.position.x, elemLig1Mesh.position.y, elemLig1Mesh.position.z, roadMesh.position.x, roadMesh.position.y, roadMesh.position.z, beta, teta0 + Math.PI / 2]);\n      }\n    }\n  }\n\n  addLights() {\n    //*Light\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\n    this.scene.add(light_amb);\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directLight.castShadow = true;\n    this.camera.add(directLight);\n    /*   directLight.rotateY(Math.PI)\r\n       const cameraHelper =\r\n         new THREE.CameraHelper(directLight.shadow.camera);\r\n       this.scene.add(cameraHelper);*/\n\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\n    spotLight.position.set(0, 500, 40);\n    spotLight.castShadow = true;\n    spotLight.target.position.set(0, 0, 40);\n    spotLight.shadow.mapSize.width = 2048;\n    spotLight.shadow.mapSize.height = 2048;\n    spotLight.shadow.camera.far = 1000;\n    this.scene.add(spotLight);\n    this.scene.add(spotLight.target);\n  }\n\n  addTruck(truckName) {\n    const truck3D = this.truck3D.clone();\n    truck3D.name = truckName;\n    this.scene.add(truck3D);\n\n    if (this.isAutomaticMovement) {\n      // @ts-ignore\n      const ware0 = this.scene.getObjectByName(this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE0]); // @ts-ignore\n\n      truck3D.position.set(ware0?.position.x, ware0?.position.y, ware0?.position.z + 2);\n      this.activeTrucks.push(this.scene.getObjectByName(truck3D.name));\n      this.isAutomaticMovement = false;\n    }\n  }\n\n  setAutomaticMovementRoutAndTruck(el, map) {\n    map.forEach((value, key) => {\n      this.automaticTruck = key;\n      let path = new THREE.CurvePath();\n\n      for (let i = 0; i < value.length - 1; i++) {\n        let road = this.getRouteByWarehouses(value[i], value[i + 1]);\n        let wareDeparture = this.scene.getObjectByName(value[i]);\n        let warehouseArrival = this.scene.getObjectByName(value[i + 1]);\n        let roadData = this.roadsData.get(road?.routeId);\n\n        if (roadData != undefined && warehouseArrival != undefined) {\n          if (!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)) {\n            let rightMovement_X = 0.45 * Math.cos(roadData[NetworkComponent.TETA_0] - Math.PI / 2);\n            let rightMovement_Z = 0.45 * Math.sin(roadData[NetworkComponent.TETA_0] + Math.PI / 2);\n\n            if (i == 0) {\n              //Posição inicial até El0\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z))); //W0-EL0\n            } //road-até ponto EL1\n\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z)));\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\n            let nextRoadData = this.roadsData.get(this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\n\n            if (i < value.length - 2 && nextRoadData != null) {\n              //Rotunda\n              let teta = Math.atan2(-(warehouseArrival.position.z - roadData[NetworkComponent.EL1_Z]), warehouseArrival.position.x - roadData[NetworkComponent.EL1_X]); //SAIDA                           ENTRADA                                 SAIDA                           ENTRADA\n\n              let beta = Math.atan2(-(warehouseArrival.position.z - nextRoadData[NetworkComponent.EL1_Z]), warehouseArrival.position.x - nextRoadData[NetworkComponent.EL1_X]);\n              let geo = new BoxGeometry(0.2, 2, 0.2);\n              let t = teta + beta / 10;\n              console.log(t);\n\n              for (let j = 0; j < 10; j++) {\n                if (j <= 4) {\n                  let material = new MeshBasicMaterial({\n                    color: 0x0000ff\n                  });\n                  let mesH = new Mesh(geo, material);\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t + j * t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t + j * t));\n                  this.scene.add(mesH);\n                } else {\n                  let material = new MeshBasicMaterial({\n                    color: 0x993399\n                  });\n                  let mesH = new Mesh(geo, material);\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t + j * t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t + j * t));\n                  this.scene.add(mesH);\n                }\n              }\n            }\n\n            if (i == value.length - 2) {\n              //se for a estrada final\n              console.log(\"Estrada final cima\");\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\n            }\n          } else {\n            let rightMovement_X = 0.45 * Math.cos(roadData[NetworkComponent.TETA_1] - Math.PI / 2);\n            let rightMovement_Z = 0.45 * Math.sin(roadData[NetworkComponent.TETA_1] + Math.PI / 2);\n\n            if (i == 0) {\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\n            }\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z))); //EL0-EL0_ROAD\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z))); //EL0-ROAD_ROAD\n\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z))); //ROAD-ROAD_EL1\n\n            path.add(new LineCurve3(new Vector3((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2 + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, (roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2 + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z))); //ROAD_EL1_EL1\n\n            let nextRoadData = this.roadsData.get(this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\n\n            if (value.length - 2 && nextRoadData != null) {\n              //Roundabout\n              let teta = Math.atan2(warehouseArrival.position.z - roadData[NetworkComponent.EL0_Z], warehouseArrival.position.x - roadData[NetworkComponent.EL0_X]);\n              let beta = Math.atan2(warehouseArrival.position.z - nextRoadData[NetworkComponent.EL0_Z], warehouseArrival.position.x - nextRoadData[NetworkComponent.EL0_X]);\n              let geo = new BoxGeometry(0.2, 2, 0.2);\n              let t = -(teta + beta) / 10;\n              console.log(t);\n\n              for (let j = 0; j < 10; j++) {\n                if (j <= 4) {\n                  let material = new MeshBasicMaterial({\n                    color: 0xFF0000\n                  });\n                  let mesH = new Mesh(geo, material);\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t + j * t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t + j * t));\n                  this.scene.add(mesH);\n                } else {\n                  let material = new MeshBasicMaterial({\n                    color: 0xFFD700\n                  });\n                  let mesH = new Mesh(geo, material);\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t + j * t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t + j * t));\n                  this.scene.add(mesH);\n                }\n              }\n            }\n\n            if (i == value.length - 2) {\n              console.log(\"Estrada final baixo\");\n              path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\n            }\n          }\n        }\n      }\n\n      path.autoClose = true;\n      this.pathLength = path.getLength();\n      this.pathsData_Warehouses.set(key, [value[0], value[1], value[value.length - 1]]);\n      this.pathsData.set(key, path);\n    });\n    this.scrollDone(el);\n  }\n\n  startAutomaticMovement() {\n    //ativar o som do camião\n    this.truckAudio.play();\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x3 != null && z != null) {\n      if (x3.style.display === \"block\" && z.style.display === \"none\") {\n        z.style.display = \"block\";\n        x3.style.display = \"none\"; //ativar o movimento do camião\n\n        this.activateMotion = true;\n      }\n    }\n  }\n\n  automaticMovement() {\n    //Automatic truck movement\n    if (this.activateMotion && this.activeTrucks.length != 0) {\n      for (let i = 0; i < this.activeTrucks.length; i++) {\n        // @ts-ignore\n        let points = this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\n\n        if (points != undefined) {\n          this.activeTrucks[i]?.lookAt(points);\n          this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\n          this.currentDistance += this.speed;\n\n          if (this.currentDistance >= this.pathLength) {\n            this.activateMotion = false;\n            this.scene.remove(this.activeTrucks[i]);\n            this.pathsData.delete(this.activeTrucks[i].name);\n            this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\n            this.truckAudio.stop();\n            this.currentDistance = 0;\n          }\n        }\n      }\n    }\n  }\n\n  manualMovement() {\n    /*\r\n     document.onkeydown = function (e) {\r\n       switch (e.key) {\r\n         case \"a\":\r\n           //rodar a camara para a esquerda\r\n           truck?.position.set(truck?.position.x- 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n               case \"d\":\r\n           //rodar a camara para a direita\r\n           truck?.position.set(truck?.position.x+ 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n               case \"w\":\r\n           //avançar - incrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z- 0.1) ;\r\n           break;\r\n               case \"s\":\r\n           //recuar - decrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z+ 0.1) ;\r\n           break;\r\n               case \"p\":\r\n           //subir - incrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y+ 0.1,truck?.position.z) ;\r\n           break;\r\n               case \"l\":\r\n           //descer - decrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y- 0.1,truck?.position.z) ;\r\n           break;\r\n               default:break;\r\n       }\r\n             switch (e.keyCode){\r\n         case 39://right key\r\n           truck?.rotateY(5 * Math.PI / 180);\r\n           break;\r\n               case 37://lef key\r\n           truck?.rotateY(-5 * Math.PI / 180);\r\n           break;\r\n               case 38://up key\r\n           truck?.rotateX(-5 * Math.PI / 180);\r\n           break;\r\n               case 40://down key\r\n           truck?.rotateX(5 * Math.PI / 180);\r\n           break;\r\n               default:break;\r\n       }\r\n         }*/\n  }\n\n  static getCoordinates(lat, lon, alt) {\n    let coordinatesArr = [];\n    const min = -100;\n    const max = 100;\n    const med = max / 2;\n    coordinatesArr[0] = -((max - min) / (8.7613 - 8.2451) * (lon - 8.2451) + min);\n    coordinatesArr[1] = (med - -med) / (42.1115 - 40.8387) * (lat - 40.8387) + -med;\n    coordinatesArr[2] = max / 800 * alt;\n    parseInt(coordinatesArr[0].toFixed(4));\n    parseInt(coordinatesArr[1].toFixed(4));\n    parseInt(coordinatesArr[2].toFixed(4));\n    return coordinatesArr;\n  }\n\n  onClick() {}\n\n  onMouseMove(event) {}\n\n  importLoaders() {\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\n\n    /* this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', (buffer) => {\r\n        this.truckAudio.setBuffer( buffer );\r\n        this.truckAudio.setLoop( true );\r\n        this.truckAudio.setVolume( 0.5 );\r\n      });*/\n    this.skyBoxTexture = new THREE.TextureLoader().load('assets/network/sky.jpg');\n    this.skyBoxGroundTexture = new THREE.TextureLoader().load('assets/network/ground.jpg');\n    this.skyBoxGroundTexture.anisotropy = 16;\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\n    this.skyBoxGroundTexture.generateMipmaps = false;\n    this.skyBoxGroundTexture.needsUpdate = true;\n    const loaderWare = new GLTFLoader();\n    loaderWare.load('/assets/network/warehouse.glb', gltf => {\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.warehouse3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    const loaderTruck = new GLTFLoader();\n    loaderTruck.load('/assets/network/Truck.glb', gltf => {\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\n      gltf.scene.castShadow = true;\n      gltf.scene.receiveShadow = true;\n      this.truck3D = gltf.scene;\n    }, undefined, function (error) {\n      console.error(error);\n    });\n    this.roundaboutTexture = new THREE.TextureLoader().load('assets/network/rotunda.jpg');\n    this.elemLigTexture = new THREE.TextureLoader().load('assets/network/road.jpg');\n    this.elemLigTexture.anisotropy = 16;\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\n    this.elemLigTexture.generateMipmaps = false;\n    this.elemLigTexture.needsUpdate = true;\n    this.roadTexture = new THREE.TextureLoader().load('assets/network/road1.jpg');\n    this.roadTexture.anisotropy = 16;\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\n    this.roadTexture.minFilter = THREE.LinearFilter;\n    this.roadTexture.magFilter = THREE.LinearFilter;\n    this.roadTexture.generateMipmaps = false;\n    this.roadTexture.needsUpdate = true;\n  } //Auxiliar Methods\n\n\n  getRouteByWarehouses(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return this.routes[i];\n      } else if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return this.routes[i];\n      }\n    }\n\n    return null;\n  }\n\n  isRegisteredFirstOnRoutObject(ware1Identifier, ware2Identifier) {\n    for (let i = 0; i < this.routes.length; i++) {\n      if (ware1Identifier == this.routes[i].arrivalId && ware2Identifier == this.routes[i].departureId) {\n        return true;\n      } else if (ware1Identifier == this.routes[i].departureId && ware2Identifier == this.routes[i].arrivalId) {\n        return false;\n      }\n    }\n\n    return false;\n  }\n\n  makeDelivery() {\n    let x1 = document.getElementById(\"OptionManualDelivery\");\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\n    let z = document.getElementById(\"OptionMakeDelivery\");\n\n    if (x1 != null && x2 != null && z != null) {\n      if (x1.style.display === \"none\" && x2.style.display === \"none\") {\n        x1.style.display = \"block\";\n        x2.style.display = \"block\";\n        z.style.display = \"none\";\n      }\n    }\n  }\n\n  scrollAutomaticDelivery(el) {\n    this.isAutomaticMovement = true;\n    let x = document.getElementById(\"AutomaticSection\");\n\n    if (x != null) {\n      x.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollDone(el) {\n    let done = document.getElementById(\"ButtonDoneSection\");\n\n    if (done != null) {\n      done.style.display = \"block\";\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n  scrollCanvas(el) {\n    this.addTruck(this.automaticTruck);\n    let x1 = document.getElementById(\"OptionManualDelivery\");\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\n    let x5 = document.getElementById(\"AutomaticSection\");\n    let done = document.getElementById(\"ButtonDoneSection\");\n\n    if (x1 != null && x2 != null && x3 != null && x5 != null && done != null) {\n      if (x1.style.display === \"block\" && x2.style.display === \"block\") {\n        x1.style.display = \"none\";\n        x2.style.display = \"none\";\n        x3.style.display = \"block\";\n        x5.style.display = \"none\";\n        done.style.display = \"none\";\n      }\n    }\n\n    el.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }\n\n}\nNetworkComponent.WARE0 = 0;\nNetworkComponent.WARE1 = 1;\nNetworkComponent.WARE_FINAL = 2;\nNetworkComponent.TETA_0 = 0;\nNetworkComponent.TETA_1 = 1;\nNetworkComponent.EL0_X = 2;\nNetworkComponent.EL0_Y = 3;\nNetworkComponent.EL0_Z = 4;\nNetworkComponent.EL1_X = 5;\nNetworkComponent.EL1_Y = 6;\nNetworkComponent.EL1_Z = 7;\nNetworkComponent.ROAD_X = 8;\nNetworkComponent.ROAD_Y = 9;\nNetworkComponent.ROAD_Z = 10;\nNetworkComponent.BETA = 11;\nNetworkComponent.OMEGA = 12;\n\nNetworkComponent.ɵfac = function NetworkComponent_Factory(t) {\n  return new (t || NetworkComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.WarehousesService), i0.ɵɵdirectiveInject(i3.RoutesService), i0.ɵɵdirectiveInject(i4.TrucksService));\n};\n\nNetworkComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: NetworkComponent,\n  selectors: [[\"app-network\"]],\n  viewQuery: function NetworkComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n    }\n  },\n  inputs: {\n    cameraZ: \"cameraZ\",\n    fieldOfView: \"fieldOfView\",\n    nearClippingPlane: [\"nearClipping\", \"nearClippingPlane\"],\n    farClippingPlane: [\"farClipping\", \"farClippingPlane\"]\n  },\n  decls: 30,\n  vars: 1,\n  consts: [[\"id\", \"SectionNavbar\", 1, \"navbar\"], [\"href\", \"/views/login\"], [\"id\", \"OptionMakeDelivery\", 3, \"click\"], [\"id\", \"OptionManualDelivery\", 2, \"display\", \"none\"], [\"id\", \"OptionAutomaticDelivery\", 2, \"display\", \"none\"], [3, \"click\"], [\"id\", \"OptionStartAutomaticDelivery\", 2, \"display\", \"none\"], [1, \"page\"], [1, \"center\"], [\"canvasSection\", \"\"], [\"id\", \"canvas\", 3, \"mousemove\", \"click\"], [\"canvas\", \"\"], [\"listRoutesSection\", \"\"], [\"id\", \"AutomaticSection\", 2, \"display\", \"none\", 3, \"networkChecker\", \"getRouteAndTruckEvent\"], [2, \"align-content\", \"center\"], [\"id\", \"ButtonDoneSection\", \"role\", \"button\", 1, \"button-73\", 2, \"display\", \"none\", 3, \"click\"], [\"done\", \"\"]],\n  template: function NetworkComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r4 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"nav\", 0)(1, \"ul\")(2, \"li\")(3, \"a\", 1);\n      i0.ɵɵtext(4, \"Home\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"li\")(6, \"a\", 2);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_6_listener() {\n        return ctx.makeDelivery();\n      });\n      i0.ɵɵtext(7, \"Make Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"li\", 3)(9, \"a\");\n      i0.ɵɵtext(10, \"Manual Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"li\", 4)(12, \"a\", 5);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_12_listener() {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r2 = i0.ɵɵreference(24);\n\n        return i0.ɵɵresetView(ctx.scrollAutomaticDelivery(_r2));\n      });\n      i0.ɵɵtext(13, \"Automatic Delivery\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"li\", 6)(15, \"a\", 5);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_a_click_15_listener() {\n        return ctx.startAutomaticMovement();\n      });\n      i0.ɵɵtext(16, \"Start\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 7)(18, \"div\", 8)(19, \"div\", null, 9)(21, \"canvas\", 10, 11);\n      i0.ɵɵlistener(\"mousemove\", function NetworkComponent_Template_canvas_mousemove_21_listener($event) {\n        return ctx.onMouseMove($event);\n      })(\"click\", function NetworkComponent_Template_canvas_click_21_listener() {\n        return ctx.onClick();\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(23, \"div\", null, 12)(25, \"app-get-planned-route\", 13);\n      i0.ɵɵlistener(\"getRouteAndTruckEvent\", function NetworkComponent_Template_app_get_planned_route_getRouteAndTruckEvent_25_listener($event) {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r3 = i0.ɵɵreference(28);\n\n        return i0.ɵɵresetView(ctx.setAutomaticMovementRoutAndTruck(_r3, $event));\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"div\", 14)(27, \"button\", 15, 16);\n      i0.ɵɵlistener(\"click\", function NetworkComponent_Template_button_click_27_listener() {\n        i0.ɵɵrestoreView(_r4);\n\n        const _r0 = i0.ɵɵreference(20);\n\n        return i0.ɵɵresetView(ctx.scrollCanvas(_r0));\n      });\n      i0.ɵɵtext(29, \"Done\");\n      i0.ɵɵelementEnd()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(25);\n      i0.ɵɵproperty(\"networkChecker\", ctx.checkerNetworkPlanedRoutes);\n    }\n  },\n  dependencies: [i5.GetPlannedRouteComponent],\n  styles: [\"*[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\nbody[_ngcontent-%COMP%]{\\r\\n  margin: 0;\\r\\n  font-family: \\\"Lato\\\", sans-serif;\\r\\n  background: #EFEEF4;\\r\\n  line-height: 1.6;\\r\\n  height: 100vh;\\r\\n  overflow: hidden;\\r\\n}\\r\\n\\r\\n.container[_ngcontent-%COMP%]{\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  overflow-y: scroll;\\r\\n  scroll-behavior: smooth;\\r\\n  scroll-snap-type: y mandatory;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]{\\r\\n  position: fixed;\\r\\n  top:0;\\r\\n  z-index: 1;\\r\\n  display: flex;\\r\\n  width: 100%;\\r\\n  height: 60px;\\r\\n  background: rgba(239,238,244,0.7);\\r\\n  font-weight: 700;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{\\r\\n  display: flex;\\r\\n  list-style: none;\\r\\n  width: 100%;\\r\\n  justify-content: center;\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{\\r\\n  margin: 0 1rem;\\r\\n  padding: 1rem;\\r\\n  font-family: 'Secular One', sans-serif;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{\\r\\n  text-decoration: none;\\r\\n  text-transform: uppercase;\\r\\n\\r\\n  color: #778DB3;\\r\\n  font-size: 1.5rem;\\r\\n\\r\\n}\\r\\n\\r\\n.navbar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{\\r\\n  color: skyblue;\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n.button-73[_ngcontent-%COMP%] {\\r\\n  background-color: #FFFFFF;\\r\\n  border-radius: 40em;\\r\\n  border-style: none;\\r\\n  box-shadow: #ADCFFF 0 -12px 6px inset;\\r\\n  box-sizing: border-box;\\r\\n  color: #000000;\\r\\n  cursor: pointer;\\r\\n  font-family: 'Secular One', sans-serif;\\r\\n  font-size: 1rem;\\r\\n  font-weight: 600;\\r\\n  padding: 1rem 1.3rem;\\r\\n  quotes: auto;\\r\\n  text-align: center;\\r\\n  text-decoration: none;\\r\\n  transition: all .15s;\\r\\n  user-select: none;\\r\\n  -webkit-user-select: none;\\r\\n  touch-action: manipulation;\\r\\n  margin-left: 47%;\\r\\n  margin-bottom: 1%;\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:hover {\\r\\n  background-color: #778DB3;\\r\\n  box-shadow: #37465f 0 -6px 8px inset;\\r\\n  transform: scale(1);\\r\\n}\\r\\n\\r\\n.button-73[_ngcontent-%COMP%]:active {\\r\\n  transform: scale(1);\\r\\n}\\r\\n\\r\\n@media (min-width: 768px) {\\r\\n  .button-73[_ngcontent-%COMP%] {\\r\\n    font-size: 1rem;\\r\\n    padding: .75rem 2rem;\\r\\n  }\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ldHdvcmsuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFNBQVM7RUFDVCxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxTQUFTO0VBQ1QsK0JBQStCO0VBQy9CLG1CQUFtQjtFQUNuQixnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHVCQUF1QjtFQUN2Qiw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsS0FBSztFQUNMLFVBQVU7RUFDVixhQUFhO0VBQ2IsV0FBVztFQUNYLFlBQVk7RUFDWixpQ0FBaUM7RUFDakMsZ0JBQWdCOztBQUVsQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLHVCQUF1QjtBQUN6Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxhQUFhO0VBQ2Isc0NBQXNDOztBQUV4Qzs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQix5QkFBeUI7O0VBRXpCLGNBQWM7RUFDZCxpQkFBaUI7O0FBRW5COztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFDQSxRQUFROztBQUNSO0VBQ0UseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIscUNBQXFDO0VBQ3JDLHNCQUFzQjtFQUN0QixjQUFjO0VBQ2QsZUFBZTtFQUNmLHNDQUFzQztFQUN0QyxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLG9CQUFvQjtFQUNwQixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLHFCQUFxQjtFQUNyQixvQkFBb0I7RUFDcEIsaUJBQWlCO0VBQ2pCLHlCQUF5QjtFQUN6QiwwQkFBMEI7RUFDMUIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixvQ0FBb0M7RUFDcEMsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0U7SUFDRSxlQUFlO0lBQ2Ysb0JBQW9CO0VBQ3RCO0FBQ0YiLCJmaWxlIjoibmV0d29yay5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiKntcclxuICBtYXJnaW46IDA7XHJcbiAgcGFkZGluZzogMDtcclxufVxyXG5cclxuYm9keXtcclxuICBtYXJnaW46IDA7XHJcbiAgZm9udC1mYW1pbHk6IFwiTGF0b1wiLCBzYW5zLXNlcmlmO1xyXG4gIGJhY2tncm91bmQ6ICNFRkVFRjQ7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNjtcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbn1cclxuXHJcbi5jb250YWluZXJ7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIG92ZXJmbG93LXk6IHNjcm9sbDtcclxuICBzY3JvbGwtYmVoYXZpb3I6IHNtb290aDtcclxuICBzY3JvbGwtc25hcC10eXBlOiB5IG1hbmRhdG9yeTtcclxufVxyXG5cclxuLm5hdmJhcntcclxuICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgdG9wOjA7XHJcbiAgei1pbmRleDogMTtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGhlaWdodDogNjBweDtcclxuICBiYWNrZ3JvdW5kOiByZ2JhKDIzOSwyMzgsMjQ0LDAuNyk7XHJcbiAgZm9udC13ZWlnaHQ6IDcwMDtcclxuXHJcbn1cclxuXHJcbi5uYXZiYXIgdWx7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBsaXN0LXN0eWxlOiBub25lO1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG59XHJcblxyXG4ubmF2YmFyIHVsIGxpe1xyXG4gIG1hcmdpbjogMCAxcmVtO1xyXG4gIHBhZGRpbmc6IDFyZW07XHJcbiAgZm9udC1mYW1pbHk6ICdTZWN1bGFyIE9uZScsIHNhbnMtc2VyaWY7XHJcblxyXG59XHJcblxyXG4ubmF2YmFyIHVsIGxpIGF7XHJcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XHJcblxyXG4gIGNvbG9yOiAjNzc4REIzO1xyXG4gIGZvbnQtc2l6ZTogMS41cmVtO1xyXG5cclxufVxyXG5cclxuLm5hdmJhciB1bCBsaSBhOmhvdmVye1xyXG4gIGNvbG9yOiBza3libHVlO1xyXG59XHJcbi8qIENTUyAqL1xyXG4uYnV0dG9uLTczIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRkZGO1xyXG4gIGJvcmRlci1yYWRpdXM6IDQwZW07XHJcbiAgYm9yZGVyLXN0eWxlOiBub25lO1xyXG4gIGJveC1zaGFkb3c6ICNBRENGRkYgMCAtMTJweCA2cHggaW5zZXQ7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBjb2xvcjogIzAwMDAwMDtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgZm9udC1mYW1pbHk6ICdTZWN1bGFyIE9uZScsIHNhbnMtc2VyaWY7XHJcbiAgZm9udC1zaXplOiAxcmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgcGFkZGluZzogMXJlbSAxLjNyZW07XHJcbiAgcXVvdGVzOiBhdXRvO1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgdHJhbnNpdGlvbjogYWxsIC4xNXM7XHJcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcclxuICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjtcclxuICBtYXJnaW4tbGVmdDogNDclO1xyXG4gIG1hcmdpbi1ib3R0b206IDElO1xyXG59XHJcblxyXG4uYnV0dG9uLTczOmhvdmVyIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNzc4REIzO1xyXG4gIGJveC1zaGFkb3c6ICMzNzQ2NWYgMCAtNnB4IDhweCBpbnNldDtcclxuICB0cmFuc2Zvcm06IHNjYWxlKDEpO1xyXG59XHJcblxyXG4uYnV0dG9uLTczOmFjdGl2ZSB7XHJcbiAgdHJhbnNmb3JtOiBzY2FsZSgxKTtcclxufVxyXG5cclxuQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSB7XHJcbiAgLmJ1dHRvbi03MyB7XHJcbiAgICBmb250LXNpemU6IDFyZW07XHJcbiAgICBwYWRkaW5nOiAuNzVyZW0gMnJlbTtcclxuICB9XHJcbn1cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["ElementRef","THREE","TextSprite","BoxGeometry","LineCurve3","Mesh","MeshBasicMaterial","MeshStandardMaterial","Vector3","OrbitControls","GLTFLoader","NetworkComponent","constructor","route","warehousesService","routesService","trucksService","CylinderGeometry","Map","AudioLoader","AudioListener","Audio","ambientListener","truckListener","ngOnInit","importLoaders","getWarehouses","subscribe","data","warehouses","console","log","getRoutes","routes","getTrucks","trucks","createScene","startRenderingLoop","ngAfterViewInit","canvas","canvasRef","nativeElement","getAspectRatio","window","innerWidth","innerHeight","scene","Scene","camera","PerspectiveCamera","fieldOfView","nearClippingPlane","farClippingPlane","position","z","cameraZ","add","addSkybox","addWarehouses","addLights","skyboxGeo","skyboxMaterials","map","skyBoxTexture","side","BackSide","skyBoxGroundTexture","skybox","y","receiveShadow","renderer","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","type","PCFSoftShadowMap","controls","domElement","maxDistance","minDistance","minAzimuthAngle","Math","PI","maxAzimuthAngle","maxPolarAngle","component","render","requestAnimationFrame","manualMovement","automaticMovement","setViewport","setClearColor","i","length","warehouseBaseMaterial","MeshLambertMaterial","color","roundaboutTexture","base","warehouseBaseGeometry","set","getCoordinates","latitude","longitude","warehouseAltitude","name","warehouseIdentifier","castShadow","sprite","text","designation","alignment","fontFamily","fontStyle","x","warehouse3D","clone","addRoads","ware0","getObjectByName","departureId","ware1","arrivalId","teta0","atan2","teta1","elemLigMaterial","elemLigTexture","elemLigGeometry","elemLig0Mesh","parameters","radiusTop","cos","sin","rotateY","elemLig1Mesh","roadMaterial","roadTexture","roadGeometry","sqrt","pow","roadMesh","beta","asin","depth","omega","rotation","roadsData","routeId","light_amb","AmbientLight","directLight","DirectionalLight","spotLight","SpotLight","target","shadow","mapSize","width","height","far","addTruck","truckName","truck3D","isAutomaticMovement","pathsData_Warehouses","get","WARE0","activeTrucks","push","setAutomaticMovementRoutAndTruck","el","forEach","value","key","automaticTruck","path","CurvePath","road","getRouteByWarehouses","wareDeparture","warehouseArrival","roadData","undefined","isRegisteredFirstOnRoutObject","rightMovement_X","TETA_0","rightMovement_Z","EL0_X","EL0_Y","EL0_Z","ROAD_X","ROAD_Y","ROAD_Z","EL1_X","EL1_Y","EL1_Z","nextRoadData","teta","geo","t","j","material","mesH","TETA_1","autoClose","pathLength","getLength","pathsData","scrollDone","startAutomaticMovement","truckAudio","play","x3","document","getElementById","style","display","activateMotion","points","getPoint","currentDistance","lookAt","speed","remove","delete","filter","obj","stop","lat","lon","alt","coordinatesArr","min","max","med","parseInt","toFixed","onClick","onMouseMove","event","TextureLoader","load","anisotropy","wrapS","wrapT","MirroredRepeatWrapping","minFilter","LinearFilter","magFilter","generateMipmaps","needsUpdate","loaderWare","gltf","scale","error","loaderTruck","ware1Identifier","ware2Identifier","makeDelivery","x1","x2","scrollAutomaticDelivery","scrollIntoView","behavior","done","scrollCanvas","x5","i0","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.ts","C:\\Users\\pedro\\OneDrive\\Documentos\\Eng.Informatica_Projects\\3 Ano\\lapr5_g61\\lei22_23_s5_3dk_61_angular\\EletricGo\\src\\app\\views\\network\\network.component.html"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild } from '@angular/core';\r\nimport * as THREE from \"three\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport TextSprite from \"@seregpie/three.text-sprite\";\r\nimport {BoxGeometry, Group, LineCurve3, Mesh, MeshBasicMaterial, MeshStandardMaterial, Object3D, Vector3} from 'three';\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\nimport { GLTFLoader} from \"three/examples/jsm/loaders/GLTFLoader\";\r\nimport {WarehousesService} from \"../../services/dotnet/warehouses.service\";\r\nimport {RoutesService} from \"../../services/node/routes.service\";\r\nimport {TrucksService} from \"../../services/node/truck.service\";\r\n\r\n@Component({\r\n  selector: 'app-network',\r\n  templateUrl: './network.component.html',\r\n  styleUrls: ['./network.component.css']\r\n})\r\nexport class NetworkComponent implements OnInit, AfterViewInit {\r\n\r\n  //tipo do canvas\r\n  @ViewChild('canvas')\r\n  private canvasRef: ElementRef;\r\n\r\n  //* Stage Properties;\r\n  @Input() public cameraZ: number = 400; //* Aproximação da câmara || Coordenada Z\r\n  @Input() public fieldOfView: number = 5;  //* Distância da câmara\r\n  @Input('nearClipping') public nearClippingPlane: number = 1;//* Proximidade do plano\r\n  @Input('farClipping') public farClippingPlane: number = 30000;//* Afastamento do plano\r\n\r\n\r\n  private renderer!: THREE.WebGLRenderer;\r\n  private scene!: THREE.Scene;\r\n  private camera!: THREE.PerspectiveCamera;\r\n\r\n  private warehouses:any[]=[];\r\n  private routes:Route[]=[];\r\n  private trucks:Truck[]=[];\r\n  private activeTrucks:Object3D[]=[];\r\n  private automaticTruck:string;\r\n\r\n  private skyBoxTexture:THREE.Texture;\r\n  private skyBoxGroundTexture:THREE.Texture;\r\n\r\n  private warehouseBaseGeometry = new THREE.CylinderGeometry(5, 5, 0.22, 64);\r\n  private warehouse3D: Group;\r\n  private roundaboutTexture: THREE.Texture ;\r\n  private elemLigTexture: THREE.Texture ;\r\n  private roadTexture:THREE.Texture;\r\n  private truck3D:Group;\r\n\r\n  public checkerNetworkPlanedRoutes=true;\r\n\r\n  private activateMotion=false;\r\n  private isAutomaticMovement=false;\r\n\r\n  private pathsData = new Map<string, THREE.CurvePath<any>>([]);\r\n  private pathsData_Warehouses=new Map<string,string[]>();\r\n  private static WARE0=0;  private static WARE1=1;private static WARE_FINAL=2;\r\n\r\n  private pathLength:number;\r\n  private currentDistance = 0;\r\n  private speed = 0.2;\r\n\r\n  private roadsData = new Map<string, number[]>([]);\r\n  private static TETA_0=0;private static TETA_1=1;\r\n  private static EL0_X=2;private static EL0_Y=3;private static EL0_Z=4;\r\n  private static EL1_X=5;private static EL1_Y=6;private static EL1_Z=7;\r\n  private static ROAD_X=8;private static ROAD_Y=9;private static ROAD_Z=10;\r\n  private static BETA=11;private static OMEGA=12;\r\n\r\n  private ambientSoundLoader = new THREE.AudioLoader();\r\n  private ambientListener=new THREE.AudioListener();\r\n  private ambientAudio=new THREE.Audio(this.ambientListener);\r\n\r\n  private truckSoundLoader = new THREE.AudioLoader();\r\n  private truckListener=new THREE.AudioListener();\r\n  private truckAudio=new THREE.Audio(this.truckListener);\r\n\r\n  constructor(private route: ActivatedRoute,private  warehousesService:WarehousesService, private routesService:RoutesService,private trucksService:TrucksService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.importLoaders();\r\n\r\n    this.warehousesService.getWarehouses().subscribe(async data=>{\r\n      this.warehouses=data;\r\n      console.log(this.warehouses)\r\n\r\n      this.routesService.getRoutes().subscribe(async data=>{\r\n        this.routes=data;\r\n        console.log(this.routes)\r\n\r\n        this.trucksService.getTrucks().subscribe(async data=>{\r\n          this.trucks=data;\r\n          console.log(this.trucks)\r\n          await this.createScene();\r\n          await this.startRenderingLoop();\r\n        })\r\n      })\r\n    })\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n  }\r\n\r\n  private get canvas(): HTMLCanvasElement {\r\n    return this.canvasRef.nativeElement;\r\n  }\r\n\r\n  //tamanho da janela\r\n  private static getAspectRatio() {\r\n    return window.innerWidth/ window.innerHeight;\r\n  }\r\n\r\n  private createScene() {\r\n\r\n    //* Scene\r\n    this.scene = new THREE.Scene();\r\n\r\n    //* Camera\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      this.fieldOfView,\r\n      NetworkComponent.getAspectRatio(),\r\n      this.nearClippingPlane,\r\n      this.farClippingPlane\r\n    );\r\n    //fog\r\n    // this.scene.fog = new THREE.Fog(0xFFFFFF, 10,5000);\r\n\r\n    this.camera.position.z = this.cameraZ;\r\n    this.scene.add(this.camera);\r\n\r\n    //sounds\r\n    this.camera.add( this.ambientListener);\r\n    this.camera.add(this.truckListener);\r\n\r\n    this.addSkybox();\r\n    this.addWarehouses()\r\n    this.addLights()\r\n  }\r\n\r\n\r\n  private addSkybox(){\r\n    let skyboxGeo = new THREE.BoxGeometry(1000, 1000,1000);\r\n    let skyboxMaterials= [new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshStandardMaterial({map:this.skyBoxGroundTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide}), new MeshBasicMaterial({map:this.skyBoxTexture,side:THREE.BackSide})];\r\n\r\n    let skybox = new THREE.Mesh(skyboxGeo,skyboxMaterials);\r\n    skybox.position.y=400;\r\n    skybox.receiveShadow=true;\r\n    this.scene.add(skybox);\r\n  }\r\n\r\n  private startRenderingLoop() {\r\n    //* Renderer\r\n    // Use canvas element in template\r\n    this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n    //definir janela\r\n    this.renderer.setSize(window.innerWidth,window.innerHeight);\r\n\r\n    //ShadowMap para permitir Sombras\r\n    this.renderer.shadowMap.enabled = true;\r\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n    //Orbit Controls\r\n    let controls = new OrbitControls(this.camera, this.renderer.domElement);\r\n\r\n    controls.maxDistance = 1500;//900 zoom out\r\n    controls.minDistance = 50;//100 zoom in\r\n    controls.minAzimuthAngle = -Math.PI ;//Rotação D 90º\r\n    controls.maxAzimuthAngle = Math.PI ;//Rotação E 90º\r\n    controls.maxPolarAngle = Math.PI/2 //Rotação Eixo Y 90º\r\n    // controls.minPolarAngle=Math.PI/2\r\n\r\n    let component: NetworkComponent = this;\r\n    (function render() {\r\n      requestAnimationFrame(render);\r\n\r\n\r\n      //Render truck Movement animation\r\n      component.manualMovement();\r\n\r\n      component.automaticMovement();\r\n\r\n\r\n      //janelade visualização\r\n      component.renderer.setViewport(-200, 0, window.innerWidth+200, window.innerHeight);\r\n      component.renderer.setClearColor(0xCADFED, 1);\r\n      component.renderer.render(component.scene, component.camera);\r\n\r\n    }());\r\n  }\r\n\r\n  private addWarehouses(){\r\n    for (let i = 0; i < this.warehouses.length; i++)\r\n    {\r\n     let warehouseBaseMaterial = [ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({map:this.roundaboutTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n\r\n      const base = new THREE.Mesh(this.warehouseBaseGeometry, warehouseBaseMaterial);//*Base da Warehouse\r\n\r\n      base.position.set(\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[0],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[1],\r\n        NetworkComponent.getCoordinates(this.warehouses[i].latitude, this.warehouses[i].longitude, this.warehouses[i].warehouseAltitude)[2]);\r\n\r\n      base.name=this.warehouses[i].warehouseIdentifier;\r\n      base.castShadow=true;\r\n      base.receiveShadow=true;\r\n\r\n      //Nomes cidades\r\n      let sprite=new TextSprite({ text: this.warehouses[i].designation,alignment: 'left',\r\n        color: '#000000',\r\n        fontFamily: '\"Arial\", Times, serif',\r\n        fontStyle: 'italic',});\r\n      sprite.position.set(base.position.x,base.position.y+3.2,base.position.z);\r\n      this.scene.add(sprite)\r\n\r\n      let warehouse3D=this.warehouse3D.clone();\r\n      warehouse3D.name = this.warehouses[i].designation;\r\n      warehouse3D.position.set(base.position.x, base.position.y, base.position.z);\r\n      this.scene.add(warehouse3D);\r\n\r\n      this.scene.add(base);\r\n    }\r\n    this.addRoads();\r\n  }\r\n\r\n  private addRoads() {\r\n\r\n    for (let i = 0; i < this.routes.length; i++) {\r\n      let ware0 = <Object3D>this.scene.getObjectByName((this.routes[i].departureId));\r\n      let ware1 = <Object3D>this.scene.getObjectByName((this.routes[i].arrivalId));\r\n\r\n      if(ware0!=null&&ware1!=null){\r\n        let teta0=Math.atan2(-(ware1.position.z-ware0.position.z),ware1.position.x-ware0.position.x);\r\n        let teta1=Math.PI+teta0;\r\n\r\n        let elemLigMaterial = [ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({map:this.elemLigTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n        let elemLigGeometry =new THREE.BoxGeometry(0.3, 0.20, 2);\r\n\r\n        let elemLig0Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig0Mesh.position.set(ware0.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta0),ware0.position.y,ware0.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta0));\r\n        elemLig0Mesh.rotateY(teta0)\r\n        elemLig0Mesh.castShadow=true;\r\n        elemLig0Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig0Mesh)\r\n\r\n\r\n        let elemLig1Mesh=new THREE.Mesh(elemLigGeometry,elemLigMaterial);\r\n        elemLig1Mesh.position.set(ware1.position.x+ this.warehouseBaseGeometry.parameters.radiusTop*Math.cos(teta1),ware1.position.y,ware1.position.z-this.warehouseBaseGeometry.parameters.radiusTop*Math.sin(teta1));\r\n        elemLig1Mesh.rotateY(teta1)\r\n        elemLig1Mesh.castShadow=true;\r\n        elemLig1Mesh.receiveShadow=true;\r\n        this.scene.add(elemLig1Mesh)\r\n        let roadMaterial =[ new THREE.MeshLambertMaterial({color: 0x000000}),new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({map:this.roadTexture}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000}), new  THREE.MeshLambertMaterial({color: 0x000000})];\r\n\r\n        let roadGeometry =new THREE.BoxGeometry(2, 0.20,  Math.sqrt(Math.pow(elemLig0Mesh.position.x-elemLig1Mesh.position.x,2)+Math.pow(elemLig0Mesh.position.y-elemLig1Mesh.position.y,2)+Math.pow(elemLig0Mesh.position.z-elemLig1Mesh.position.z,2)));\r\n        let roadMesh=new THREE.Mesh(roadGeometry,roadMaterial);\r\n        roadMesh.position.set((elemLig0Mesh.position.x+elemLig1Mesh.position.x)/2,(elemLig0Mesh.position.y+elemLig1Mesh.position.y)/2,(elemLig0Mesh.position.z+elemLig1Mesh.position.z)/2);\r\n        roadMesh.castShadow=true;\r\n        roadMesh.receiveShadow=true;\r\n        this.scene.add(roadMesh)\r\n\r\n        let beta =Math.asin((elemLig0Mesh.position.y-elemLig1Mesh.position.y)/roadGeometry.parameters.depth);\r\n\r\n        let omega=teta0+Math.PI/2;\r\n        roadMesh.rotation.set(beta,omega,0, \"ZYX\")\r\n\r\n        this.roadsData.set(this.routes[i].routeId,[teta0,teta1,elemLig0Mesh.position.x,elemLig0Mesh.position.y,elemLig0Mesh.position.z,elemLig1Mesh.position.x,elemLig1Mesh.position.y,elemLig1Mesh.position.z,roadMesh.position.x,roadMesh.position.y,roadMesh.position.z,beta,(teta0+Math.PI/2)])\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  private addLights(){\r\n    //*Light\r\n\r\n    const light_amb = new THREE.AmbientLight(0xffffff, 0.5);\r\n    this.scene.add(light_amb);\r\n\r\n    const directLight = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    directLight.castShadow=true;\r\n    this.camera.add(directLight);\r\n /*   directLight.rotateY(Math.PI)\r\n    const cameraHelper =\r\n      new THREE.CameraHelper(directLight.shadow.camera);\r\n    this.scene.add(cameraHelper);*/\r\n\r\n    const spotLight = new THREE.SpotLight(0xffffff, 0.8);\r\n    spotLight.position.set(0, 500, 40);\r\n    spotLight.castShadow=true;\r\n    spotLight.target.position.set(0,0,40);\r\n    spotLight.shadow.mapSize.width = 2048;\r\n    spotLight.shadow.mapSize.height = 2048;\r\n    spotLight.shadow.camera.far =1000;\r\n    this.scene.add(spotLight);\r\n    this.scene.add(spotLight.target);\r\n  }\r\n\r\n\r\n  private addTruck(truckName:string){\r\n\r\n      const truck3D = this.truck3D.clone();\r\n      truck3D.name = truckName;\r\n      this.scene.add(truck3D);\r\n\r\n        if(this.isAutomaticMovement){\r\n          // @ts-ignore\r\n          const ware0 =  this.scene.getObjectByName( this.pathsData_Warehouses.get(truckName)[NetworkComponent.WARE0]);\r\n            // @ts-ignore\r\n          truck3D.position.set(ware0?.position.x, ware0?.position.y, ware0?.position.z+2);\r\n          this.activeTrucks.push(<Object3D<Event>>this.scene.getObjectByName(truck3D.name))\r\n          this.isAutomaticMovement=false;\r\n    }\r\n  }\r\n\r\n  public setAutomaticMovementRoutAndTruck(el:HTMLElement,map:Map<string,string[]>){\r\n    map.forEach((value, key) => {\r\n      this.automaticTruck=key;\r\n\r\n      let path = new THREE.CurvePath();\r\n\r\n      for(let i=0;i<value.length-1;i++){\r\n        let road=this.getRouteByWarehouses(value[i],value[i+1]);\r\n\r\n        let wareDeparture = this.scene.getObjectByName(value[i]);\r\n        let warehouseArrival= this.scene.getObjectByName(value[i+1])\r\n\r\n        let roadData=this.roadsData.get(<string>road?.routeId);\r\n\r\n        if(roadData!=undefined && warehouseArrival!=undefined){\r\n          if(!this.isRegisteredFirstOnRoutObject(wareDeparture?.name, warehouseArrival?.name)){\r\n\r\n            let rightMovement_X=0.45*Math.cos(roadData[NetworkComponent.TETA_0]-Math.PI/2);\r\n            let rightMovement_Z=0.45*Math.sin(roadData[NetworkComponent.TETA_0]+Math.PI/2);\r\n\r\n\r\n                if(i==0) {//Posição inicial até El0\r\n                 path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z)));//W0-EL0\r\n               }\r\n\r\n               //road-até ponto EL1\r\n                path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));\r\n                path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));\r\n                path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));\r\n                path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\r\n\r\n\r\n                let nextRoadData=this.roadsData.get(<string>this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\r\n\r\n                if( i< value.length-2 && nextRoadData!=null) {//Rotunda\r\n\r\n                  let teta = Math.atan2(-(warehouseArrival.position.z - roadData[NetworkComponent.EL1_Z]), warehouseArrival.position.x - roadData[NetworkComponent.EL1_X]);\r\n                                            //SAIDA                           ENTRADA                                 SAIDA                           ENTRADA\r\n                  let beta = Math.atan2(-(warehouseArrival.position.z - nextRoadData[NetworkComponent.EL1_Z]), (warehouseArrival.position.x -nextRoadData[NetworkComponent.EL1_X]));\r\n\r\n                  let geo = new BoxGeometry(0.2, 2, 0.2)\r\n\r\n                  let t=(teta+beta/10);\r\n                  console.log(t)\r\n\r\n                  for (let j = 0; j < 10; j++) {\r\n\r\n                    if(j<=4){\r\n                      let material = new MeshBasicMaterial({color:0x0000ff});\r\n                      let mesH = new Mesh(geo, material);\r\n                      mesH.position.set(warehouseArrival.position.x +this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t+j*t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t+j*t))\r\n                      this.scene.add(mesH)\r\n\r\n                  }else {\r\n                      let material = new MeshBasicMaterial({color:0x993399});\r\n                      let mesH = new Mesh(geo, material);\r\n                      mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t+j*t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t+j*t))\r\n                      this.scene.add(mesH)\r\n                    }\r\n                  }\r\n                }\r\n                if(i==value.length-2) {//se for a estrada final\r\n                  console.log(\"Estrada final cima\")\r\n                  path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\r\n                }\r\n\r\n          }else{\r\n\r\n            let rightMovement_X=0.45*Math.cos(roadData[NetworkComponent.TETA_1]-Math.PI/2);\r\n            let rightMovement_Z=0.45*Math.sin(roadData[NetworkComponent.TETA_1]+Math.PI/2);\r\n\r\n            if(i==0) {\r\n              path.add(new LineCurve3(new Vector3(wareDeparture?.position.x, wareDeparture?.position.y, wareDeparture?.position.z), new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z)));\r\n            }\r\n\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL1_X] + rightMovement_X, roadData[NetworkComponent.EL1_Y], roadData[NetworkComponent.EL1_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));//EL0-EL0_ROAD\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL1_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL1_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL1_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z)));//EL0-ROAD_ROAD\r\n            path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.ROAD_X] + rightMovement_X, roadData[NetworkComponent.ROAD_Y], roadData[NetworkComponent.ROAD_Z] + rightMovement_Z), new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z)));//ROAD-ROAD_EL1\r\n            path.add(new LineCurve3(new Vector3(((roadData[NetworkComponent.EL0_X] + roadData[NetworkComponent.ROAD_X]) / 2) + rightMovement_X, (roadData[NetworkComponent.EL0_Y] + roadData[NetworkComponent.ROAD_Y]) / 2, ((roadData[NetworkComponent.EL0_Z] + roadData[NetworkComponent.ROAD_Z]) / 2) + rightMovement_Z), new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z)));//ROAD_EL1_EL1\r\n\r\n            let nextRoadData=this.roadsData.get(<string>this.getRouteByWarehouses(value[i + 1], value[i + 2])?.routeId);\r\n            if( value.length-2 && nextRoadData!=null){\r\n\r\n\r\n                //Roundabout\r\n              let teta = Math.atan2((warehouseArrival.position.z - roadData[NetworkComponent.EL0_Z]), (warehouseArrival.position.x - roadData[NetworkComponent.EL0_X]));\r\n\r\n              let beta = Math.atan2((warehouseArrival.position.z - nextRoadData[NetworkComponent.EL0_Z]), (warehouseArrival.position.x -nextRoadData[NetworkComponent.EL0_X]));\r\n\r\n              let geo=new BoxGeometry(0.2,2,0.2)\r\n\r\n              let t=-(teta+beta)/10;\r\n\r\n              console.log(t)\r\n\r\n              for (let j = 0; j < 10; j++) {\r\n\r\n                if(j<=4){\r\n                  let material = new MeshBasicMaterial({color:0xFF0000});\r\n                  let mesH = new Mesh(geo, material);\r\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t+j*t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t+j*t))\r\n                  this.scene.add(mesH)\r\n\r\n              }else {\r\n                  let material = new MeshBasicMaterial({color:0xFFD700});\r\n                  let mesH = new Mesh(geo, material)\r\n                  mesH.position.set(warehouseArrival.position.x + this.warehouseBaseGeometry.parameters.radiusTop * Math.cos(t+j*t), warehouseArrival.position.y, warehouseArrival.position.z - this.warehouseBaseGeometry.parameters.radiusTop * Math.sin(t+j*t))\r\n                  this.scene.add(mesH)\r\n                }\r\n              }\r\n\r\n            }\r\n\r\n              if(i==value.length-2) {\r\n                console.log(\"Estrada final baixo\")\r\n                path.add(new LineCurve3(new Vector3(roadData[NetworkComponent.EL0_X] + rightMovement_X, roadData[NetworkComponent.EL0_Y], roadData[NetworkComponent.EL0_Z] + rightMovement_Z), new Vector3(warehouseArrival?.position.x, warehouseArrival?.position.y, warehouseArrival?.position.z)));\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n\r\n      path.autoClose=true;\r\n      this.pathLength=path.getLength();\r\n      this.pathsData_Warehouses.set(key,[value[0],value[1],value[value.length-1]]);\r\n      this.pathsData.set(key,path);\r\n\r\n    });\r\n\r\n    this.scrollDone(el);\r\n  }\r\n\r\n  public startAutomaticMovement(){\r\n    //ativar o som do camião\r\n    this.truckAudio.play();\r\n\r\n    let x3=document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x3!=null && z!=null) {\r\n      if (x3.style.display === \"block\" &&z.style.display === \"none\") {\r\n        z.style.display = \"block\";\r\n        x3.style.display = \"none\";\r\n\r\n        //ativar o movimento do camião\r\n        this.activateMotion=true;\r\n      }\r\n    }\r\n  }\r\n\r\n  private automaticMovement() {\r\n    //Automatic truck movement\r\n\r\n    if (this.activateMotion  && this.activeTrucks.length!=0) {\r\n      for(let i=0;i<this.activeTrucks.length;i++){\r\n\r\n            // @ts-ignore\r\n            let points =this.pathsData.get(this.activeTrucks[i].name).getPoint(this.currentDistance / this.pathLength);\r\n\r\n            if (points!=undefined) {\r\n\r\n              this.activeTrucks[i]?.lookAt(points);\r\n              this.activeTrucks[i]?.position?.set(points.x, points.y, points.z);\r\n              this.currentDistance += this.speed;\r\n\r\n\r\n              if (this.currentDistance >= this.pathLength) {\r\n                this.activateMotion = false;\r\n                this.scene.remove(this.activeTrucks[i]);\r\n                this.pathsData.delete(this.activeTrucks[i].name);\r\n                this.activeTrucks = this.activeTrucks.filter(obj => obj != this.activeTrucks[i]);\r\n                this.truckAudio.stop();\r\n                this.currentDistance=0;\r\n              }\r\n          }\r\n        }\r\n\r\n    }\r\n  }\r\n\r\n\r\n  private manualMovement(){\r\n    /*\r\n     document.onkeydown = function (e) {\r\n       switch (e.key) {\r\n         case \"a\":\r\n           //rodar a camara para a esquerda\r\n           truck?.position.set(truck?.position.x- 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"d\":\r\n           //rodar a camara para a direita\r\n           truck?.position.set(truck?.position.x+ 0.1,truck?.position.y,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"w\":\r\n           //avançar - incrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z- 0.1) ;\r\n           break;\r\n\r\n         case \"s\":\r\n           //recuar - decrementar a posição da camara no eixo dos zz\r\n           truck?.position.set(truck?.position.x,truck?.position.y,truck?.position.z+ 0.1) ;\r\n           break;\r\n\r\n         case \"p\":\r\n           //subir - incrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y+ 0.1,truck?.position.z) ;\r\n           break;\r\n\r\n         case \"l\":\r\n           //descer - decrementar a posição da camara no eixo dos yy\r\n           truck?.position.set(truck?.position.x,truck?.position.y- 0.1,truck?.position.z) ;\r\n           break;\r\n\r\n         default:break;\r\n       }\r\n\r\n       switch (e.keyCode){\r\n         case 39://right key\r\n           truck?.rotateY(5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 37://lef key\r\n           truck?.rotateY(-5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 38://up key\r\n           truck?.rotateX(-5 * Math.PI / 180);\r\n           break;\r\n\r\n         case 40://down key\r\n           truck?.rotateX(5 * Math.PI / 180);\r\n           break;\r\n\r\n         default:break;\r\n       }\r\n\r\n   }*/\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  private static getCoordinates(lat:number, lon:number, alt: number):any {\r\n    let coordinatesArr: number[]=[];\r\n    const min=-100;\r\n    const max=100;\r\n    const med=max/2;\r\n\r\n    coordinatesArr[0]=-(((max-(min))/(8.7613-8.2451))*(lon-8.2451)+(min));\r\n    coordinatesArr[1]=((((med-(-med))/(42.1115-40.8387))*(lat-40.8387)+(-med)));\r\n    coordinatesArr[2]=((((max / 800) * alt)));\r\n    parseInt( coordinatesArr[0].toFixed(4));\r\n    parseInt( coordinatesArr[1].toFixed(4));\r\n    parseInt( coordinatesArr[2].toFixed(4));\r\n\r\n    return coordinatesArr;\r\n  }\r\n\r\n\r\n  onClick() {\r\n\r\n  }\r\n\r\n  onMouseMove(event: MouseEvent) {\r\n\r\n  }\r\n\r\n  public importLoaders(){\r\n    /* this.ambientSoundLoader.load( 'assets/network/audio/Burn it Down.mp3', (buffer) => {\r\n       this.ambientAudio.setBuffer( buffer );\r\n       this.ambientAudio.setLoop( true );\r\n       this.ambientAudio.setVolume( 0.5 );\r\n       this.ambientAudio.play();\r\n     });*/\r\n\r\n   /* this.truckSoundLoader.load('assets/network/audio/Truck Sound.mp3', (buffer) => {\r\n       this.truckAudio.setBuffer( buffer );\r\n       this.truckAudio.setLoop( true );\r\n       this.truckAudio.setVolume( 0.5 );\r\n     });*/\r\n\r\n    this.skyBoxTexture=new THREE.TextureLoader().load('assets/network/sky.jpg');\r\n\r\n    this.skyBoxGroundTexture=new THREE.TextureLoader().load('assets/network/ground.jpg');\r\n    this.skyBoxGroundTexture.anisotropy = 16;\r\n    this.skyBoxGroundTexture.wrapS = this.skyBoxGroundTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.skyBoxGroundTexture.minFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.magFilter = THREE.LinearFilter;\r\n    this.skyBoxGroundTexture.generateMipmaps = false;\r\n    this.skyBoxGroundTexture.needsUpdate = true;\r\n\r\n    const loaderWare = new GLTFLoader();\r\n    loaderWare.load('/assets/network/warehouse.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.25, 0.25, 0.25);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.warehouse3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    const loaderTruck = new GLTFLoader();\r\n    loaderTruck.load('/assets/network/Truck.glb', (gltf) => {\r\n      gltf.scene.scale.set(0.3, 0.3, 0.3);\r\n      gltf.scene.castShadow=true;\r\n      gltf.scene.receiveShadow=true;\r\n      this.truck3D=gltf.scene;\r\n    }, undefined, function (error) {\r\n\r\n      console.error(error);\r\n    });\r\n    this.roundaboutTexture=new THREE.TextureLoader().load('assets/network/rotunda.jpg')\r\n\r\n    this.elemLigTexture=new THREE.TextureLoader().load('assets/network/road.jpg')\r\n    this.elemLigTexture.anisotropy = 16;\r\n    this.elemLigTexture.wrapS = this.elemLigTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.elemLigTexture.minFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.magFilter = THREE.LinearFilter;\r\n    this.elemLigTexture.generateMipmaps = false;\r\n    this.elemLigTexture.needsUpdate = true;\r\n\r\n    this.roadTexture=new THREE.TextureLoader().load('assets/network/road1.jpg')\r\n    this.roadTexture.anisotropy = 16;\r\n    this.roadTexture.wrapS = this.roadTexture.wrapT = THREE.MirroredRepeatWrapping;\r\n    this.roadTexture.minFilter = THREE.LinearFilter;\r\n    this.roadTexture.magFilter = THREE.LinearFilter;\r\n    this.roadTexture.generateMipmaps = false;\r\n    this.roadTexture.needsUpdate = true;\r\n  }\r\n\r\n\r\n  //Auxiliar Methods\r\n  public getRouteByWarehouses(ware1Identifier:any,ware2Identifier:any):Route | null{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return this.routes[i];\r\n      }else if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return this.routes[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  public isRegisteredFirstOnRoutObject(ware1Identifier:any,ware2Identifier:any):boolean{\r\n    for(let i=0;i<this.routes.length;i++){\r\n      if(ware1Identifier==this.routes[i].arrivalId  && ware2Identifier==this.routes[i].departureId){\r\n        return true;\r\n      }else if(ware1Identifier==this.routes[i].departureId && ware2Identifier==this.routes[i].arrivalId){\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public makeDelivery() {//bloquear o make delivery e mostrar as opcoes de automatic ou manual movement\r\n    let x1 = document.getElementById(\"OptionManualDelivery\");\r\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\r\n\r\n    let z=document.getElementById(\"OptionMakeDelivery\");\r\n\r\n    if (x1!=null && x2!=null&&z!=null) {\r\n      if (x1.style.display === \"none\" &&x2.style.display === \"none\") {\r\n        x1.style.display = \"block\";\r\n        x2.style.display = \"block\";\r\n        z.style.display=\"none\"\r\n      }\r\n    }\r\n  }\r\n\r\n  public scrollAutomaticDelivery(el: HTMLElement) {\r\n    this.isAutomaticMovement=true;\r\n    let x=document.getElementById(\"AutomaticSection\");\r\n    if(x!=null){\r\n      x.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n\r\n  public scrollDone(el: HTMLElement){\r\n    let done=document.getElementById(\"ButtonDoneSection\")\r\n    if(done!=null){\r\n      done.style.display=\"block\"\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n  }\r\n\r\n  public scrollCanvas(el: HTMLElement) {\r\n    this.addTruck(this.automaticTruck)\r\n\r\n    let x1 = document.getElementById(\"OptionManualDelivery\");\r\n    let x2 = document.getElementById(\"OptionAutomaticDelivery\");\r\n    let x3 = document.getElementById(\"OptionStartAutomaticDelivery\");\r\n    let x5=document.getElementById(\"AutomaticSection\");\r\n    let done=document.getElementById(\"ButtonDoneSection\")\r\n\r\n    if (x1!=null && x2!=null&&x3!=null&&x5!=null&&done!=null) {\r\n      if (x1.style.display === \"block\" &&x2.style.display === \"block\") {\r\n        x1.style.display = \"none\";\r\n        x2.style.display = \"none\";\r\n        x3.style.display=\"block\"\r\n        x5.style.display=\"none\"\r\n        done.style.display=\"none\";\r\n      }\r\n    }\r\n    el.scrollIntoView({behavior: 'smooth'});\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n","\r\n<nav class=\"navbar\" id=\"SectionNavbar\">\r\n    <ul>\r\n      <li >\r\n        <a href=\"/views/login\">Home</a>\r\n      </li>\r\n      <li >\r\n          <a id=\"OptionMakeDelivery\" (click)=\"makeDelivery()\">Make Delivery</a>\r\n      </li>\r\n\r\n       <li id=\"OptionManualDelivery\" style=\"display: none\"> <a>Manual Delivery</a></li>\r\n      <li id=\"OptionAutomaticDelivery\" style=\"display: none\"> <a (click)=\"scrollAutomaticDelivery(listRoutesSection)\">Automatic Delivery</a></li>\r\n      <li id=\"OptionStartAutomaticDelivery\" style=\"display: none\"> <a (click)=\"startAutomaticMovement()\">Start</a></li>\r\n    </ul>\r\n  </nav>\r\n\r\n  <div class=\"page\">\r\n    <div class=\"center\">\r\n\r\n      <div #canvasSection>\r\n        <canvas #canvas id=\"canvas\"  (mousemove)=\"onMouseMove($event)\" (click)=\"onClick()\"></canvas>\r\n      </div>\r\n\r\n      <div #listRoutesSection>\r\n        <app-get-planned-route id=\"AutomaticSection\" style=\"display: none\" [networkChecker]=\"checkerNetworkPlanedRoutes\" (getRouteAndTruckEvent)=\"setAutomaticMovementRoutAndTruck(done,$event)\" ></app-get-planned-route>\r\n      </div>\r\n      <div  style=\"align-content: center\">\r\n        <!-- HTML !-->\r\n        <button #done id=\"ButtonDoneSection\" class=\"button-73\" role=\"button\" style=\"display: none\" (click)=\"scrollCanvas(canvasSection)\">Done</button>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}